[2022-05-12 12:42:58,069] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2022-05-12 12:42:58,073] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-12 12:42:58,077] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-12 12:42:58,081] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-12 12:42:58,084] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-12 12:42:58,092] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 77) (kafka.controller.KafkaController)
[2022-05-12 12:42:58,100] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-12 12:42:58,107] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-12 12:42:58,113] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-12 12:42:58,117] INFO [Controller id=3] Currently active brokers in the cluster: Set(3) (kafka.controller.KafkaController)
[2022-05-12 12:42:58,118] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-12 12:42:58,119] INFO [Controller id=3] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-12 12:42:58,119] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-12 12:42:58,119] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-12 12:42:58,123] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-12 12:42:58,123] INFO [Controller id=3] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-12 12:42:58,123] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-12 12:42:58,123] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-12 12:42:58,124] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-12 12:42:58,133] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-12 12:42:58,133] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-12 12:42:58,136] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-12 12:42:58,136] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-12 12:42:58,136] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-12 12:42:58,137] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-12 12:42:58,137] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-12 12:42:58,140] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-12 12:42:58,140] INFO [Controller id=3] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2022-05-12 12:42:58,147] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-12 12:42:58,147] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-12 12:42:58,147] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-12 12:42:58,147] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-12 12:42:58,149] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-12 12:42:58,161] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-12 12:42:58,164] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-12 12:42:58,164] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-12 12:42:58,165] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-12 12:42:58,166] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-12 12:42:58,168] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-12 12:42:58,169] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-12 12:42:58,172] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-12 12:42:58,173] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-12 12:42:58,173] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-12 12:42:58,173] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-12 12:42:58,176] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
