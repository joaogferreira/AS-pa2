[2022-05-03 18:07:36,711] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:07:58,221] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:07:58,245] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 9 and epoch zk version is now 9 (kafka.controller.KafkaController)
[2022-05-03 18:07:58,248] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:07:58,252] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:07:58,255] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:07:58,257] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:07:58,271] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 2445) (kafka.controller.KafkaController)
[2022-05-03 18:07:58,304] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:07:58,317] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:07:58,324] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:07:58,327] INFO [Controller id=3] Currently active brokers in the cluster: Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:07:58,327] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:07:58,327] INFO [Controller id=3] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:07:58,328] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:07:58,332] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:07:58,333] INFO [Controller id=3] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:07:58,333] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:07:58,333] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:07:58,334] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:07:58,345] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:07:58,349] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:07:58,352] INFO [RequestSendThread controllerId=3] Controller 3 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:07:58,371] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:07:58,406] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:07:58,406] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:07:58,409] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:07:58,440] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap(Sensor-4 -> OfflinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:07:58,440] INFO [Controller id=3] Ready to serve as the new controller with epoch 9 (kafka.controller.KafkaController)
[2022-05-03 18:07:58,447] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:07:58,449] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:07:58,449] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:07:58,450] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:07:58,451] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:07:58,458] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:08:03,120] INFO [Controller id=3] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:08:03,120] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:08:03,124] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:08:03,127] INFO [Controller id=3] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:08:03,132] INFO [RequestSendThread controllerId=3] Controller 3 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:08:03,152] DEBUG [Controller id=3] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:08:03,154] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 2445, 4 -> 2470) (kafka.controller.KafkaController)
[2022-05-03 18:08:03,178] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:08:03,196] DEBUG [Controller id=4] Broker 3 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:08:03,460] INFO [Controller id=3] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:08:03,461] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:08:03,466] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:08:03,467] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:08:03,470] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:08:03,470] DEBUG [Controller id=3] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3), Sensor-5 -> List(5, 3, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:08:03,470] TRACE [Controller id=3] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:08:03,470] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:08:03,471] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:08:03,471] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:08:03,471] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:08:03,471] DEBUG [Controller id=3] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:08:03,471] TRACE [Controller id=3] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:08:03,472] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:08:04,481] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:08:04,486] DEBUG [Controller id=3] ISR for partition Sensor-5 updated to [4,3] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:08:04,499] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:08:04,502] DEBUG [Controller id=3] ISR for partition Sensor-2 updated to [4,3] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:08:08,009] INFO [Controller id=3] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:08:08,009] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:08:08,013] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:08:08,013] INFO [Controller id=3] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:08:08,016] INFO [RequestSendThread controllerId=3] Controller 3 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:08:08,028] DEBUG [Controller id=3] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:08:08,029] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 2445, 4 -> 2470, 5 -> 2491) (kafka.controller.KafkaController)
[2022-05-03 18:08:08,061] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:08:08,074] DEBUG [Controller id=5] Broker 3 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:08:08,326] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:08:08,328] DEBUG [Controller id=3] ISR for partition Sensor-5 updated to [4,3,5] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:08:08,334] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:08:08,337] DEBUG [Controller id=3] ISR for partition Sensor-2 updated to [4,3,5] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:11:18,973] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:11:18,973] DEBUG [Controller id=3] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:11:18,974] DEBUG [Controller id=3] Live brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:11:18,989] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-5 -> (Leader:4,ISR:4,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:9),Sensor-2 -> (Leader:4,ISR:4,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:9),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) (kafka.controller.KafkaController)
[2022-05-03 18:11:18,991] INFO [Controller id=3] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:11:18,992] DEBUG [Controller id=3] All shutting down brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:11:18,992] DEBUG [Controller id=3] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:19,014] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:9),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:9),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) (kafka.controller.KafkaController)
[2022-05-03 18:11:19,015] WARN [RequestSendThread controllerId=3] Controller 3 epoch 9 fails to send request (type=LeaderAndIsRequest, controllerId=3, controllerEpoch=9, brokerEpoch=2445, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=9, leader=5, leaderEpoch=7, isr=[5], zkVersion=9, replicas=[5, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=9, leader=5, leaderEpoch=7, isr=[5], zkVersion=9, replicas=[3, 5, 4], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(joao:9097 (id: 5 rack: null))) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,016] INFO [Controller id=3] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:19,016] DEBUG [Controller id=3] All shutting down brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:11:19,016] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:11:19,030] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:9),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:9),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) (kafka.controller.KafkaController)
[2022-05-03 18:11:19,118] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,221] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,323] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,425] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,527] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,628] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,730] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,833] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,934] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,951] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:19,952] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:19,952] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:19,953] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:11:19,953] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:11:19,954] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:19,954] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:19,955] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,956] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,956] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,956] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,957] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,957] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,957] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,958] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,959] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,959] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:11:19,960] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:11:19,977] INFO [Controller id=5] 5 successfully elected as the controller. Epoch incremented to 10 and epoch zk version is now 10 (kafka.controller.KafkaController)
[2022-05-03 18:11:19,978] INFO [Controller id=5] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:11:19,982] INFO [Controller id=5] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:11:19,982] DEBUG [Controller id=4] Broker 5 was elected as controller instead of broker 4 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:11:19,985] INFO [Controller id=5] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:11:19,987] INFO [Controller id=5] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:11:19,993] INFO [Controller id=5] Initialized broker epochs cache: HashMap(4 -> 2470, 5 -> 2491) (kafka.controller.KafkaController)
[2022-05-03 18:11:20,007] DEBUG [Controller id=5] Register BrokerModifications handler for Set(4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:11:20,018] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:11:20,021] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:11:20,024] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:11:20,024] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:11:20,026] INFO [Controller id=5] Currently active brokers in the cluster: Set(4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:11:20,026] INFO [Controller id=5] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:11:20,026] INFO [Controller id=5] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:11:20,027] INFO [Controller id=5] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:11:20,031] INFO [Controller id=5] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:11:20,031] INFO [Controller id=5] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:11:20,031] INFO [Controller id=5] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:11:20,031] INFO [Topic Deletion Manager 5] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:11:20,032] INFO [Controller id=5] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:11:20,040] INFO [RequestSendThread controllerId=5] Controller 5 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:11:20,040] INFO [RequestSendThread controllerId=5] Controller 5 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:11:20,042] INFO [ReplicaStateMachine controllerId=5] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:20,046] INFO [ReplicaStateMachine controllerId=5] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:20,063] INFO [ReplicaStateMachine controllerId=5] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:20,098] DEBUG [ReplicaStateMachine controllerId=5] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:20,099] INFO [PartitionStateMachine controllerId=5] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:20,104] INFO [PartitionStateMachine controllerId=5] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:20,125] DEBUG [PartitionStateMachine controllerId=5] Started partition state machine with initial state -> HashMap(Sensor-4 -> OfflinePartition, Sensor-5 -> OnlinePartition, Sensor-2 -> OnlinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:20,126] INFO [Controller id=5] Ready to serve as the new controller with epoch 10 (kafka.controller.KafkaController)
[2022-05-03 18:11:20,131] INFO [Controller id=5] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:11:20,132] INFO [Controller id=5] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:11:20,132] INFO [Controller id=5] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:11:20,132] INFO [Controller id=5] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:11:20,135] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:20,143] INFO [Controller id=5] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:11:23,638] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:11:24,021] INFO [Controller id=5] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:24,021] DEBUG [Controller id=5] All shutting down brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:24,022] DEBUG [Controller id=5] Live brokers: 4 (kafka.controller.KafkaController)
[2022-05-03 18:11:24,038] TRACE [Controller id=5] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) (kafka.controller.KafkaController)
[2022-05-03 18:11:24,041] INFO [Controller id=5] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:11:24,041] DEBUG [Controller id=5] All shutting down brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:11:24,041] DEBUG [Controller id=5] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:11:24,048] TRACE [Controller id=5] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) (kafka.controller.KafkaController)
[2022-05-03 18:11:25,104] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:25,105] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:25,105] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:25,106] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:11:25,106] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:11:25,106] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:25,107] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:25,108] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:11:25,120] INFO [Controller id=5] Newly added brokers: , deleted brokers: 4, bounced brokers: , all live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:25,120] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:11:25,121] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:11:25,121] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:11:25,124] INFO [Controller id=5] Broker failure callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:11:25,125] INFO [Controller id=5] Removed 4 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:11:25,140] DEBUG [Controller id=5] Unregister BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:11:25,140] INFO [Controller id=5] Updated broker epochs cache: HashMap(5 -> 2491) (kafka.controller.KafkaController)
[2022-05-03 18:11:25,144] INFO [Controller id=5] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:11:25,144] TRACE [Controller id=5] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:11:25,147] DEBUG [Controller id=5] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:11:25,148] TRACE [Controller id=5] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] DEBUG [Controller id=5] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3)) (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] TRACE [Controller id=5] Leader imbalance ratio for broker 5 is 0.5 (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] DEBUG [Controller id=5] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] TRACE [Controller id=5] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] DEBUG [Controller id=5] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] TRACE [Controller id=5] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:11:25,149] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:29,043] INFO [Controller id=5] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:29,043] DEBUG [Controller id=5] All shutting down brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:29,043] DEBUG [Controller id=5] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:11:29,051] TRACE [Controller id=5] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) (kafka.controller.KafkaController)
[2022-05-03 18:11:29,924] INFO [Controller id=5] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,5 (kafka.controller.KafkaController)
[2022-05-03 18:11:29,925] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:11:29,928] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:11:29,929] INFO [Controller id=5] New broker startup callback for 0 (kafka.controller.KafkaController)
[2022-05-03 18:11:29,932] INFO [RequestSendThread controllerId=5] Controller 5 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:11:29,933] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:29,946] DEBUG [Controller id=5] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2022-05-03 18:11:29,948] INFO [Controller id=5] Updated broker epochs cache: HashMap(0 -> 2523, 5 -> 2491) (kafka.controller.KafkaController)
[2022-05-03 18:11:29,976] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:29,993] DEBUG [Controller id=0] Broker 5 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:11:30,035] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:30,138] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:30,187] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:30,188] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:30,188] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:30,189] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:11:30,190] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set(0, 5) (kafka.controller.KafkaController)
[2022-05-03 18:11:30,191] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:30,192] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:30,193] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,196] WARN [RequestSendThread controllerId=5] Controller 5 epoch 10 fails to send request (type=LeaderAndIsRequest, controllerId=5, controllerEpoch=10, brokerEpoch=2523, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=10, leader=-1, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=10, leader=-1, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[4, 3, 0], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=10, leader=-1, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[0, 4, 5], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=10, leader=-1, leaderEpoch=4, isr=[0], zkVersion=4, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=()) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Client was shutdown before response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:108)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:30,197] ERROR [RequestSendThread controllerId=5] Controller 5 fails to send a request to broker 127.0.0.1:9092 (id: 0 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1367)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:30,198] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,198] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,199] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,200] TRACE [RequestSendThread controllerId=5] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,200] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,200] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,202] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:11:30,222] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 11 and epoch zk version is now 11 (kafka.controller.KafkaController)
[2022-05-03 18:11:30,225] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:11:30,228] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:11:30,230] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:11:30,232] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:11:30,239] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 2523) (kafka.controller.KafkaController)
[2022-05-03 18:11:30,256] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:11:30,271] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:11:30,279] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,281] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:11:30,282] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:11:30,282] INFO [Controller id=0] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:11:30,283] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:11:30,289] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:11:30,289] INFO [Controller id=0] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:11:30,290] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:11:30,290] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:11:30,291] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:11:30,301] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:30,306] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:11:30,309] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:30,331] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:30,371] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:11:30,372] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:30,375] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:30,402] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(Sensor-4 -> OnlinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OnlinePartition, Sensor-0 -> OnlinePartition, Sensor-1 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:11:30,403] INFO [Controller id=0] Ready to serve as the new controller with epoch 11 (kafka.controller.KafkaController)
[2022-05-03 18:11:30,409] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:11:30,409] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:11:30,409] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:11:30,410] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:11:30,411] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:30,421] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:11:35,423] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:11:35,424] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:11:35,428] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2022-05-03 18:11:35,429] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2022-05-03 18:11:35,429] DEBUG [Controller id=0] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3), Sensor-5 -> List(5, 3, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:11:35,430] TRACE [Controller id=0] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:11:35,432] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:35,432] DEBUG [Controller id=0] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:11:35,432] TRACE [Controller id=0] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:11:35,432] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:35,432] DEBUG [Controller id=0] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:11:35,432] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:11:35,432] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:11:44,963] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:11:44,964] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:11:44,966] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:11:44,969] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:11:44,972] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:11:44,983] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:11:44,985] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2523, 3 -> 2578) (kafka.controller.KafkaController)
[2022-05-03 18:11:45,018] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:45,029] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:11:45,326] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4). (kafka.controller.KafkaController)
[2022-05-03 18:11:45,330] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [0,3] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:11:45,341] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:11:45,345] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [0,3] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:11:45,345] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [0,3] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:11:49,966] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:11:49,966] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:11:49,970] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:11:49,971] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:11:49,974] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:11:49,982] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:11:49,983] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2523, 3 -> 2578, 4 -> 2597) (kafka.controller.KafkaController)
[2022-05-03 18:11:50,016] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:50,032] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:11:50,281] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3). (kafka.controller.KafkaController)
[2022-05-03 18:11:50,284] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [0,3,4] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:11:50,290] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-0). (kafka.controller.KafkaController)
[2022-05-03 18:11:50,293] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [0,4] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:11:55,011] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:11:55,012] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:11:55,015] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:11:55,015] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:11:55,018] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:11:55,033] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:11:55,035] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2523, 3 -> 2578, 4 -> 2597, 5 -> 2616) (kafka.controller.KafkaController)
[2022-05-03 18:11:55,073] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:11:55,089] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:11:55,371] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4). (kafka.controller.KafkaController)
[2022-05-03 18:11:55,374] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [0,3,5] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:11:55,381] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-0, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:11:55,384] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [0,4,5] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:11:55,384] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [0,3,5] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:11:56,346] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-5, Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:11:56,351] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,3] and zkVersion updated to [12] (kafka.controller.KafkaController)
[2022-05-03 18:11:56,351] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,4] and zkVersion updated to [12] (kafka.controller.KafkaController)
[2022-05-03 18:11:56,862] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-5, Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:11:56,866] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,3,4] and zkVersion updated to [13] (kafka.controller.KafkaController)
[2022-05-03 18:11:56,866] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,4,3] and zkVersion updated to [13] (kafka.controller.KafkaController)
[2022-05-03 18:12:50,915] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,915] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,915] DEBUG [Controller id=0] Live brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,925] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:5,ISR:3,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11),Sensor-5 -> (Leader:5,ISR:5,3,4,LeaderEpoch:9,ZkVersion:13,ControllerEpoch:11),Sensor-2 -> (Leader:5,ISR:5,4,3,LeaderEpoch:9,ZkVersion:13,ControllerEpoch:11),Sensor-3 -> (Leader:4,ISR:3,4,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11),Sensor-0 -> (Leader:4,ISR:4,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11),Sensor-1 -> (Leader:5,ISR:3,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11) (kafka.controller.KafkaController)
[2022-05-03 18:12:50,928] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,928] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,928] DEBUG [Controller id=0] Live brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,946] WARN [RequestSendThread controllerId=0] Controller 0 epoch 11 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=11, brokerEpoch=2523, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=11, leader=3, leaderEpoch=7, isr=[3], zkVersion=9, replicas=[4, 3, 0], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=11, leader=5, leaderEpoch=7, isr=[5], zkVersion=9, replicas=[0, 4, 5], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(127.0.0.1:9097 (id: 5 rack: null), 127.0.0.1:9095 (id: 3 rack: null))) to broker 127.0.0.1:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:50,956] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:5,ISR:3,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11),Sensor-5 -> (Leader:5,ISR:5,3,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:11),Sensor-2 -> (Leader:5,ISR:5,3,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:11),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-1 -> (Leader:5,ISR:3,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:11) (kafka.controller.KafkaController)
[2022-05-03 18:12:50,956] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,956] DEBUG [Controller id=0] All shutting down brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,956] DEBUG [Controller id=0] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,964] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11) (kafka.controller.KafkaController)
[2022-05-03 18:12:50,964] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,964] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:12:50,965] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:12:50,976] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11) (kafka.controller.KafkaController)
[2022-05-03 18:12:51,049] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,151] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,253] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,355] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,457] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,559] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,661] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,762] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,865] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,966] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:51,978] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:12:51,979] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:12:51,979] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:12:51,979] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:12:51,980] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:12:51,981] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:12:51,981] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:12:51,982] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,983] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,983] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,983] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,984] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,985] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,985] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,986] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,986] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,986] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,988] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,988] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,988] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:12:51,991] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:12:52,007] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 12 and epoch zk version is now 12 (kafka.controller.KafkaController)
[2022-05-03 18:12:52,009] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:12:52,011] DEBUG [Controller id=5] Broker 3 was elected as controller instead of broker 5 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:12:52,011] DEBUG [Controller id=4] Broker 3 was elected as controller instead of broker 4 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:12:52,012] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:12:52,015] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:12:52,017] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:12:52,022] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 2578, 4 -> 2597, 5 -> 2616) (kafka.controller.KafkaController)
[2022-05-03 18:12:52,033] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:12:52,045] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:12:52,048] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:12:52,049] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:12:52,053] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:12:52,053] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:12:52,053] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:12:52,055] INFO [Controller id=3] Currently active brokers in the cluster: Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:12:52,055] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:12:52,055] INFO [Controller id=3] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:12:52,056] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:12:52,061] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:12:52,061] INFO [Controller id=3] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:12:52,061] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:12:52,061] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:12:52,062] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:12:52,070] INFO [RequestSendThread controllerId=3] Controller 3 connected to 127.0.0.1:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:12:52,070] INFO [RequestSendThread controllerId=3] Controller 3 connected to 127.0.0.1:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:12:52,070] INFO [RequestSendThread controllerId=3] Controller 3 connected to 127.0.0.1:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:12:52,073] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:12:52,077] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:12:52,097] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:12:52,118] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:12:52,118] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:12:52,123] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:12:52,125] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap(Sensor-4 -> OnlinePartition, Sensor-5 -> OnlinePartition, Sensor-2 -> OnlinePartition, Sensor-3 -> OnlinePartition, Sensor-0 -> OnlinePartition, Sensor-1 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:12:52,125] INFO [Controller id=3] Ready to serve as the new controller with epoch 12 (kafka.controller.KafkaController)
[2022-05-03 18:12:52,130] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:12:52,130] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:12:52,131] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:12:52,131] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:12:52,133] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:12:52,144] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:12:55,009] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:12:55,958] INFO [Controller id=3] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,958] DEBUG [Controller id=3] All shutting down brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,958] DEBUG [Controller id=3] Live brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,972] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) (kafka.controller.KafkaController)
[2022-05-03 18:12:55,973] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,973] DEBUG [Controller id=3] All shutting down brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,974] DEBUG [Controller id=3] Live brokers: 4 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,984] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) (kafka.controller.KafkaController)
[2022-05-03 18:12:55,984] INFO [Controller id=3] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,984] DEBUG [Controller id=3] All shutting down brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:12:55,984] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:12:55,992] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) (kafka.controller.KafkaController)
[2022-05-03 18:12:57,146] INFO [Controller id=3] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:12:57,146] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:12:57,149] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:12:57,150] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:12:57,151] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] DEBUG [Controller id=3] Topics not in preferred replica for broker 5 HashMap() (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] TRACE [Controller id=3] Leader imbalance ratio for broker 5 is 0.0 (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] DEBUG [Controller id=3] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] TRACE [Controller id=3] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:12:57,152] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:12:57,419] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:12:57,420] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:12:57,420] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:12:57,421] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:12:57,421] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:12:57,422] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:12:57,422] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:12:57,423] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:12:57,433] INFO [Controller id=3] Newly added brokers: , deleted brokers: 4, bounced brokers: , all live brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:12:57,434] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:12:57,435] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:12:57,435] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:12:57,440] INFO [Controller id=3] Broker failure callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:12:57,441] INFO [Controller id=3] Removed 4 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:12:57,461] DEBUG [Controller id=3] Unregister BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:12:57,463] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 2578, 5 -> 2616) (kafka.controller.KafkaController)
[2022-05-03 18:13:00,978] INFO [Controller id=3] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:13:00,978] DEBUG [Controller id=3] All shutting down brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:13:00,978] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:13:00,983] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) (kafka.controller.KafkaController)
[2022-05-03 18:13:00,988] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:13:00,988] DEBUG [Controller id=3] All shutting down brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:13:00,988] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:13:00,999] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12),Sensor-3 -> (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) (kafka.controller.KafkaController)
[2022-05-03 18:13:01,002] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,103] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,205] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,306] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,408] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,509] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,531] INFO [Controller id=3] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,3,5 (kafka.controller.KafkaController)
[2022-05-03 18:13:01,532] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:13:01,533] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,534] INFO [Controller id=3] New broker startup callback for 0 (kafka.controller.KafkaController)
[2022-05-03 18:13:01,536] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,536] INFO [RequestSendThread controllerId=3] Controller 3 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,543] DEBUG [Controller id=3] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2022-05-03 18:13:01,545] INFO [Controller id=3] Updated broker epochs cache: HashMap(0 -> 2660, 3 -> 2578, 5 -> 2616) (kafka.controller.KafkaController)
[2022-05-03 18:13:01,582] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:01,598] DEBUG [Controller id=0] Broker 3 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:13:01,611] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,637] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,713] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,738] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,815] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,839] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,917] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,941] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,985] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:01,985] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:01,985] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:01,986] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:13:01,986] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(0, 3, 5) (kafka.controller.KafkaController)
[2022-05-03 18:13:01,986] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:01,987] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:01,987] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,987] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,987] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,989] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,991] WARN [RequestSendThread controllerId=3] Controller 3 epoch 12 fails to send request (type: UpdateMetadataRequest=, controllerId=3, controllerEpoch=12, brokerEpoch=2578, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,992] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,992] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,992] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,993] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,993] WARN [RequestSendThread controllerId=3] Controller 3 epoch 12 fails to send request (type=LeaderAndIsRequest, controllerId=3, controllerEpoch=12, brokerEpoch=2616, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=12, leader=5, leaderEpoch=7, isr=[5], zkVersion=9, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=12, leader=5, leaderEpoch=11, isr=[5], zkVersion=15, replicas=[5, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=12, leader=5, leaderEpoch=11, isr=[5], zkVersion=15, replicas=[3, 5, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=12, leader=5, leaderEpoch=7, isr=[5], zkVersion=9, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(127.0.0.1:9097 (id: 5 rack: null))) to broker 127.0.0.1:9097 (id: 5 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,994] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,994] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,994] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:13:01,995] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:13:02,005] INFO [Controller id=5] 5 successfully elected as the controller. Epoch incremented to 13 and epoch zk version is now 13 (kafka.controller.KafkaController)
[2022-05-03 18:13:02,007] INFO [Controller id=5] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:13:02,008] DEBUG [Controller id=0] Broker 5 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:13:02,011] INFO [Controller id=5] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:13:02,013] INFO [Controller id=5] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:13:02,015] INFO [Controller id=5] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:13:02,022] INFO [Controller id=5] Initialized broker epochs cache: HashMap(0 -> 2660, 5 -> 2616) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,037] DEBUG [Controller id=5] Register BrokerModifications handler for Set(0, 5) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,043] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:02,052] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:13:02,056] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:13:02,058] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,058] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,060] INFO [Controller id=5] Currently active brokers in the cluster: Set(0, 5) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,060] INFO [Controller id=5] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:13:02,060] INFO [Controller id=5] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,060] INFO [Controller id=5] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:13:02,063] INFO [Controller id=5] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,064] INFO [Controller id=5] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:13:02,064] INFO [Controller id=5] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:13:02,064] INFO [Topic Deletion Manager 5] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:13:02,064] INFO [Controller id=5] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:13:02,070] INFO [RequestSendThread controllerId=5] Controller 5 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,071] INFO [ReplicaStateMachine controllerId=5] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,072] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,077] INFO [ReplicaStateMachine controllerId=5] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,090] INFO [ReplicaStateMachine controllerId=5] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,117] DEBUG [ReplicaStateMachine controllerId=5] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,118] INFO [PartitionStateMachine controllerId=5] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:02,120] INFO [PartitionStateMachine controllerId=5] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:02,137] DEBUG [PartitionStateMachine controllerId=5] Started partition state machine with initial state -> HashMap(Sensor-4 -> OnlinePartition, Sensor-5 -> OnlinePartition, Sensor-2 -> OnlinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OnlinePartition, Sensor-1 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:02,137] INFO [Controller id=5] Ready to serve as the new controller with epoch 13 (kafka.controller.KafkaController)
[2022-05-03 18:13:02,142] INFO [Controller id=5] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,143] INFO [Controller id=5] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,143] INFO [Controller id=5] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,143] INFO [Controller id=5] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,144] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:13:02,150] INFO [Controller id=5] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:13:02,154] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:02,154] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:02,155] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:13:02,156] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set(0, 5) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,157] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:02,159] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,160] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,160] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,160] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,162] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,163] WARN [RequestSendThread controllerId=5] Controller 5 epoch 13 fails to send request (type: UpdateMetadataRequest=, controllerId=5, controllerEpoch=13, brokerEpoch=2616, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9097 (id: 5 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,164] TRACE [RequestSendThread controllerId=5] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,164] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,164] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,166] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:13:02,184] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 14 and epoch zk version is now 14 (kafka.controller.KafkaController)
[2022-05-03 18:13:02,186] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:13:02,191] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:13:02,194] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:13:02,196] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:13:02,202] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 2660) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,220] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,233] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:13:02,239] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,241] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,241] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:13:02,241] INFO [Controller id=0] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:13:02,242] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:13:02,246] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,247] INFO [Controller id=0] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:13:02,247] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:13:02,247] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:13:02,248] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:13:02,254] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,255] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:13:02,259] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,277] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,314] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:13:02,315] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:02,317] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:02,342] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(Sensor-4 -> OfflinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:13:02,343] INFO [Controller id=0] Ready to serve as the new controller with epoch 14 (kafka.controller.KafkaController)
[2022-05-03 18:13:02,347] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,347] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,348] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,348] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:13:02,348] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:13:02,355] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:13:07,357] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:13:07,357] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:13:07,360] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:13:07,361] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] DEBUG [Controller id=0] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3), Sensor-5 -> List(5, 3, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] TRACE [Controller id=0] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] DEBUG [Controller id=0] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] TRACE [Controller id=0] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] DEBUG [Controller id=0] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:13:07,362] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:13:16,443] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:13:16,444] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:13:16,448] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:13:16,450] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:13:16,453] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:13:16,470] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:13:16,472] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2660, 3 -> 2719) (kafka.controller.KafkaController)
[2022-05-03 18:13:16,495] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:16,514] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:13:17,769] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3). (kafka.controller.KafkaController)
[2022-05-03 18:13:17,774] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [3,0] and zkVersion updated to [13] (kafka.controller.KafkaController)
[2022-05-03 18:13:21,478] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:13:21,478] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:13:21,482] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:13:21,482] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:13:21,485] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:13:21,495] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:13:21,497] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2660, 3 -> 2719, 4 -> 2737) (kafka.controller.KafkaController)
[2022-05-03 18:13:21,532] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:21,552] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:13:21,827] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3). (kafka.controller.KafkaController)
[2022-05-03 18:13:21,830] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [3,0,4] and zkVersion updated to [14] (kafka.controller.KafkaController)
[2022-05-03 18:13:26,438] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:13:26,439] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:13:26,441] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:13:26,441] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:13:26,445] INFO [RequestSendThread controllerId=0] Controller 0 connected to 127.0.0.1:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:13:26,455] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:13:26,457] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2660, 3 -> 2719, 4 -> 2737, 5 -> 2755) (kafka.controller.KafkaController)
[2022-05-03 18:13:26,499] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:13:26,517] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:13:27,788] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4, Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:13:27,792] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [5,0] and zkVersion updated to [12] (kafka.controller.KafkaController)
[2022-05-03 18:13:27,792] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,4] and zkVersion updated to [18] (kafka.controller.KafkaController)
[2022-05-03 18:13:27,803] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-2, Sensor-0, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:13:27,805] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,3] and zkVersion updated to [18] (kafka.controller.KafkaController)
[2022-05-03 18:13:27,805] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [5,0] and zkVersion updated to [12] (kafka.controller.KafkaController)
[2022-05-03 18:13:27,805] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [5,3] and zkVersion updated to [12] (kafka.controller.KafkaController)
[2022-05-03 18:13:28,298] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:13:28,301] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [5,3,0] and zkVersion updated to [13] (kafka.controller.KafkaController)
[2022-05-03 18:13:28,308] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-2, Sensor-0). (kafka.controller.KafkaController)
[2022-05-03 18:13:28,310] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,3,4] and zkVersion updated to [19] (kafka.controller.KafkaController)
[2022-05-03 18:13:28,310] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [5,0,4] and zkVersion updated to [13] (kafka.controller.KafkaController)
[2022-05-03 18:13:28,317] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4, Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:13:28,319] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [5,0,3] and zkVersion updated to [13] (kafka.controller.KafkaController)
[2022-05-03 18:13:28,320] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,4,3] and zkVersion updated to [19] (kafka.controller.KafkaController)
[2022-05-03 18:15:08,209] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,210] DEBUG [Controller id=0] All shutting down brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,210] DEBUG [Controller id=0] Live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,230] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,3,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:14),Sensor-5 -> (Leader:3,ISR:4,3,LeaderEpoch:14,ZkVersion:20,ControllerEpoch:14),Sensor-2 -> (Leader:3,ISR:3,4,LeaderEpoch:14,ZkVersion:20,ControllerEpoch:14),Sensor-3 -> (Leader:3,ISR:3,0,4,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,4,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:3,0,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:08,233] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,233] DEBUG [Controller id=0] All shutting down brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,233] DEBUG [Controller id=0] Live brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,261] WARN [RequestSendThread controllerId=0] Controller 0 epoch 14 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=14, brokerEpoch=2755, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=14, leader=0, leaderEpoch=10, isr=[0, 3], zkVersion=14, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=14, leader=3, leaderEpoch=14, isr=[4, 3], zkVersion=20, replicas=[5, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=14, leader=3, leaderEpoch=14, isr=[3, 4], zkVersion=20, replicas=[3, 5, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=14, leader=0, leaderEpoch=10, isr=[0, 4], zkVersion=14, replicas=[0, 4, 5], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=14, leader=0, leaderEpoch=10, isr=[3, 0], zkVersion=14, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(127.0.0.1:9095 (id: 3 rack: null), 127.0.0.1:9092 (id: 0 rack: null))) to broker 127.0.0.1:9097 (id: 5 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 5 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,269] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-3 -> (Leader:4,ISR:0,4,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,4,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:08,269] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,269] DEBUG [Controller id=0] All shutting down brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,269] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,282] WARN [RequestSendThread controllerId=0] Controller 0 epoch 14 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=14, brokerEpoch=2719, partitionStates=[UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=14, leader=4, leaderEpoch=15, isr=[4], zkVersion=21, replicas=[5, 3, 4], offlineReplicas=[5, 3]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=14, leader=4, leaderEpoch=15, isr=[4], zkVersion=21, replicas=[3, 5, 4], offlineReplicas=[3, 5]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=14, leader=4, leaderEpoch=11, isr=[0, 4], zkVersion=15, replicas=[4, 3, 0], offlineReplicas=[3])], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,285] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:08,286] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,286] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:15:08,286] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:15:08,291] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:08,363] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,384] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,465] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,485] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,566] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,587] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,668] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,689] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,769] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,790] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,871] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,892] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,972] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,993] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,074] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,095] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,175] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,197] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,277] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,298] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,304] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:09,305] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:09,305] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:09,305] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:15:09,306] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:15:09,306] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:09,308] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:09,309] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:15:09,317] INFO [Controller id=0] Newly added brokers: , deleted brokers: 5, bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:09,317] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,318] WARN [RequestSendThread controllerId=0] Controller 0 epoch 14 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=14, brokerEpoch=2755, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=14, leader=0, leaderEpoch=10, isr=[0, 3], zkVersion=14, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=14, leader=3, leaderEpoch=14, isr=[4, 3], zkVersion=20, replicas=[5, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=14, leader=3, leaderEpoch=14, isr=[3, 4], zkVersion=20, replicas=[3, 5, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=14, leader=0, leaderEpoch=10, isr=[0, 4], zkVersion=14, replicas=[0, 4, 5], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=14, leader=0, leaderEpoch=10, isr=[3, 0], zkVersion=14, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(127.0.0.1:9095 (id: 3 rack: null), 127.0.0.1:9092 (id: 0 rack: null))) to broker 127.0.0.1:9097 (id: 5 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,318] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,318] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,318] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,321] INFO [Controller id=0] Broker failure callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:15:09,321] INFO [Controller id=0] Removed 5 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:15:09,322] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:09,323] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:09,323] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:09,324] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:15:09,325] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:15:09,326] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:09,326] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:09,328] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:15:09,333] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:15:09,333] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2660, 3 -> 2719, 4 -> 2737) (kafka.controller.KafkaController)
[2022-05-03 18:15:09,336] INFO [Controller id=0] Newly added brokers: , deleted brokers: 3, bounced brokers: , all live brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:09,336] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,336] WARN [RequestSendThread controllerId=0] Controller 0 epoch 14 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=14, brokerEpoch=2719, partitionStates=[UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=14, leader=4, leaderEpoch=15, isr=[4], zkVersion=21, replicas=[5, 3, 4], offlineReplicas=[5, 3]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=14, leader=4, leaderEpoch=15, isr=[4], zkVersion=21, replicas=[3, 5, 4], offlineReplicas=[3, 5]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=14, leader=4, leaderEpoch=11, isr=[0, 4], zkVersion=15, replicas=[4, 3, 0], offlineReplicas=[3])], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker 127.0.0.1:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,337] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,337] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,337] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:15:09,338] INFO [Controller id=0] Broker failure callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:15:09,338] INFO [Controller id=0] Removed 3 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:15:09,346] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:15:09,346] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2660, 4 -> 2737) (kafka.controller.KafkaController)
[2022-05-03 18:15:11,383] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:15:13,292] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:15:13,292] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:13,292] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:15:13,301] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:13,302] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:15:13,302] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:13,302] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:15:13,306] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:18,305] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:15:18,305] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:18,305] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:15:18,315] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:18,315] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:15:18,315] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:18,316] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:15:18,319] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) (kafka.controller.KafkaController)
[2022-05-03 18:15:19,441] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:19,441] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:19,441] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:19,442] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:15:19,442] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 4) (kafka.controller.KafkaController)
[2022-05-03 18:15:19,443] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:19,444] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:19,444] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,444] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,444] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,445] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,445] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,445] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,447] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:15:19,465] INFO [Controller id=4] 4 successfully elected as the controller. Epoch incremented to 15 and epoch zk version is now 15 (kafka.controller.KafkaController)
[2022-05-03 18:15:19,468] INFO [Controller id=4] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:15:19,471] INFO [Controller id=4] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:15:19,474] INFO [Controller id=4] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:15:19,477] INFO [Controller id=4] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:15:19,482] INFO [Controller id=4] Initialized broker epochs cache: HashMap(4 -> 2737) (kafka.controller.KafkaController)
[2022-05-03 18:15:19,494] DEBUG [Controller id=4] Register BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:15:19,505] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:15:19,511] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,512] INFO [Controller id=4] Currently active brokers in the cluster: Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:15:19,513] INFO [Controller id=4] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:15:19,513] INFO [Controller id=4] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:15:19,513] INFO [Controller id=4] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:15:19,517] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:15:19,517] INFO [Controller id=4] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:15:19,517] INFO [Controller id=4] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:15:19,518] INFO [Topic Deletion Manager 4] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:15:19,518] INFO [Controller id=4] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:15:19,526] INFO [ReplicaStateMachine controllerId=4] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:19,530] INFO [ReplicaStateMachine controllerId=4] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:19,530] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:19,547] INFO [ReplicaStateMachine controllerId=4] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:19,575] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:19,582] DEBUG [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:19,582] INFO [PartitionStateMachine controllerId=4] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:19,585] INFO [PartitionStateMachine controllerId=4] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:19,603] DEBUG [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> HashMap(Sensor-4 -> OfflinePartition, Sensor-5 -> OnlinePartition, Sensor-2 -> OnlinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:19,603] INFO [Controller id=4] Ready to serve as the new controller with epoch 15 (kafka.controller.KafkaController)
[2022-05-03 18:15:19,608] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:15:19,608] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:15:19,609] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:15:19,609] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:15:19,610] INFO [Controller id=4] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:15:19,617] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:15:19,620] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:19,620] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:19,621] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:15:19,622] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:15:19,625] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:19,626] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:19,628] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,629] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,629] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,629] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:15:19,631] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:15:32,759] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:32,783] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 16 and epoch zk version is now 16 (kafka.controller.KafkaController)
[2022-05-03 18:15:32,786] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:15:32,790] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:15:32,794] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:15:32,796] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:15:32,814] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 2855) (kafka.controller.KafkaController)
[2022-05-03 18:15:32,845] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:15:32,862] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:15:32,872] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:15:32,874] INFO [Controller id=3] Currently active brokers in the cluster: Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:15:32,875] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:15:32,875] INFO [Controller id=3] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:15:32,876] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:15:32,882] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:15:32,882] INFO [Controller id=3] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:15:32,883] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:15:32,883] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:15:32,884] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:15:32,899] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:32,905] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:32,909] INFO [RequestSendThread controllerId=3] Controller 3 connected to 127.0.0.1:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:15:32,930] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:32,978] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:15:32,979] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:32,981] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:33,014] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap(Sensor-4 -> OfflinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:15:33,014] INFO [Controller id=3] Ready to serve as the new controller with epoch 16 (kafka.controller.KafkaController)
[2022-05-03 18:15:33,021] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:15:33,021] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:15:33,021] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:15:33,022] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:15:33,024] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:15:33,033] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:15:37,681] INFO [Controller id=3] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:15:37,681] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:15:37,684] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:15:37,686] INFO [Controller id=3] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:15:37,690] INFO [RequestSendThread controllerId=3] Controller 3 connected to 127.0.0.1:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:15:37,709] DEBUG [Controller id=3] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:15:37,711] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 2855, 4 -> 2879) (kafka.controller.KafkaController)
[2022-05-03 18:15:37,745] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:37,761] DEBUG [Controller id=4] Broker 3 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:15:38,034] INFO [Controller id=3] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:15:38,035] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:15:38,038] DEBUG [Controller id=3] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:15:38,039] TRACE [Controller id=3] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:15:38,041] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] DEBUG [Controller id=3] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3), Sensor-5 -> List(5, 3, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] TRACE [Controller id=3] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] DEBUG [Controller id=3] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:15:38,042] TRACE [Controller id=3] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:15:38,043] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:15:39,055] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:15:39,060] DEBUG [Controller id=3] ISR for partition Sensor-5 updated to [4,3] and zkVersion updated to [24] (kafka.controller.KafkaController)
[2022-05-03 18:15:39,071] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:15:39,074] DEBUG [Controller id=3] ISR for partition Sensor-2 updated to [4,3] and zkVersion updated to [24] (kafka.controller.KafkaController)
[2022-05-03 18:15:42,764] INFO [Controller id=3] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:15:42,764] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:15:42,766] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:15:42,766] INFO [Controller id=3] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:15:42,770] INFO [RequestSendThread controllerId=3] Controller 3 connected to 127.0.0.1:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:15:42,778] DEBUG [Controller id=3] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:15:42,780] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 2855, 4 -> 2879, 5 -> 2899) (kafka.controller.KafkaController)
[2022-05-03 18:15:42,818] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:15:42,833] DEBUG [Controller id=5] Broker 3 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:15:43,090] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:15:43,093] DEBUG [Controller id=3] ISR for partition Sensor-5 updated to [4,3,5] and zkVersion updated to [25] (kafka.controller.KafkaController)
[2022-05-03 18:15:43,100] DEBUG [Controller id=3] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:15:43,103] DEBUG [Controller id=3] ISR for partition Sensor-2 updated to [4,3,5] and zkVersion updated to [25] (kafka.controller.KafkaController)
[2022-05-03 18:17:41,356] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,357] DEBUG [Controller id=3] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,357] DEBUG [Controller id=3] Live brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,370] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16),Sensor-5 -> (Leader:4,ISR:4,5,LeaderEpoch:18,ZkVersion:26,ControllerEpoch:16),Sensor-2 -> (Leader:4,ISR:4,5,LeaderEpoch:18,ZkVersion:26,ControllerEpoch:16),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:16),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) (kafka.controller.KafkaController)
[2022-05-03 18:17:41,372] INFO [Controller id=3] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,372] DEBUG [Controller id=3] All shutting down brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,372] DEBUG [Controller id=3] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,393] WARN [RequestSendThread controllerId=3] Controller 3 epoch 16 fails to send request (type=LeaderAndIsRequest, controllerId=3, controllerEpoch=16, brokerEpoch=2855, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=16, leader=5, leaderEpoch=19, isr=[5], zkVersion=27, replicas=[5, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=16, leader=5, leaderEpoch=19, isr=[5], zkVersion=27, replicas=[3, 5, 4], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(127.0.0.1:9097 (id: 5 rack: null))) to broker 127.0.0.1:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:41,394] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:16),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:16),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:16),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) (kafka.controller.KafkaController)
[2022-05-03 18:17:41,394] INFO [Controller id=3] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,394] DEBUG [Controller id=3] All shutting down brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:17:41,394] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:17:41,408] TRACE [Controller id=3] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:16),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:16),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:16),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) (kafka.controller.KafkaController)
[2022-05-03 18:17:41,496] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:41,598] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:41,700] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:41,801] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:41,903] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,005] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,106] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,208] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,310] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,412] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,514] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,613] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:42,614] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:42,614] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:42,615] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:17:42,615] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker 127.0.0.1:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,615] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:17:42,617] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:42,617] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:42,618] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,619] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,619] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,619] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,621] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,621] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,621] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,622] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,622] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,622] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,624] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:17:42,641] INFO [Controller id=5] 5 successfully elected as the controller. Epoch incremented to 17 and epoch zk version is now 17 (kafka.controller.KafkaController)
[2022-05-03 18:17:42,642] INFO [Controller id=5] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:17:42,645] INFO [Controller id=5] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:17:42,646] INFO [Controller id=5] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:17:42,645] DEBUG [Controller id=4] Broker 5 was elected as controller instead of broker 4 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:17:42,648] INFO [Controller id=5] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:17:42,653] INFO [Controller id=5] Initialized broker epochs cache: HashMap(4 -> 2879, 5 -> 2899) (kafka.controller.KafkaController)
[2022-05-03 18:17:42,664] DEBUG [Controller id=5] Register BrokerModifications handler for Set(4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:17:42,676] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:17:42,680] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:17:42,683] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,683] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,686] INFO [Controller id=5] Currently active brokers in the cluster: Set(4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:17:42,686] INFO [Controller id=5] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:17:42,687] INFO [Controller id=5] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:17:42,687] INFO [Controller id=5] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:17:42,692] INFO [Controller id=5] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:17:42,693] INFO [Controller id=5] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:17:42,693] INFO [Controller id=5] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:17:42,693] INFO [Topic Deletion Manager 5] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:17:42,694] INFO [Controller id=5] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:17:42,700] INFO [RequestSendThread controllerId=5] Controller 5 connected to 127.0.0.1:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,700] INFO [RequestSendThread controllerId=5] Controller 5 connected to 127.0.0.1:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:17:42,702] INFO [ReplicaStateMachine controllerId=5] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:42,707] INFO [ReplicaStateMachine controllerId=5] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:42,725] INFO [ReplicaStateMachine controllerId=5] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:42,754] DEBUG [ReplicaStateMachine controllerId=5] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:42,755] INFO [PartitionStateMachine controllerId=5] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:42,758] INFO [PartitionStateMachine controllerId=5] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:42,779] DEBUG [PartitionStateMachine controllerId=5] Started partition state machine with initial state -> HashMap(Sensor-4 -> OfflinePartition, Sensor-5 -> OnlinePartition, Sensor-2 -> OnlinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:42,779] INFO [Controller id=5] Ready to serve as the new controller with epoch 17 (kafka.controller.KafkaController)
[2022-05-03 18:17:42,784] INFO [Controller id=5] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:17:42,785] INFO [Controller id=5] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:17:42,785] INFO [Controller id=5] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:17:42,785] INFO [Controller id=5] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:17:42,787] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:42,795] INFO [Controller id=5] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:17:45,868] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:17:46,402] INFO [Controller id=5] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:17:46,402] DEBUG [Controller id=5] All shutting down brokers: 4 (kafka.controller.KafkaController)
[2022-05-03 18:17:46,403] DEBUG [Controller id=5] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:17:46,411] TRACE [Controller id=5] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:17),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) (kafka.controller.KafkaController)
[2022-05-03 18:17:46,414] INFO [Controller id=5] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:17:46,414] DEBUG [Controller id=5] All shutting down brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:17:46,414] DEBUG [Controller id=5] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:17:46,424] TRACE [Controller id=5] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:17),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) (kafka.controller.KafkaController)
[2022-05-03 18:17:46,428] WARN [RequestSendThread controllerId=5] Controller 5 epoch 17 fails to send request (type=LeaderAndIsRequest, controllerId=5, controllerEpoch=17, brokerEpoch=2879, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=17, leader=-1, leaderEpoch=14, isr=[0], zkVersion=18, replicas=[0, 4, 5], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=()) to broker 127.0.0.1:9096 (id: 4 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 4 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:46,531] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:46,633] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:46,734] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:46,836] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:46,938] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,040] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,141] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,243] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,344] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,446] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,547] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,574] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:47,575] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:47,575] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:47,576] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:17:47,576] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:17:47,577] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:47,577] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:47,578] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:17:47,590] INFO [Controller id=5] Newly added brokers: , deleted brokers: 4, bounced brokers: , all live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:17:47,592] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:17:47,593] TRACE [RequestSendThread controllerId=5] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:17:47,593] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:17:47,593] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:17:47,596] INFO [Controller id=5] Broker failure callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:17:47,597] INFO [Controller id=5] Removed 4 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:17:47,609] DEBUG [Controller id=5] Unregister BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:17:47,609] INFO [Controller id=5] Updated broker epochs cache: HashMap(5 -> 2899) (kafka.controller.KafkaController)
[2022-05-03 18:17:47,796] INFO [Controller id=5] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:17:47,797] TRACE [Controller id=5] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:17:47,800] DEBUG [Controller id=5] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:17:47,801] TRACE [Controller id=5] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] DEBUG [Controller id=5] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3)) (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] TRACE [Controller id=5] Leader imbalance ratio for broker 5 is 0.5 (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] DEBUG [Controller id=5] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] TRACE [Controller id=5] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] DEBUG [Controller id=5] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:17:47,804] TRACE [Controller id=5] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:17:47,805] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:51,428] INFO [Controller id=5] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:17:51,428] DEBUG [Controller id=5] All shutting down brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:17:51,428] DEBUG [Controller id=5] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:17:51,435] TRACE [Controller id=5] All leaders = Sensor-4 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17),Sensor-3 -> (Leader:-1,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:17),Sensor-0 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17),Sensor-1 -> (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,364] INFO [Controller id=5] Newly added brokers: 0, deleted brokers: , bounced brokers: , all live brokers: 0,5 (kafka.controller.KafkaController)
[2022-05-03 18:17:52,364] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:17:52,367] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,367] INFO [Controller id=5] New broker startup callback for 0 (kafka.controller.KafkaController)
[2022-05-03 18:17:52,369] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker 127.0.0.1:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 127.0.0.1:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:52,371] INFO [RequestSendThread controllerId=5] Controller 5 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,388] DEBUG [Controller id=5] Register BrokerModifications handler for List(0) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,390] INFO [Controller id=5] Updated broker epochs cache: HashMap(0 -> 2932, 5 -> 2899) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,418] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:52,436] DEBUG [Controller id=0] Broker 5 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:17:52,455] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:52,456] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:52,456] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:17:52,457] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:17:52,457] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set(0, 5) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,458] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:52,459] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:52,460] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,461] WARN [RequestSendThread controllerId=5] Controller 5 epoch 17 fails to send request (type: UpdateMetadataRequest=, controllerId=5, controllerEpoch=17, brokerEpoch=2932, partitionStates=[UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=17, leader=-1, leaderEpoch=14, isr=[0], zkVersion=18, replicas=[0, 5, 3], offlineReplicas=[5, 3]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=17, leader=5, leaderEpoch=19, isr=[5], zkVersion=27, replicas=[5, 3, 4], offlineReplicas=[5, 3, 4]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=17, leader=5, leaderEpoch=19, isr=[5], zkVersion=27, replicas=[3, 5, 4], offlineReplicas=[3, 5, 4]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=17, leader=-1, leaderEpoch=15, isr=[0], zkVersion=19, replicas=[4, 3, 0], offlineReplicas=[4, 3]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=17, leader=-1, leaderEpoch=14, isr=[0], zkVersion=18, replicas=[0, 4, 5], offlineReplicas=[4, 5]), UpdateMetadataPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=17, leader=-1, leaderEpoch=14, isr=[0], zkVersion=18, replicas=[5, 0, 3], offlineReplicas=[5, 3])], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='127.0.0.1', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Client was shutdown before response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:108)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:52,462] ERROR [RequestSendThread controllerId=5] Controller 5 fails to send a request to broker joao:9092 (id: 0 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1367)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:52,463] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,463] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,464] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,465] TRACE [RequestSendThread controllerId=5] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,465] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,465] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,466] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:17:52,486] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 18 and epoch zk version is now 18 (kafka.controller.KafkaController)
[2022-05-03 18:17:52,488] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:17:52,491] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:17:52,493] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:17:52,496] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:17:52,513] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 2932) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,528] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,541] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:17:52,553] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,556] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,556] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:17:52,556] INFO [Controller id=0] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:17:52,557] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:17:52,561] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:17:52,562] INFO [Controller id=0] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:17:52,562] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:17:52,563] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:17:52,565] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:17:52,577] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:52,587] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:52,591] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:17:52,613] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:52,662] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:17:52,662] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:52,665] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:52,694] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(Sensor-4 -> OnlinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OnlinePartition, Sensor-0 -> OnlinePartition, Sensor-1 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:17:52,695] INFO [Controller id=0] Ready to serve as the new controller with epoch 18 (kafka.controller.KafkaController)
[2022-05-03 18:17:52,699] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:17:52,699] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:17:52,699] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:17:52,700] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:17:52,700] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:52,708] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:17:57,710] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:17:57,710] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:17:57,713] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2022-05-03 18:17:57,714] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2022-05-03 18:17:57,714] DEBUG [Controller id=0] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3), Sensor-5 -> List(5, 3, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:17:57,714] TRACE [Controller id=0] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:17:57,715] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:57,715] DEBUG [Controller id=0] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:17:57,715] TRACE [Controller id=0] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:17:57,716] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:17:57,716] DEBUG [Controller id=0] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:17:57,716] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:17:57,716] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:18:07,303] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:18:07,303] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:18:07,306] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:18:07,309] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:18:07,312] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:18:07,325] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:18:07,326] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2932, 3 -> 2987) (kafka.controller.KafkaController)
[2022-05-03 18:18:07,356] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:07,374] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:18:07,697] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4). (kafka.controller.KafkaController)
[2022-05-03 18:18:07,701] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [0,3] and zkVersion updated to [20] (kafka.controller.KafkaController)
[2022-05-03 18:18:07,714] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:18:07,717] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [0,3] and zkVersion updated to [21] (kafka.controller.KafkaController)
[2022-05-03 18:18:07,717] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [0,3] and zkVersion updated to [20] (kafka.controller.KafkaController)
[2022-05-03 18:18:12,323] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:12,323] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:18:12,326] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:18:12,326] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:18:12,328] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:18:12,336] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:18:12,338] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2932, 3 -> 2987, 4 -> 3006) (kafka.controller.KafkaController)
[2022-05-03 18:18:12,376] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:12,395] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:18:12,673] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3). (kafka.controller.KafkaController)
[2022-05-03 18:18:12,676] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [0,3,4] and zkVersion updated to [22] (kafka.controller.KafkaController)
[2022-05-03 18:18:12,681] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-0). (kafka.controller.KafkaController)
[2022-05-03 18:18:12,683] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [0,4] and zkVersion updated to [20] (kafka.controller.KafkaController)
[2022-05-03 18:18:17,344] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:18:17,344] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:18:17,347] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:18:17,348] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:18:17,351] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:18:17,364] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:18:17,366] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2932, 3 -> 2987, 4 -> 3006, 5 -> 3025) (kafka.controller.KafkaController)
[2022-05-03 18:18:17,403] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:17,415] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:18:17,703] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4). (kafka.controller.KafkaController)
[2022-05-03 18:18:17,706] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [0,3,5] and zkVersion updated to [21] (kafka.controller.KafkaController)
[2022-05-03 18:18:17,711] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-0, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:18:17,715] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [0,4,5] and zkVersion updated to [21] (kafka.controller.KafkaController)
[2022-05-03 18:18:17,715] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [0,3,5] and zkVersion updated to [21] (kafka.controller.KafkaController)
[2022-05-03 18:18:18,674] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:18:18,679] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,3] and zkVersion updated to [30] (kafka.controller.KafkaController)
[2022-05-03 18:18:18,688] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:18:18,690] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,4] and zkVersion updated to [30] (kafka.controller.KafkaController)
[2022-05-03 18:18:19,188] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:18:19,191] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,3,4] and zkVersion updated to [31] (kafka.controller.KafkaController)
[2022-05-03 18:18:19,197] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:18:19,200] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,4,3] and zkVersion updated to [31] (kafka.controller.KafkaController)
[2022-05-03 18:18:32,060] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,060] DEBUG [Controller id=0] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,060] DEBUG [Controller id=0] Live brokers: 0,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,073] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,5,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:18),Sensor-5 -> (Leader:5,ISR:5,4,LeaderEpoch:22,ZkVersion:32,ControllerEpoch:18),Sensor-2 -> (Leader:5,ISR:5,4,LeaderEpoch:22,ZkVersion:32,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,4,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,4,5,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,5,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:32,076] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,076] DEBUG [Controller id=0] All shutting down brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,077] DEBUG [Controller id=0] Live brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,101] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,4,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,4,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:32,101] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,101] DEBUG [Controller id=0] All shutting down brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,101] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,102] WARN [RequestSendThread controllerId=0] Controller 0 epoch 18 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=18, brokerEpoch=2987, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=18, leader=4, leaderEpoch=23, isr=[4], zkVersion=33, replicas=[5, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=18, leader=4, leaderEpoch=23, isr=[4], zkVersion=33, replicas=[3, 5, 4], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(joao:9096 (id: 4 rack: null))) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,115] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:32,116] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,116] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:18:32,116] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:18:32,121] WARN [RequestSendThread controllerId=0] Controller 0 epoch 18 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=18, brokerEpoch=3025, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='Sensor', partitionStates=[StopReplicaPartitionState(partitionIndex=4, leaderEpoch=16, deletePartition=false), StopReplicaPartitionState(partitionIndex=0, leaderEpoch=15, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=16, deletePartition=false)])) to broker joao:9097 (id: 5 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 5 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,122] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:32,205] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,223] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,308] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,325] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,409] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,426] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,511] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,528] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,613] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,630] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,714] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,731] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,816] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,833] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,917] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,934] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,019] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,035] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,121] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,138] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,222] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,239] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,300] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:33,301] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:33,301] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:33,302] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:18:33,302] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:18:33,302] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:18:33,302] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:33,304] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:18:33,312] INFO [Controller id=0] Newly added brokers: , deleted brokers: 5, bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:33,313] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,313] WARN [RequestSendThread controllerId=0] Controller 0 epoch 18 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=18, brokerEpoch=3025, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='Sensor', partitionStates=[StopReplicaPartitionState(partitionIndex=4, leaderEpoch=16, deletePartition=false), StopReplicaPartitionState(partitionIndex=0, leaderEpoch=15, deletePartition=false), StopReplicaPartitionState(partitionIndex=1, leaderEpoch=16, deletePartition=false)])) to broker joao:9097 (id: 5 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,314] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,314] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,314] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,319] INFO [Controller id=0] Broker failure callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:18:33,320] INFO [Controller id=0] Removed 5 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:18:33,324] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,332] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:18:33,332] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2932, 3 -> 2987, 4 -> 3006) (kafka.controller.KafkaController)
[2022-05-03 18:18:33,425] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,464] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:33,465] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:33,465] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:33,465] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:18:33,466] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:18:33,466] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:18:33,467] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:33,469] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:18:33,477] INFO [Controller id=0] Newly added brokers: , deleted brokers: 3, bounced brokers: , all live brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:33,477] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,478] WARN [RequestSendThread controllerId=0] Controller 0 epoch 18 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=18, brokerEpoch=2987, partitionStates=[LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=5, controllerEpoch=18, leader=4, leaderEpoch=23, isr=[4], zkVersion=33, replicas=[5, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=2, controllerEpoch=18, leader=4, leaderEpoch=23, isr=[4], zkVersion=33, replicas=[3, 5, 4], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(joao:9096 (id: 4 rack: null))) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,478] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,478] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,478] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:18:33,479] INFO [Controller id=0] Broker failure callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:18:33,479] INFO [Controller id=0] Removed 3 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:18:33,490] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:18:33,490] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2932, 4 -> 3006) (kafka.controller.KafkaController)
[2022-05-03 18:18:37,121] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:18:37,121] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:37,121] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:18:37,127] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:37,128] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:18:37,128] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:37,128] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:18:37,133] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:42,131] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:18:42,131] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:42,131] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:18:42,137] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:42,137] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:18:42,137] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:18:42,137] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:18:42,142] TRACE [Controller id=0] All leaders = Sensor-4 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-5 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-2 -> (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18),Sensor-3 -> (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18),Sensor-0 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18),Sensor-1 -> (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) (kafka.controller.KafkaController)
[2022-05-03 18:18:43,174] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:43,175] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:43,175] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:43,176] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:18:43,176] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 4) (kafka.controller.KafkaController)
[2022-05-03 18:18:43,177] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:18:43,177] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:43,178] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,178] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,178] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,179] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,179] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,179] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,181] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:18:43,197] INFO [Controller id=4] 4 successfully elected as the controller. Epoch incremented to 19 and epoch zk version is now 19 (kafka.controller.KafkaController)
[2022-05-03 18:18:43,199] INFO [Controller id=4] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:18:43,202] INFO [Controller id=4] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:18:43,204] INFO [Controller id=4] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:18:43,206] INFO [Controller id=4] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:18:43,212] INFO [Controller id=4] Initialized broker epochs cache: HashMap(4 -> 3006) (kafka.controller.KafkaController)
[2022-05-03 18:18:43,222] DEBUG [Controller id=4] Register BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:18:43,231] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:18:43,235] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,237] INFO [Controller id=4] Currently active brokers in the cluster: Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:18:43,237] INFO [Controller id=4] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:18:43,237] INFO [Controller id=4] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:18:43,238] INFO [Controller id=4] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:18:43,241] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:18:43,241] INFO [Controller id=4] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:18:43,241] INFO [Controller id=4] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:18:43,241] INFO [Topic Deletion Manager 4] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:18:43,242] INFO [Controller id=4] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:18:43,247] INFO [ReplicaStateMachine controllerId=4] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:43,250] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:43,250] INFO [ReplicaStateMachine controllerId=4] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:43,267] INFO [ReplicaStateMachine controllerId=4] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:43,298] DEBUG [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:43,299] INFO [PartitionStateMachine controllerId=4] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:18:43,303] INFO [PartitionStateMachine controllerId=4] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:18:43,311] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:43,322] DEBUG [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> HashMap(Sensor-4 -> OfflinePartition, Sensor-5 -> OnlinePartition, Sensor-2 -> OnlinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:18:43,322] INFO [Controller id=4] Ready to serve as the new controller with epoch 19 (kafka.controller.KafkaController)
[2022-05-03 18:18:43,327] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:18:43,327] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:18:43,327] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:18:43,327] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:18:43,329] INFO [Controller id=4] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:18:43,336] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:18:43,338] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:43,338] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:18:43,339] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:18:43,340] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:18:43,342] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:18:43,342] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:18:43,343] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,345] WARN [RequestSendThread controllerId=4] Controller 4 epoch 19 fails to send request (type: UpdateMetadataRequest=, controllerId=4, controllerEpoch=19, brokerEpoch=3006, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9096 (id: 4 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:43,346] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,346] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,346] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:18:43,348] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:18:56,089] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:19:02,476] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:19:02,504] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 20 and epoch zk version is now 20 (kafka.controller.KafkaController)
[2022-05-03 18:19:02,506] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:19:02,511] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:19:02,515] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:19:02,518] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:19:02,534] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 3073) (kafka.controller.KafkaController)
[2022-05-03 18:19:02,571] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:19:02,584] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:19:02,593] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:19:02,596] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:19:02,596] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:19:02,597] INFO [Controller id=0] Current list of topics in the cluster: HashSet(Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:19:02,597] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:19:02,605] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:19:02,605] INFO [Controller id=0] List of topics ineligible for deletion: Sensor (kafka.controller.KafkaController)
[2022-05-03 18:19:02,605] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:19:02,605] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:19:02,606] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:19:02,619] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:19:02,625] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:19:02,628] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:19:02,652] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:19:02,696] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:19:02,697] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:19:02,700] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:19:02,742] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(Sensor-4 -> OnlinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OnlinePartition, Sensor-0 -> OnlinePartition, Sensor-1 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:19:02,742] INFO [Controller id=0] Ready to serve as the new controller with epoch 20 (kafka.controller.KafkaController)
[2022-05-03 18:19:02,748] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:19:02,748] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:19:02,748] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:19:02,749] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:19:02,750] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:19:02,760] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:19:07,761] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:19:07,762] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:19:07,767] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2022-05-03 18:19:07,769] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2022-05-03 18:19:07,769] DEBUG [Controller id=0] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3), Sensor-5 -> List(5, 3, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:19:07,769] TRACE [Controller id=0] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:19:07,772] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:19:07,773] DEBUG [Controller id=0] Topics not in preferred replica for broker 3 HashMap(Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:19:07,773] TRACE [Controller id=0] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:19:07,773] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:19:07,773] DEBUG [Controller id=0] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:19:07,773] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:19:07,773] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:19:17,400] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:19:17,401] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:19:17,404] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:19:17,406] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:19:17,409] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:19:17,421] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:19:17,423] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3073, 3 -> 3127) (kafka.controller.KafkaController)
[2022-05-03 18:19:17,457] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:19:17,473] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:19:17,756] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4). (kafka.controller.KafkaController)
[2022-05-03 18:19:17,760] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [0,3] and zkVersion updated to [26] (kafka.controller.KafkaController)
[2022-05-03 18:19:17,770] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:19:17,773] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [0,3] and zkVersion updated to [27] (kafka.controller.KafkaController)
[2022-05-03 18:19:17,773] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [0,3] and zkVersion updated to [26] (kafka.controller.KafkaController)
[2022-05-03 18:19:22,465] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:19:22,466] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:19:22,469] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:19:22,469] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:19:22,472] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:19:22,480] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:19:22,482] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3073, 3 -> 3127, 4 -> 3146) (kafka.controller.KafkaController)
[2022-05-03 18:19:22,518] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:19:22,532] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:19:22,806] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-3). (kafka.controller.KafkaController)
[2022-05-03 18:19:22,810] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [0,3,4] and zkVersion updated to [28] (kafka.controller.KafkaController)
[2022-05-03 18:19:22,815] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-0). (kafka.controller.KafkaController)
[2022-05-03 18:19:22,817] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [0,4] and zkVersion updated to [26] (kafka.controller.KafkaController)
[2022-05-03 18:19:23,781] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:19:23,784] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [4,3] and zkVersion updated to [36] (kafka.controller.KafkaController)
[2022-05-03 18:19:23,794] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:19:23,797] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [4,3] and zkVersion updated to [36] (kafka.controller.KafkaController)
[2022-05-03 18:19:27,491] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:19:27,491] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:19:27,495] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:19:27,495] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:19:27,499] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:19:27,501] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:19:27,503] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3073, 3 -> 3127, 4 -> 3146, 5 -> 3168) (kafka.controller.KafkaController)
[2022-05-03 18:19:27,548] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:19:27,565] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:19:27,846] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4). (kafka.controller.KafkaController)
[2022-05-03 18:19:27,849] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [0,3,5] and zkVersion updated to [27] (kafka.controller.KafkaController)
[2022-05-03 18:19:27,852] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-5). (kafka.controller.KafkaController)
[2022-05-03 18:19:27,856] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [4,3,5] and zkVersion updated to [37] (kafka.controller.KafkaController)
[2022-05-03 18:19:27,859] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-0, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:19:27,864] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [0,4,5] and zkVersion updated to [27] (kafka.controller.KafkaController)
[2022-05-03 18:19:27,864] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [0,3,5] and zkVersion updated to [27] (kafka.controller.KafkaController)
[2022-05-03 18:19:27,866] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-2). (kafka.controller.KafkaController)
[2022-05-03 18:19:27,869] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [4,3,5] and zkVersion updated to [37] (kafka.controller.KafkaController)
[2022-05-03 18:22:58,473] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:23:34,125] INFO [Controller id=0] New topics: [Set(novotopico)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(novotopico,Some(fcXV4rFISVKrI93XVPF7NA),HashMap(novotopico-1 -> ReplicaAssignment(replicas=5,3,4, addingReplicas=, removingReplicas=), novotopico-2 -> ReplicaAssignment(replicas=3,4,0, addingReplicas=, removingReplicas=), novotopico-4 -> ReplicaAssignment(replicas=0,3,4, addingReplicas=, removingReplicas=), novotopico-5 -> ReplicaAssignment(replicas=5,4,0, addingReplicas=, removingReplicas=), novotopico-3 -> ReplicaAssignment(replicas=4,0,5, addingReplicas=, removingReplicas=), novotopico-0 -> ReplicaAssignment(replicas=0,5,3, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:23:34,126] INFO [Controller id=0] New partition creation callback for novotopico-1,novotopico-2,novotopico-4,novotopico-5,novotopico-3,novotopico-0 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,126] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,126] DEBUG [Controller id=0] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,126] DEBUG [Controller id=0] Live brokers: 0,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,153] TRACE [Controller id=0] All leaders = novotopico-0 -> (Leader:0,ISR:0,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20),novotopico-1 -> (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20),novotopico-2 -> (Leader:4,ISR:4,0,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20),novotopico-3 -> (Leader:4,ISR:4,0,5,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:20),novotopico-4 -> (Leader:0,ISR:0,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20),novotopico-5 -> (Leader:5,ISR:5,4,0,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:20),Sensor-4 -> (Leader:0,ISR:0,5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:20),Sensor-5 -> (Leader:4,ISR:4,5,LeaderEpoch:26,ZkVersion:38,ControllerEpoch:20),Sensor-2 -> (Leader:4,ISR:4,5,LeaderEpoch:26,ZkVersion:38,ControllerEpoch:20),Sensor-3 -> (Leader:0,ISR:0,4,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20),Sensor-0 -> (Leader:0,ISR:0,4,5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:20),Sensor-1 -> (Leader:0,ISR:0,5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:20) (kafka.controller.KafkaController)
[2022-05-03 18:24:03,156] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,157] DEBUG [Controller id=0] All shutting down brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,157] DEBUG [Controller id=0] Live brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,180] WARN [RequestSendThread controllerId=0] Controller 0 epoch 20 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=20, brokerEpoch=3127, partitionStates=[LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=0, controllerEpoch=20, leader=5, leaderEpoch=2, isr=[5], zkVersion=2, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=4, controllerEpoch=20, leader=4, leaderEpoch=2, isr=[4], zkVersion=2, replicas=[0, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=20, leader=4, leaderEpoch=22, isr=[4], zkVersion=30, replicas=[4, 3, 0], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={novotopico=fcXV4rFISVKrI93XVPF7NA, Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(joao:9097 (id: 5 rack: null), joao:9096 (id: 4 rack: null))) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 3 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,181] TRACE [Controller id=0] All leaders = novotopico-0 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-1 -> (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20),novotopico-2 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-3 -> (Leader:4,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20),novotopico-4 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-5 -> (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20),Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20),Sensor-5 -> (Leader:4,ISR:4,5,LeaderEpoch:26,ZkVersion:38,ControllerEpoch:20),Sensor-2 -> (Leader:4,ISR:4,5,LeaderEpoch:26,ZkVersion:38,ControllerEpoch:20),Sensor-3 -> (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:20),Sensor-0 -> (Leader:4,ISR:4,5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:20),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20) (kafka.controller.KafkaController)
[2022-05-03 18:24:03,181] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,181] DEBUG [Controller id=0] All shutting down brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,182] DEBUG [Controller id=0] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,198] WARN [RequestSendThread controllerId=0] Controller 0 epoch 20 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=20, brokerEpoch=3073, partitionStates=[LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=0, controllerEpoch=20, leader=5, leaderEpoch=2, isr=[5], zkVersion=2, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=4, controllerEpoch=20, leader=4, leaderEpoch=2, isr=[4], zkVersion=2, replicas=[0, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=20, leader=4, leaderEpoch=22, isr=[4], zkVersion=30, replicas=[4, 3, 0], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=20, leader=4, leaderEpoch=20, isr=[4, 5], zkVersion=28, replicas=[0, 4, 5], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={novotopico=fcXV4rFISVKrI93XVPF7NA, Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(joao:9097 (id: 5 rack: null), joao:9096 (id: 4 rack: null))) to broker joao:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 0 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,211] TRACE [Controller id=0] All leaders = novotopico-0 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-1 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-2 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-3 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-4 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-5 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:20),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:20),Sensor-3 -> (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:20),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20) (kafka.controller.KafkaController)
[2022-05-03 18:24:03,212] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,212] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,212] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:24:03,223] TRACE [Controller id=0] All leaders = novotopico-0 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-1 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-2 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-3 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-4 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),novotopico-5 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20),Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:20),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:20),Sensor-3 -> (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:20),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20) (kafka.controller.KafkaController)
[2022-05-03 18:24:03,283] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,299] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,384] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,401] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,485] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,503] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,587] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,604] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,688] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,706] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,789] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,807] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,891] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,910] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,943] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:03,943] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:03,943] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:03,944] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:24:03,945] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:24:03,946] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:03,947] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:03,948] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,948] WARN [RequestSendThread controllerId=0] Controller 0 epoch 20 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=20, brokerEpoch=3073, partitionStates=[LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=0, controllerEpoch=20, leader=5, leaderEpoch=2, isr=[5], zkVersion=2, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=4, controllerEpoch=20, leader=4, leaderEpoch=2, isr=[4], zkVersion=2, replicas=[0, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=20, leader=4, leaderEpoch=22, isr=[4], zkVersion=30, replicas=[4, 3, 0], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=0, controllerEpoch=20, leader=4, leaderEpoch=20, isr=[4, 5], zkVersion=28, replicas=[0, 4, 5], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={novotopico=fcXV4rFISVKrI93XVPF7NA, Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(joao:9097 (id: 5 rack: null), joao:9096 (id: 4 rack: null))) to broker joao:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,948] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,948] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,948] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,950] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,950] WARN [RequestSendThread controllerId=0] Controller 0 epoch 20 fails to send request (type=LeaderAndIsRequest, controllerId=0, controllerEpoch=20, brokerEpoch=3127, partitionStates=[LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=0, controllerEpoch=20, leader=5, leaderEpoch=2, isr=[5], zkVersion=2, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=4, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[0, 5, 3], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='novotopico', partitionIndex=4, controllerEpoch=20, leader=4, leaderEpoch=2, isr=[4], zkVersion=2, replicas=[0, 3, 4], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=3, controllerEpoch=20, leader=4, leaderEpoch=22, isr=[4], zkVersion=30, replicas=[4, 3, 0], addingReplicas=[], removingReplicas=[], isNew=false), LeaderAndIsrPartitionState(topicName='Sensor', partitionIndex=1, controllerEpoch=20, leader=5, leaderEpoch=21, isr=[5], zkVersion=29, replicas=[5, 0, 3], addingReplicas=[], removingReplicas=[], isNew=false)], topicIds={novotopico=fcXV4rFISVKrI93XVPF7NA, Sensor=BCF8YbqYQc-QKvdDxoooJQ}, liveLeaders=(joao:9097 (id: 5 rack: null), joao:9096 (id: 4 rack: null))) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,951] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,951] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,951] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,952] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,952] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,952] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,954] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,954] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,954] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:03,956] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:24:03,971] INFO [Controller id=5] 5 successfully elected as the controller. Epoch incremented to 21 and epoch zk version is now 21 (kafka.controller.KafkaController)
[2022-05-03 18:24:03,973] INFO [Controller id=5] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:24:03,976] DEBUG [Controller id=4] Broker 5 was elected as controller instead of broker 4 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:24:03,977] INFO [Controller id=5] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:24:03,977] DEBUG [Controller id=3] Broker 5 was elected as controller instead of broker 3 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:24:03,979] INFO [Controller id=5] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:24:03,980] INFO [Controller id=5] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:24:03,986] INFO [Controller id=5] Initialized broker epochs cache: HashMap(3 -> 3127, 4 -> 3146, 5 -> 3168) (kafka.controller.KafkaController)
[2022-05-03 18:24:04,009] DEBUG [Controller id=5] Register BrokerModifications handler for Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:24:04,024] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:24:04,027] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:24:04,029] DEBUG [Channel manager on controller 5]: Controller 5 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:24:04,032] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,032] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,032] INFO [RequestSendThread controllerId=5] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,034] INFO [Controller id=5] Currently active brokers in the cluster: Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:24:04,034] INFO [Controller id=5] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:24:04,034] INFO [Controller id=5] Current list of topics in the cluster: HashSet(novotopico, Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:24:04,034] INFO [Controller id=5] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:24:04,039] INFO [Controller id=5] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:24:04,039] INFO [Controller id=5] List of topics ineligible for deletion: novotopico,Sensor (kafka.controller.KafkaController)
[2022-05-03 18:24:04,039] INFO [Controller id=5] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:24:04,039] INFO [Topic Deletion Manager 5] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(novotopico, Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:24:04,040] INFO [Controller id=5] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:24:04,048] INFO [RequestSendThread controllerId=5] Controller 5 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,048] INFO [RequestSendThread controllerId=5] Controller 5 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,049] INFO [ReplicaStateMachine controllerId=5] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:04,050] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:04,053] INFO [ReplicaStateMachine controllerId=5] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:04,074] INFO [ReplicaStateMachine controllerId=5] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:04,092] DEBUG [ReplicaStateMachine controllerId=5] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=5,Replica=3] -> OnlineReplica, [Topic=novotopico,Partition=3,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=0,Replica=5] -> OnlineReplica, [Topic=novotopico,Partition=2,Replica=3] -> OnlineReplica, [Topic=novotopico,Partition=5,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=5,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OnlineReplica, [Topic=novotopico,Partition=3,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=3,Replica=5] -> OnlineReplica, [Topic=novotopico,Partition=4,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=1,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=4,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=3] -> OnlineReplica, [Topic=novotopico,Partition=0,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=5,Replica=5] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=0,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OnlineReplica, [Topic=novotopico,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=1,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=4,Replica=3] -> OnlineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OnlineReplica, [Topic=novotopico,Partition=1,Replica=5] -> OnlineReplica, [Topic=novotopico,Partition=2,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:04,093] INFO [PartitionStateMachine controllerId=5] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:04,096] INFO [PartitionStateMachine controllerId=5] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:04,097] DEBUG [PartitionStateMachine controllerId=5] Started partition state machine with initial state -> HashMap(novotopico-0 -> OnlinePartition, novotopico-1 -> OnlinePartition, novotopico-2 -> OnlinePartition, novotopico-3 -> OnlinePartition, novotopico-4 -> OnlinePartition, novotopico-5 -> OnlinePartition, Sensor-4 -> OnlinePartition, Sensor-5 -> OnlinePartition, Sensor-2 -> OnlinePartition, Sensor-3 -> OnlinePartition, Sensor-0 -> OnlinePartition, Sensor-1 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:04,097] INFO [Controller id=5] Ready to serve as the new controller with epoch 21 (kafka.controller.KafkaController)
[2022-05-03 18:24:04,102] INFO [Controller id=5] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:24:04,102] INFO [Controller id=5] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:24:04,102] INFO [Controller id=5] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:24:04,103] INFO [Controller id=5] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:24:04,104] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:24:04,112] INFO [Controller id=5] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:24:04,152] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:04,248] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:04,248] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:04,248] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:04,249] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:24:04,250] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:24:04,250] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:04,251] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:04,252] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:24:04,254] WARN [RequestSendThread controllerId=5] Controller 5's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:04,264] INFO [Controller id=5] Newly added brokers: , deleted brokers: 3, bounced brokers: , all live brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:24:04,265] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,266] WARN [RequestSendThread controllerId=5] Controller 5 epoch 21 fails to send request (type: UpdateMetadataRequest=, controllerId=5, controllerEpoch=21, brokerEpoch=3127, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:04,267] TRACE [RequestSendThread controllerId=5] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,267] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,267] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:04,270] INFO [Controller id=5] Broker failure callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:24:04,278] DEBUG [Controller id=5] Unregister BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:24:04,278] INFO [Controller id=5] Updated broker epochs cache: HashMap(4 -> 3146, 5 -> 3168) (kafka.controller.KafkaController)
[2022-05-03 18:24:08,205] INFO [Controller id=5] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:24:08,206] DEBUG [Controller id=5] All shutting down brokers: 4 (kafka.controller.KafkaController)
[2022-05-03 18:24:08,206] DEBUG [Controller id=5] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:24:08,228] TRACE [Controller id=5] All leaders = novotopico-0 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-1 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-2 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-3 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-4 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-5 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-3 -> (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:21),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) (kafka.controller.KafkaController)
[2022-05-03 18:24:08,230] INFO [Controller id=5] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:24:08,230] DEBUG [Controller id=5] All shutting down brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:24:08,230] DEBUG [Controller id=5] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:24:08,236] TRACE [Controller id=5] All leaders = novotopico-0 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-1 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-2 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-3 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-4 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-5 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-3 -> (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:21),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) (kafka.controller.KafkaController)
[2022-05-03 18:24:09,114] INFO [Controller id=5] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:24:09,114] TRACE [Controller id=5] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:24:09,116] DEBUG [Controller id=5] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5), novotopico-4 -> List(0, 3, 4), novotopico-0 -> List(0, 5, 3)) (kafka.controller.KafkaController)
[2022-05-03 18:24:09,116] TRACE [Controller id=5] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] DEBUG [Controller id=5] Topics not in preferred replica for broker 5 HashMap() (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] TRACE [Controller id=5] Leader imbalance ratio for broker 5 is 0.0 (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] DEBUG [Controller id=5] Topics not in preferred replica for broker 3 HashMap(novotopico-2 -> List(3, 4, 0), Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] TRACE [Controller id=5] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] DEBUG [Controller id=5] Topics not in preferred replica for broker 4 HashMap(novotopico-3 -> List(4, 0, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] TRACE [Controller id=5] Leader imbalance ratio for broker 4 is 0.5 (kafka.controller.KafkaController)
[2022-05-03 18:24:09,117] INFO [Controller id=5] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:24:13,234] INFO [Controller id=5] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:24:13,234] DEBUG [Controller id=5] All shutting down brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:24:13,234] DEBUG [Controller id=5] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:24:13,244] TRACE [Controller id=5] All leaders = novotopico-0 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-1 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-2 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-3 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-4 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-5 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-3 -> (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:21),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) (kafka.controller.KafkaController)
[2022-05-03 18:24:13,245] INFO [Controller id=5] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:24:13,245] DEBUG [Controller id=5] All shutting down brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:24:13,245] DEBUG [Controller id=5] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:24:13,253] TRACE [Controller id=5] All leaders = novotopico-0 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-1 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-2 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-3 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-4 -> (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),novotopico-5 -> (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21),Sensor-4 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-5 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-2 -> (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21),Sensor-3 -> (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:21),Sensor-0 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21),Sensor-1 -> (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) (kafka.controller.KafkaController)
[2022-05-03 18:24:14,146] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:14,147] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:14,147] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:14,148] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:24:14,148] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set(4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:24:14,149] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:14,150] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:14,150] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,151] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,151] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,152] INFO [RequestSendThread controllerId=5] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,152] INFO [RequestSendThread controllerId=5] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,152] INFO [RequestSendThread controllerId=5] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,153] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:24:14,164] INFO [Controller id=4] 4 successfully elected as the controller. Epoch incremented to 22 and epoch zk version is now 22 (kafka.controller.KafkaController)
[2022-05-03 18:24:14,165] INFO [Controller id=4] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:24:14,169] INFO [Controller id=4] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:24:14,170] INFO [Controller id=4] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:24:14,172] INFO [Controller id=4] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:24:14,178] INFO [Controller id=4] Initialized broker epochs cache: HashMap(4 -> 3146) (kafka.controller.KafkaController)
[2022-05-03 18:24:14,190] DEBUG [Controller id=4] Register BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:24:14,206] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:24:14,212] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,214] INFO [Controller id=4] Currently active brokers in the cluster: Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:24:14,214] INFO [Controller id=4] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:24:14,215] INFO [Controller id=4] Current list of topics in the cluster: HashSet(novotopico, Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:24:14,215] INFO [Controller id=4] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:24:14,220] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:24:14,220] INFO [Controller id=4] List of topics ineligible for deletion: novotopico,Sensor (kafka.controller.KafkaController)
[2022-05-03 18:24:14,220] INFO [Controller id=4] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:24:14,220] INFO [Topic Deletion Manager 4] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(novotopico, Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:24:14,221] INFO [Controller id=4] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:24:14,228] INFO [ReplicaStateMachine controllerId=4] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:14,229] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,231] INFO [ReplicaStateMachine controllerId=4] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:14,248] INFO [ReplicaStateMachine controllerId=4] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:14,286] DEBUG [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=3,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=0,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=2,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=5,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=5,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=3,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=3,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=4,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=1,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=4,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=0,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OnlineReplica, [Topic=novotopico,Partition=0,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=2,Replica=4] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OfflineReplica, [Topic=novotopico,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=1,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=2,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:14,286] INFO [PartitionStateMachine controllerId=4] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:14,289] INFO [PartitionStateMachine controllerId=4] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:14,310] DEBUG [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> HashMap(novotopico-0 -> OfflinePartition, novotopico-1 -> OfflinePartition, novotopico-2 -> OnlinePartition, novotopico-3 -> OfflinePartition, novotopico-4 -> OnlinePartition, novotopico-5 -> OfflinePartition, Sensor-4 -> OfflinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OnlinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:14,310] INFO [Controller id=4] Ready to serve as the new controller with epoch 22 (kafka.controller.KafkaController)
[2022-05-03 18:24:14,314] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:24:14,314] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:24:14,314] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:24:14,314] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:24:14,315] INFO [Controller id=4] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:24:14,320] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:24:14,331] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,434] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,525] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:14,525] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:14,525] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:24:14,526] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:24:14,527] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:24:14,528] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:24:14,529] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:24:14,529] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,531] WARN [RequestSendThread controllerId=4] Controller 4 epoch 22 fails to send request (type: UpdateMetadataRequest=, controllerId=4, controllerEpoch=22, brokerEpoch=3146, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9096 (id: 4 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,531] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,531] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,531] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:24:14,533] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:25:04,770] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:25:11,148] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:25:11,173] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 23 and epoch zk version is now 23 (kafka.controller.KafkaController)
[2022-05-03 18:25:11,175] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:25:11,179] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:25:11,183] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:25:11,186] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:25:11,203] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 3346) (kafka.controller.KafkaController)
[2022-05-03 18:25:11,233] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:25:11,252] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:25:11,262] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:25:11,264] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:25:11,265] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:25:11,265] INFO [Controller id=0] Current list of topics in the cluster: HashSet(novotopico, Sensor) (kafka.controller.KafkaController)
[2022-05-03 18:25:11,265] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:25:11,272] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:25:11,272] INFO [Controller id=0] List of topics ineligible for deletion: novotopico,Sensor (kafka.controller.KafkaController)
[2022-05-03 18:25:11,273] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:25:11,273] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(novotopico, Sensor) (kafka.controller.TopicDeletionManager)
[2022-05-03 18:25:11,275] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:25:11,288] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:25:11,296] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:25:11,297] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:25:11,325] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:25:11,381] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=Sensor,Partition=5,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=3,Replica=0] -> OnlineReplica, [Topic=novotopico,Partition=0,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=2,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=5,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=2,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=4] -> OfflineReplica, [Topic=novotopico,Partition=5,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=4,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=1,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=3,Replica=4] -> OfflineReplica, [Topic=novotopico,Partition=3,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=4,Replica=0] -> OnlineReplica, [Topic=novotopico,Partition=1,Replica=4] -> OfflineReplica, [Topic=novotopico,Partition=4,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=0,Replica=0] -> OnlineReplica, [Topic=Sensor,Partition=4,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=0,Replica=0] -> OnlineReplica, [Topic=novotopico,Partition=5,Replica=5] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=4] -> OfflineReplica, [Topic=novotopico,Partition=0,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=2,Replica=3] -> OfflineReplica, [Topic=novotopico,Partition=2,Replica=4] -> OfflineReplica, [Topic=Sensor,Partition=1,Replica=0] -> OnlineReplica, [Topic=novotopico,Partition=1,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=3,Replica=0] -> OnlineReplica, [Topic=novotopico,Partition=4,Replica=3] -> OfflineReplica, [Topic=Sensor,Partition=5,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=1,Replica=5] -> OfflineReplica, [Topic=novotopico,Partition=2,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:25:11,382] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:25:11,385] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:25:11,428] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(novotopico-0 -> OfflinePartition, novotopico-1 -> OfflinePartition, novotopico-2 -> OfflinePartition, novotopico-3 -> OfflinePartition, novotopico-4 -> OfflinePartition, novotopico-5 -> OfflinePartition, Sensor-4 -> OfflinePartition, Sensor-5 -> OfflinePartition, Sensor-2 -> OfflinePartition, Sensor-3 -> OfflinePartition, Sensor-0 -> OfflinePartition, Sensor-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:25:11,429] INFO [Controller id=0] Ready to serve as the new controller with epoch 23 (kafka.controller.KafkaController)
[2022-05-03 18:25:11,435] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:25:11,435] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:25:11,435] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:25:11,436] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:25:11,437] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:25:11,446] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:25:16,447] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:25:16,448] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:25:16,450] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5), novotopico-4 -> List(0, 3, 4), novotopico-0 -> List(0, 5, 3)) (kafka.controller.KafkaController)
[2022-05-03 18:25:16,451] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:25:16,453] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:25:16,453] DEBUG [Controller id=0] Topics not in preferred replica for broker 5 HashMap(Sensor-1 -> List(5, 0, 3), novotopico-1 -> List(5, 3, 4), Sensor-5 -> List(5, 3, 4), novotopico-5 -> List(5, 4, 0)) (kafka.controller.KafkaController)
[2022-05-03 18:25:16,453] TRACE [Controller id=0] Leader imbalance ratio for broker 5 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:25:16,453] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:25:16,454] DEBUG [Controller id=0] Topics not in preferred replica for broker 3 HashMap(novotopico-2 -> List(3, 4, 0), Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:25:16,454] TRACE [Controller id=0] Leader imbalance ratio for broker 3 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:25:16,454] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:25:16,454] DEBUG [Controller id=0] Topics not in preferred replica for broker 4 HashMap(Sensor-3 -> List(4, 3, 0), novotopico-3 -> List(4, 0, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:25:16,454] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 1.0 (kafka.controller.KafkaController)
[2022-05-03 18:25:16,454] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:25:26,074] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:25:26,075] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:25:26,078] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:25:26,081] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:25:26,085] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:25:26,103] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:25:26,105] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3346, 3 -> 3406) (kafka.controller.KafkaController)
[2022-05-03 18:25:26,120] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:25:26,134] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:25:31,164] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:25:31,164] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:25:31,168] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:25:31,168] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:25:31,170] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:25:31,187] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:25:31,190] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3346, 3 -> 3406, 4 -> 3422) (kafka.controller.KafkaController)
[2022-05-03 18:25:31,224] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:25:31,243] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:25:32,527] DEBUG [Controller id=0] Updating ISRs for partitions: Set(novotopico-2). (kafka.controller.KafkaController)
[2022-05-03 18:25:32,532] DEBUG [Controller id=0] ISR for partition novotopico-2 updated to [4,3] and zkVersion updated to [5] (kafka.controller.KafkaController)
[2022-05-03 18:25:32,545] DEBUG [Controller id=0] Updating ISRs for partitions: Set(novotopico-4, Sensor-3). (kafka.controller.KafkaController)
[2022-05-03 18:25:32,547] DEBUG [Controller id=0] ISR for partition novotopico-4 updated to [4,0] and zkVersion updated to [5] (kafka.controller.KafkaController)
[2022-05-03 18:25:32,547] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [4,0] and zkVersion updated to [33] (kafka.controller.KafkaController)
[2022-05-03 18:25:33,036] DEBUG [Controller id=0] Updating ISRs for partitions: Set(novotopico-4). (kafka.controller.KafkaController)
[2022-05-03 18:25:33,039] DEBUG [Controller id=0] ISR for partition novotopico-4 updated to [4,0,3] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:25:33,045] DEBUG [Controller id=0] Updating ISRs for partitions: Set(novotopico-2, Sensor-3). (kafka.controller.KafkaController)
[2022-05-03 18:25:33,047] DEBUG [Controller id=0] ISR for partition novotopico-2 updated to [4,3,0] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:25:33,047] DEBUG [Controller id=0] ISR for partition Sensor-3 updated to [4,0,3] and zkVersion updated to [34] (kafka.controller.KafkaController)
[2022-05-03 18:25:36,187] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:25:36,187] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:25:36,190] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:25:36,190] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:25:36,194] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:25:36,206] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:25:36,207] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3346, 3 -> 3406, 4 -> 3422, 5 -> 3448) (kafka.controller.KafkaController)
[2022-05-03 18:25:36,246] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:25:36,262] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:25:37,526] DEBUG [Controller id=0] Updating ISRs for partitions: Set(novotopico-0, novotopico-1). (kafka.controller.KafkaController)
[2022-05-03 18:25:37,530] DEBUG [Controller id=0] ISR for partition novotopico-0 updated to [5,0] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,530] DEBUG [Controller id=0] ISR for partition novotopico-1 updated to [5,4] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,540] DEBUG [Controller id=0] Updating ISRs for partitions: Set(Sensor-4, Sensor-5, novotopico-3, Sensor-2, novotopico-5, Sensor-0, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:25:37,543] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [5,0] and zkVersion updated to [33] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,543] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,3] and zkVersion updated to [43] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,543] DEBUG [Controller id=0] ISR for partition novotopico-5 updated to [5,0] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,543] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,3] and zkVersion updated to [43] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,543] DEBUG [Controller id=0] ISR for partition novotopico-3 updated to [5,0] and zkVersion updated to [6] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,543] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [5,0] and zkVersion updated to [33] (kafka.controller.KafkaController)
[2022-05-03 18:25:37,543] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [5,0] and zkVersion updated to [33] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,043] DEBUG [Controller id=0] Updating ISRs for partitions: Set(novotopico-0). (kafka.controller.KafkaController)
[2022-05-03 18:25:38,047] DEBUG [Controller id=0] ISR for partition novotopico-0 updated to [5,0,3] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,052] DEBUG [Controller id=0] Updating ISRs for partitions: Set(novotopico-1, Sensor-4, Sensor-5, novotopico-3, Sensor-2, novotopico-5, Sensor-0, Sensor-1). (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition novotopico-1 updated to [5,4,3] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition Sensor-0 updated to [5,0,4] and zkVersion updated to [34] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition Sensor-5 updated to [5,3,4] and zkVersion updated to [44] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition novotopico-5 updated to [5,0,4] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition Sensor-2 updated to [5,3,4] and zkVersion updated to [44] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition novotopico-3 updated to [5,0,4] and zkVersion updated to [7] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition Sensor-1 updated to [5,0,3] and zkVersion updated to [34] (kafka.controller.KafkaController)
[2022-05-03 18:25:38,056] DEBUG [Controller id=0] ISR for partition Sensor-4 updated to [5,0,3] and zkVersion updated to [34] (kafka.controller.KafkaController)
[2022-05-03 18:25:40,477] INFO [Controller id=0] New topics: [Set(novotopico2)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(novotopico2,Some(n453AvpcTgWuCEskdMGx_A),HashMap(novotopico2-4 -> ReplicaAssignment(replicas=3,0,5, addingReplicas=, removingReplicas=), novotopico2-3 -> ReplicaAssignment(replicas=5,3,4, addingReplicas=, removingReplicas=), novotopico2-2 -> ReplicaAssignment(replicas=0,5,3, addingReplicas=, removingReplicas=), novotopico2-0 -> ReplicaAssignment(replicas=3,4,0, addingReplicas=, removingReplicas=), novotopico2-5 -> ReplicaAssignment(replicas=4,5,3, addingReplicas=, removingReplicas=), novotopico2-1 -> ReplicaAssignment(replicas=4,0,5, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:25:40,477] INFO [Controller id=0] New partition creation callback for novotopico2-4,novotopico2-3,novotopico2-2,novotopico2-0,novotopico2-5,novotopico2-1 (kafka.controller.KafkaController)
[2022-05-03 18:29:18,686] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:29:54,275] INFO [Controller id=0] New topics: [Set(novotopico3)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(novotopico3,Some(jrukgOU9TTCvicfbqWTloA),HashMap(novotopico3-5 -> ReplicaAssignment(replicas=3,4,0, addingReplicas=, removingReplicas=), novotopico3-1 -> ReplicaAssignment(replicas=3,5,4, addingReplicas=, removingReplicas=), novotopico3-4 -> ReplicaAssignment(replicas=5,3,4, addingReplicas=, removingReplicas=), novotopico3-3 -> ReplicaAssignment(replicas=0,4,5, addingReplicas=, removingReplicas=), novotopico3-0 -> ReplicaAssignment(replicas=5,0,3, addingReplicas=, removingReplicas=), novotopico3-2 -> ReplicaAssignment(replicas=4,3,0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:29:54,276] INFO [Controller id=0] New partition creation callback for novotopico3-5,novotopico3-1,novotopico3-4,novotopico3-3,novotopico3-0,novotopico3-2 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,455] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:30:16,455] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:30:16,456] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(Sensor-4 -> List(0, 5, 3), Sensor-0 -> List(0, 4, 5), novotopico-4 -> List(0, 3, 4), novotopico-0 -> List(0, 5, 3)) (kafka.controller.KafkaController)
[2022-05-03 18:30:16,456] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.6666666666666666 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,457] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions Sensor-4,Sensor-0,novotopico-4,novotopico-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] INFO [Controller id=0] Partition Sensor-4 completed preferred replica leader election. New leader is 0 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] INFO [Controller id=0] Partition Sensor-0 completed preferred replica leader election. New leader is 0 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] INFO [Controller id=0] Partition novotopico-4 completed preferred replica leader election. New leader is 0 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] INFO [Controller id=0] Partition novotopico-0 completed preferred replica leader election. New leader is 0 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] DEBUG [Controller id=0] Topics not in preferred replica for broker 5 HashMap() (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] TRACE [Controller id=0] Leader imbalance ratio for broker 5 is 0.0 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] DEBUG [Controller id=0] Topics not in preferred replica for broker 3 HashMap(novotopico-2 -> List(3, 4, 0), Sensor-2 -> List(3, 5, 4)) (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] TRACE [Controller id=0] Leader imbalance ratio for broker 3 is 0.3333333333333333 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,468] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions novotopico-2,Sensor-2 triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:30:16,477] INFO [Controller id=0] Partition novotopico-2 completed preferred replica leader election. New leader is 3 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,477] INFO [Controller id=0] Partition Sensor-2 completed preferred replica leader election. New leader is 3 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,477] DEBUG [Controller id=0] Topics not in preferred replica for broker 4 HashMap(novotopico-3 -> List(4, 0, 5)) (kafka.controller.KafkaController)
[2022-05-03 18:30:16,477] TRACE [Controller id=0] Leader imbalance ratio for broker 4 is 0.2 (kafka.controller.KafkaController)
[2022-05-03 18:30:16,477] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions novotopico-3 triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-05-03 18:30:16,484] INFO [Controller id=0] Partition novotopico-3 completed preferred replica leader election. New leader is 4 (kafka.controller.KafkaController)
[2022-05-03 18:31:30,211] DEBUG [Controller id=0] Delete topics listener fired for topics novotopico3 to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:31:30,211] INFO [Controller id=0] Starting topic deletion for topics novotopico3 (kafka.controller.KafkaController)
[2022-05-03 18:31:30,214] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,216] INFO [Topic Deletion Manager 0] Deletion of topic novotopico3 (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,303] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(novotopico3-4 -> NONE, novotopico3-3 -> NONE, novotopico3-0 -> NONE, novotopico3-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:31:30,305] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=4,Replica=5],[Topic=novotopico3,Partition=3,Replica=5],[Topic=novotopico3,Partition=0,Replica=5],[Topic=novotopico3,Partition=1,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,305] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,306] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(novotopico3-3 -> NONE, novotopico3-5 -> NONE, novotopico3-0 -> NONE, novotopico3-2 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:31:30,306] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=3,Replica=0],[Topic=novotopico3,Partition=5,Replica=0],[Topic=novotopico3,Partition=0,Replica=0],[Topic=novotopico3,Partition=2,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,306] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,307] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(novotopico3-4 -> NONE, novotopico3-3 -> NONE, novotopico3-5 -> NONE, novotopico3-2 -> NONE, novotopico3-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:31:30,308] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=5,Replica=4],[Topic=novotopico3,Partition=1,Replica=4],[Topic=novotopico3,Partition=2,Replica=4],[Topic=novotopico3,Partition=4,Replica=4],[Topic=novotopico3,Partition=3,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,308] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,309] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(novotopico3-4 -> NONE, novotopico3-5 -> NONE, novotopico3-0 -> NONE, novotopico3-2 -> NONE, novotopico3-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:31:30,309] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=1,Replica=3],[Topic=novotopico3,Partition=4,Replica=3],[Topic=novotopico3,Partition=0,Replica=3],[Topic=novotopico3,Partition=2,Replica=3],[Topic=novotopico3,Partition=5,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,309] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,357] INFO [Topic Deletion Manager 0] Deletion of topic novotopico3 successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:31:30,358] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:31:30,359] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:32:06,033] DEBUG [Controller id=0] Delete topics listener fired for topics novotopico2 to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:32:06,033] INFO [Controller id=0] Starting topic deletion for topics novotopico2 (kafka.controller.KafkaController)
[2022-05-03 18:32:06,033] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico2 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,034] INFO [Topic Deletion Manager 0] Deletion of topic novotopico2 (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,077] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(novotopico2-2 -> NONE, novotopico2-4 -> NONE, novotopico2-1 -> NONE, novotopico2-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:06,078] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico2,Partition=2,Replica=0],[Topic=novotopico2,Partition=4,Replica=0],[Topic=novotopico2,Partition=1,Replica=0],[Topic=novotopico2,Partition=0,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,078] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico2 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,080] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(novotopico2-3 -> NONE, novotopico2-2 -> NONE, novotopico2-5 -> NONE, novotopico2-4 -> NONE, novotopico2-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:06,080] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico2,Partition=4,Replica=3],[Topic=novotopico2,Partition=0,Replica=3],[Topic=novotopico2,Partition=5,Replica=3],[Topic=novotopico2,Partition=2,Replica=3],[Topic=novotopico2,Partition=3,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,081] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico2 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,081] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(novotopico2-3 -> NONE, novotopico2-5 -> NONE, novotopico2-1 -> NONE, novotopico2-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:06,082] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico2,Partition=3,Replica=4],[Topic=novotopico2,Partition=5,Replica=4],[Topic=novotopico2,Partition=1,Replica=4],[Topic=novotopico2,Partition=0,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,082] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico2 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,085] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(novotopico2-3 -> NONE, novotopico2-2 -> NONE, novotopico2-5 -> NONE, novotopico2-4 -> NONE, novotopico2-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:06,085] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico2,Partition=5,Replica=5],[Topic=novotopico2,Partition=2,Replica=5],[Topic=novotopico2,Partition=4,Replica=5],[Topic=novotopico2,Partition=3,Replica=5],[Topic=novotopico2,Partition=1,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,086] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico2 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,119] INFO [Topic Deletion Manager 0] Deletion of topic novotopico2 successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:06,120] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:32:06,120] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:32:27,088] DEBUG [Controller id=0] Delete topics listener fired for topics novotopico to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:32:27,088] INFO [Controller id=0] Starting topic deletion for topics novotopico (kafka.controller.KafkaController)
[2022-05-03 18:32:27,088] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,088] INFO [Topic Deletion Manager 0] Deletion of topic novotopico (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,133] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(novotopico-0 -> NONE, novotopico-1 -> NONE, novotopico-2 -> NONE, novotopico-4 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:27,134] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico,Partition=0,Replica=3],[Topic=novotopico,Partition=1,Replica=3],[Topic=novotopico,Partition=2,Replica=3],[Topic=novotopico,Partition=4,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,134] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,138] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(novotopico-1 -> NONE, novotopico-2 -> NONE, novotopico-3 -> NONE, novotopico-4 -> NONE, novotopico-5 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:27,138] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico,Partition=5,Replica=4],[Topic=novotopico,Partition=1,Replica=4],[Topic=novotopico,Partition=3,Replica=4],[Topic=novotopico,Partition=2,Replica=4],[Topic=novotopico,Partition=4,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,139] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,142] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(novotopico-0 -> NONE, novotopico-2 -> NONE, novotopico-3 -> NONE, novotopico-4 -> NONE, novotopico-5 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:27,142] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico,Partition=4,Replica=0],[Topic=novotopico,Partition=5,Replica=0],[Topic=novotopico,Partition=3,Replica=0],[Topic=novotopico,Partition=0,Replica=0],[Topic=novotopico,Partition=2,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,142] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,143] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(novotopico-0 -> NONE, novotopico-1 -> NONE, novotopico-3 -> NONE, novotopico-5 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:27,143] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico,Partition=0,Replica=5],[Topic=novotopico,Partition=1,Replica=5],[Topic=novotopico,Partition=3,Replica=5],[Topic=novotopico,Partition=5,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,143] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,182] INFO [Topic Deletion Manager 0] Deletion of topic novotopico successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:27,183] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:32:27,184] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:32:44,232] DEBUG [Controller id=0] Delete topics listener fired for topics Sensor to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:32:44,232] INFO [Controller id=0] Starting topic deletion for topics Sensor (kafka.controller.KafkaController)
[2022-05-03 18:32:44,232] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,233] INFO [Topic Deletion Manager 0] Deletion of topic Sensor (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,279] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:44,280] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=4,Replica=0],[Topic=Sensor,Partition=3,Replica=0],[Topic=Sensor,Partition=0,Replica=0],[Topic=Sensor,Partition=1,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,280] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,290] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:44,290] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=5],[Topic=Sensor,Partition=2,Replica=5],[Topic=Sensor,Partition=0,Replica=5],[Topic=Sensor,Partition=4,Replica=5],[Topic=Sensor,Partition=1,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,290] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,292] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:44,292] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=4],[Topic=Sensor,Partition=2,Replica=4],[Topic=Sensor,Partition=3,Replica=4],[Topic=Sensor,Partition=0,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,292] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,293] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:32:44,293] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=3],[Topic=Sensor,Partition=4,Replica=3],[Topic=Sensor,Partition=2,Replica=3],[Topic=Sensor,Partition=1,Replica=3],[Topic=Sensor,Partition=3,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,293] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,326] INFO [Topic Deletion Manager 0] Deletion of topic Sensor successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:32:44,326] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:32:44,328] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:33:11,300] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,300] DEBUG [Controller id=0] All shutting down brokers: 4 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,301] DEBUG [Controller id=0] Live brokers: 0,3,5 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,302] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:33:11,303] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,303] DEBUG [Controller id=0] All shutting down brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,303] DEBUG [Controller id=0] Live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] DEBUG [Controller id=0] All shutting down brokers: 0,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] DEBUG [Controller id=0] Live brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:33:11,304] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,007] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,009] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,009] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,010] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:33:12,010] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:33:12,011] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,012] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,013] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:33:12,023] INFO [Controller id=0] Newly added brokers: , deleted brokers: 5, bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:33:12,023] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,023] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,023] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,026] INFO [Controller id=0] Broker failure callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:33:12,027] INFO [Controller id=0] Removed 5 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:33:12,028] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,029] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3346, 3 -> 3406, 4 -> 3422) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,032] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,032] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,032] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,134] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,135] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,135] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,236] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,236] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,237] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,338] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,338] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,339] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,440] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,440] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,441] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,526] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,526] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,526] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,526] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:33:12,527] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,528] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,528] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,529] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,530] WARN [RequestSendThread controllerId=0] Controller 0 epoch 23 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=23, brokerEpoch=3346, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,530] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,530] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,530] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,532] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,532] WARN [RequestSendThread controllerId=0] Controller 0 epoch 23 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=23, brokerEpoch=3406, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,532] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,532] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,532] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,533] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,534] WARN [RequestSendThread controllerId=0] Controller 0 epoch 23 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=23, brokerEpoch=3422, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9096 (id: 4 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,534] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,534] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,534] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,535] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:33:12,551] INFO [Controller id=4] 4 successfully elected as the controller. Epoch incremented to 24 and epoch zk version is now 24 (kafka.controller.KafkaController)
[2022-05-03 18:33:12,553] INFO [Controller id=4] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:33:12,556] INFO [Controller id=4] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:33:12,556] DEBUG [Controller id=3] Broker 4 was elected as controller instead of broker 3 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:33:12,558] INFO [Controller id=4] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:33:12,560] INFO [Controller id=4] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:33:12,566] INFO [Controller id=4] Initialized broker epochs cache: HashMap(3 -> 3406, 4 -> 3422) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,570] DEBUG [Controller id=4] Register BrokerModifications handler for Set(3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,575] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,577] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:33:12,580] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:33:12,582] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,582] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,583] INFO [Controller id=4] Currently active brokers in the cluster: Set(3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,584] INFO [Controller id=4] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:33:12,584] INFO [Controller id=4] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:33:12,584] INFO [Controller id=4] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:33:12,586] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,586] INFO [Controller id=4] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,586] INFO [Controller id=4] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:33:12,586] INFO [Topic Deletion Manager 4] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:33:12,587] INFO [Controller id=4] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:33:12,594] INFO [ReplicaStateMachine controllerId=4] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,594] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,594] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,594] INFO [ReplicaStateMachine controllerId=4] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,596] INFO [ReplicaStateMachine controllerId=4] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,597] DEBUG [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,597] INFO [PartitionStateMachine controllerId=4] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,597] INFO [PartitionStateMachine controllerId=4] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,599] DEBUG [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,599] INFO [Controller id=4] Ready to serve as the new controller with epoch 24 (kafka.controller.KafkaController)
[2022-05-03 18:33:12,603] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,604] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,604] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,604] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,605] INFO [Controller id=4] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:33:12,612] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:33:12,613] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,613] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,614] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:33:12,615] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set(3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,617] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,618] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,619] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,620] WARN [RequestSendThread controllerId=4] Controller 4 epoch 24 fails to send request (type: UpdateMetadataRequest=, controllerId=4, controllerEpoch=24, brokerEpoch=3406, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,620] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,621] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,621] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,622] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,622] WARN [RequestSendThread controllerId=4] Controller 4 epoch 24 fails to send request (type: UpdateMetadataRequest=, controllerId=4, controllerEpoch=24, brokerEpoch=3422, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9096 (id: 4 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,623] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,623] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,623] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,624] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:33:12,635] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 25 and epoch zk version is now 25 (kafka.controller.KafkaController)
[2022-05-03 18:33:12,637] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:33:12,639] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:33:12,642] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:33:12,644] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:33:12,650] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 3406) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,655] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,659] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:33:12,665] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,668] INFO [Controller id=3] Currently active brokers in the cluster: Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,668] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:33:12,668] INFO [Controller id=3] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:33:12,668] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:33:12,671] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,672] INFO [Controller id=3] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,672] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:33:12,672] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:33:12,672] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:33:12,681] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,682] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,685] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,686] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,687] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,687] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,689] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,692] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,693] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,693] INFO [Controller id=3] Ready to serve as the new controller with epoch 25 (kafka.controller.KafkaController)
[2022-05-03 18:33:12,699] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,699] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,700] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,700] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:33:12,701] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:33:12,709] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:33:12,712] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,712] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:33:12,713] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:33:12,714] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:33:12,715] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:33:12,716] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:33:12,717] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,718] WARN [RequestSendThread controllerId=3] Controller 3 epoch 25 fails to send request (type: UpdateMetadataRequest=, controllerId=3, controllerEpoch=25, brokerEpoch=3406, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:33:12,719] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,719] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,719] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:33:12,721] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:34:03,990] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:34:10,385] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:34:10,409] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 26 and epoch zk version is now 26 (kafka.controller.KafkaController)
[2022-05-03 18:34:10,412] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:34:10,417] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:34:10,420] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:34:10,423] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:34:10,436] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 3776) (kafka.controller.KafkaController)
[2022-05-03 18:34:10,443] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:34:10,452] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:34:10,468] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:34:10,471] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:34:10,472] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:34:10,472] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:34:10,472] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:34:10,474] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:34:10,475] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:34:10,475] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:34:10,476] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:34:10,476] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:34:10,488] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:34:10,489] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:34:10,493] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:34:10,493] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:34:10,494] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:34:10,494] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:34:10,497] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:34:10,497] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:34:10,498] INFO [Controller id=0] Ready to serve as the new controller with epoch 26 (kafka.controller.KafkaController)
[2022-05-03 18:34:10,505] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:34:10,506] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:34:10,507] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:34:10,508] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:34:10,509] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:34:10,518] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:34:15,520] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:34:15,520] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:34:25,809] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:34:25,809] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:34:25,813] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:34:25,814] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:34:25,818] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:34:25,820] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:34:25,822] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3776, 3 -> 3824) (kafka.controller.KafkaController)
[2022-05-03 18:34:25,860] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:34:25,874] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:34:30,443] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:34:30,443] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:34:30,445] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:34:30,445] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:34:30,447] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:34:30,448] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:34:30,449] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3776, 3 -> 3824, 4 -> 3840) (kafka.controller.KafkaController)
[2022-05-03 18:34:30,494] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:34:30,512] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:34:35,608] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:34:35,608] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:34:35,612] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:34:35,612] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:34:35,613] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:34:35,614] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:34:35,616] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3776, 3 -> 3824, 4 -> 3840, 5 -> 3857) (kafka.controller.KafkaController)
[2022-05-03 18:34:35,657] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:34:35,674] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:34:39,791] INFO [Controller id=0] New topics: [Set(novotopico3)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(novotopico3,Some(dncoTCmmSvKPOc1uKvzryQ),HashMap(novotopico3-5 -> ReplicaAssignment(replicas=5,4,0, addingReplicas=, removingReplicas=), novotopico3-1 -> ReplicaAssignment(replicas=5,3,4, addingReplicas=, removingReplicas=), novotopico3-4 -> ReplicaAssignment(replicas=0,3,4, addingReplicas=, removingReplicas=), novotopico3-3 -> ReplicaAssignment(replicas=4,0,5, addingReplicas=, removingReplicas=), novotopico3-0 -> ReplicaAssignment(replicas=0,5,3, addingReplicas=, removingReplicas=), novotopico3-2 -> ReplicaAssignment(replicas=3,4,0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:34:39,792] INFO [Controller id=0] New partition creation callback for novotopico3-5,novotopico3-1,novotopico3-4,novotopico3-3,novotopico3-0,novotopico3-2 (kafka.controller.KafkaController)
[2022-05-03 18:35:15,622] DEBUG [Controller id=0] Delete topics listener fired for topics novotopico3 to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:35:15,623] INFO [Controller id=0] Starting topic deletion for topics novotopico3 (kafka.controller.KafkaController)
[2022-05-03 18:35:15,624] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,626] INFO [Topic Deletion Manager 0] Deletion of topic novotopico3 (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,757] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(novotopico3-4 -> NONE, novotopico3-0 -> NONE, novotopico3-2 -> NONE, novotopico3-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:35:15,759] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=4,Replica=3],[Topic=novotopico3,Partition=0,Replica=3],[Topic=novotopico3,Partition=2,Replica=3],[Topic=novotopico3,Partition=1,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,760] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,761] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(novotopico3-3 -> NONE, novotopico3-5 -> NONE, novotopico3-0 -> NONE, novotopico3-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:35:15,761] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=3,Replica=5],[Topic=novotopico3,Partition=5,Replica=5],[Topic=novotopico3,Partition=0,Replica=5],[Topic=novotopico3,Partition=1,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,761] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,770] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(novotopico3-4 -> NONE, novotopico3-3 -> NONE, novotopico3-5 -> NONE, novotopico3-2 -> NONE, novotopico3-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:35:15,771] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=5,Replica=4],[Topic=novotopico3,Partition=1,Replica=4],[Topic=novotopico3,Partition=2,Replica=4],[Topic=novotopico3,Partition=4,Replica=4],[Topic=novotopico3,Partition=3,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,771] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,772] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(novotopico3-4 -> NONE, novotopico3-3 -> NONE, novotopico3-5 -> NONE, novotopico3-0 -> NONE, novotopico3-2 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:35:15,772] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=novotopico3,Partition=5,Replica=0],[Topic=novotopico3,Partition=2,Replica=0],[Topic=novotopico3,Partition=0,Replica=0],[Topic=novotopico3,Partition=3,Replica=0],[Topic=novotopico3,Partition=4,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,773] INFO [Topic Deletion Manager 0] Handling deletion for topics novotopico3 (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,826] INFO [Topic Deletion Manager 0] Deletion of topic novotopico3 successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:15,828] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:35:15,830] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:35:16,015] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,015] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,016] DEBUG [Controller id=0] Live brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,018] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:35:16,019] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,019] DEBUG [Controller id=0] All shutting down brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,019] DEBUG [Controller id=0] Live brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,020] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:35:16,020] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,020] DEBUG [Controller id=0] All shutting down brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,020] DEBUG [Controller id=0] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,020] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:35:16,021] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,021] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,021] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:35:16,021] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:35:16,826] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:16,827] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:16,827] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:16,828] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:35:16,828] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:35:16,828] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:16,829] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:16,830] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:35:16,838] INFO [Controller id=0] Newly added brokers: , deleted brokers: 4, bounced brokers: , all live brokers: 0,3,5 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,839] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,839] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,839] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,842] INFO [Controller id=0] Broker failure callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,842] INFO [Controller id=0] Removed 4 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:35:16,844] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:35:16,845] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3776, 3 -> 3824, 5 -> 3857) (kafka.controller.KafkaController)
[2022-05-03 18:35:16,847] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,847] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,848] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,949] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,949] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,949] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,959] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:16,959] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:16,959] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:16,960] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:35:16,960] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 5) (kafka.controller.KafkaController)
[2022-05-03 18:35:16,961] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:16,961] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:16,961] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,962] WARN [RequestSendThread controllerId=0] Controller 0 epoch 26 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=26, brokerEpoch=3776, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,963] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,963] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,963] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,965] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,965] WARN [RequestSendThread controllerId=0] Controller 0 epoch 26 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=26, brokerEpoch=3824, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,966] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,966] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,966] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,967] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,967] WARN [RequestSendThread controllerId=0] Controller 0 epoch 26 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=26, brokerEpoch=3857, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9097 (id: 5 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:16,968] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,968] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,968] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:35:16,970] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:35:16,988] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 27 and epoch zk version is now 27 (kafka.controller.KafkaController)
[2022-05-03 18:35:16,990] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:35:16,992] DEBUG [Controller id=5] Broker 3 was elected as controller instead of broker 5 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:35:16,993] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:35:16,995] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:35:16,997] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:35:17,000] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:17,001] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:17,001] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:17,002] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:35:17,002] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:35:17,003] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:17,004] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:17,004] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 3824, 5 -> 3857) (kafka.controller.KafkaController)
[2022-05-03 18:35:17,005] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:35:17,009] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3, 5) (kafka.controller.KafkaController)
[2022-05-03 18:35:17,015] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:35:17,018] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:35:17,021] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,021] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,024] INFO [Controller id=3] Currently active brokers in the cluster: Set(3, 5) (kafka.controller.KafkaController)
[2022-05-03 18:35:17,024] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:35:17,024] INFO [Controller id=3] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:35:17,024] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:35:17,027] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:35:17,027] INFO [Controller id=3] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:35:17,027] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:35:17,027] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:17,028] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:35:17,035] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:17,035] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:17,037] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:17,037] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:17,038] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:17,038] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:17,038] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:17,039] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:17,041] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:17,041] INFO [Controller id=3] Ready to serve as the new controller with epoch 27 (kafka.controller.KafkaController)
[2022-05-03 18:35:17,046] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:35:17,046] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:35:17,046] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:35:17,046] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:35:17,048] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:35:17,056] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:35:17,066] INFO [Controller id=3] Newly added brokers: , deleted brokers: 5, bounced brokers: , all live brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:35:17,067] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,068] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,068] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,068] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,070] INFO [Controller id=3] Broker failure callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:35:17,073] DEBUG [Controller id=3] Unregister BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:35:17,073] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 3824) (kafka.controller.KafkaController)
[2022-05-03 18:35:17,139] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:17,191] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:17,191] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:17,191] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:17,192] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:35:17,193] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:35:17,194] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:17,194] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:17,195] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,196] WARN [RequestSendThread controllerId=3] Controller 3 epoch 27 fails to send request (type: UpdateMetadataRequest=, controllerId=3, controllerEpoch=27, brokerEpoch=3824, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=5, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9097, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:35:17,196] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,196] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,196] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:35:17,198] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:35:39,741] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:35:46,042] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:35:46,068] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 28 and epoch zk version is now 28 (kafka.controller.KafkaController)
[2022-05-03 18:35:46,070] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:35:46,074] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:35:46,077] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:35:46,080] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:35:46,093] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 3932) (kafka.controller.KafkaController)
[2022-05-03 18:35:46,100] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:35:46,113] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:35:46,132] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:35:46,135] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:35:46,136] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:35:46,136] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:35:46,137] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:35:46,140] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:35:46,140] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:35:46,140] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:35:46,141] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:35:46,142] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:35:46,158] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:46,160] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:46,165] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:46,165] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:35:46,166] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:46,167] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:46,168] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:35:46,170] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:35:46,171] INFO [Controller id=0] Ready to serve as the new controller with epoch 28 (kafka.controller.KafkaController)
[2022-05-03 18:35:46,179] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:35:46,180] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:35:46,180] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:35:46,181] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:35:46,182] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:35:46,194] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:35:51,197] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:35:51,197] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:36:01,012] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:36:01,012] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:36:01,014] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:36:01,016] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:36:01,019] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:36:01,021] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:36:01,023] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3932, 3 -> 3980) (kafka.controller.KafkaController)
[2022-05-03 18:36:01,054] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:36:01,070] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:36:06,096] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:36:06,096] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:36:06,099] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:36:06,099] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:36:06,100] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:36:06,101] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:36:06,102] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3932, 3 -> 3980, 4 -> 3996) (kafka.controller.KafkaController)
[2022-05-03 18:36:06,143] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:36:06,155] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:36:11,110] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:36:11,110] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:36:11,113] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:36:11,113] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:36:11,116] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:36:11,116] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:36:11,117] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 3932, 3 -> 3980, 4 -> 3996, 5 -> 4013) (kafka.controller.KafkaController)
[2022-05-03 18:36:11,159] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:36:11,176] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:37:13,216] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:37:48,961] INFO [Controller id=0] New topics: [Set(Sensor)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(Sensor,Some(ewVXnCjeQh6lrJNfs0plFw),HashMap(Sensor-0 -> ReplicaAssignment(replicas=0,4,5, addingReplicas=, removingReplicas=), Sensor-5 -> ReplicaAssignment(replicas=5,3,4, addingReplicas=, removingReplicas=), Sensor-2 -> ReplicaAssignment(replicas=3,5,4, addingReplicas=, removingReplicas=), Sensor-3 -> ReplicaAssignment(replicas=4,3,0, addingReplicas=, removingReplicas=), Sensor-1 -> ReplicaAssignment(replicas=5,0,3, addingReplicas=, removingReplicas=), Sensor-4 -> ReplicaAssignment(replicas=0,5,3, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:37:48,961] INFO [Controller id=0] New partition creation callback for Sensor-0,Sensor-5,Sensor-2,Sensor-3,Sensor-1,Sensor-4 (kafka.controller.KafkaController)
[2022-05-03 18:38:24,653] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:39:06,692] DEBUG [Controller id=0] Delete topics listener fired for topics Sensor to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:39:06,692] INFO [Controller id=0] Starting topic deletion for topics Sensor (kafka.controller.KafkaController)
[2022-05-03 18:39:06,694] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,696] INFO [Topic Deletion Manager 0] Deletion of topic Sensor (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,815] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:39:06,818] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=4,Replica=0],[Topic=Sensor,Partition=3,Replica=0],[Topic=Sensor,Partition=0,Replica=0],[Topic=Sensor,Partition=1,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,819] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,822] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:39:06,822] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=5],[Topic=Sensor,Partition=2,Replica=5],[Topic=Sensor,Partition=0,Replica=5],[Topic=Sensor,Partition=4,Replica=5],[Topic=Sensor,Partition=1,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,823] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,824] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:39:06,824] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=4],[Topic=Sensor,Partition=2,Replica=4],[Topic=Sensor,Partition=3,Replica=4],[Topic=Sensor,Partition=0,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,825] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,827] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:39:06,827] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=3],[Topic=Sensor,Partition=4,Replica=3],[Topic=Sensor,Partition=2,Replica=3],[Topic=Sensor,Partition=1,Replica=3],[Topic=Sensor,Partition=3,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,828] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,872] INFO [Topic Deletion Manager 0] Deletion of topic Sensor successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:06,873] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:39:06,875] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:39:07,084] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,084] DEBUG [Controller id=0] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,084] DEBUG [Controller id=0] Live brokers: 0,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,086] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:39:07,087] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] DEBUG [Controller id=0] All shutting down brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] DEBUG [Controller id=0] Live brokers: 0,5 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] DEBUG [Controller id=0] All shutting down brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] DEBUG [Controller id=0] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:39:07,088] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:39:07,089] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:39:07,981] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:07,981] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:07,981] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:07,982] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:39:07,983] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:39:07,984] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:07,984] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:07,984] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,985] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,985] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,986] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,987] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,987] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,988] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,988] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,988] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,989] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,989] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,990] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:07,991] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:39:08,007] INFO [Controller id=4] 4 successfully elected as the controller. Epoch incremented to 29 and epoch zk version is now 29 (kafka.controller.KafkaController)
[2022-05-03 18:39:08,009] INFO [Controller id=4] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:39:08,012] DEBUG [Controller id=3] Broker 4 was elected as controller instead of broker 3 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:39:08,012] DEBUG [Controller id=5] Broker 4 was elected as controller instead of broker 5 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:39:08,013] INFO [Controller id=4] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:39:08,015] INFO [Controller id=4] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:39:08,017] INFO [Controller id=4] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:39:08,024] INFO [Controller id=4] Initialized broker epochs cache: HashMap(3 -> 3980, 4 -> 3996, 5 -> 4013) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,032] DEBUG [Controller id=4] Register BrokerModifications handler for Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,040] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:08,045] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,045] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:08,045] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,045] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,046] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:39:08,047] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:39:08,046] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,047] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:08,047] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,048] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,049] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:39:08,049] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,049] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,050] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,052] INFO [Controller id=4] Currently active brokers in the cluster: Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,058] INFO [Controller id=4] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:39:08,058] INFO [Controller id=4] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:39:08,059] INFO [Controller id=4] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:39:08,061] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,061] INFO [Controller id=4] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,061] INFO [Controller id=4] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:39:08,061] INFO [Topic Deletion Manager 4] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:08,061] INFO [Controller id=4] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:39:08,068] INFO [ReplicaStateMachine controllerId=4] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,068] INFO [ReplicaStateMachine controllerId=4] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,070] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:39:08,070] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9097 (id: 5 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9097 (id: 5 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:39:08,070] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:39:08,071] INFO [ReplicaStateMachine controllerId=4] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,071] DEBUG [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,072] INFO [PartitionStateMachine controllerId=4] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,072] INFO [PartitionStateMachine controllerId=4] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,074] DEBUG [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,074] INFO [Controller id=4] Ready to serve as the new controller with epoch 29 (kafka.controller.KafkaController)
[2022-05-03 18:39:08,078] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,078] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,078] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,079] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,080] INFO [Controller id=4] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:39:08,088] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:39:08,090] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,090] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,091] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:39:08,092] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set(3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,094] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,095] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,096] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,097] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,097] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,097] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,099] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,099] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,099] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,099] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,101] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,101] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,101] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,101] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,103] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:39:08,114] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 30 and epoch zk version is now 30 (kafka.controller.KafkaController)
[2022-05-03 18:39:08,117] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:39:08,120] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:39:08,122] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:39:08,124] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:39:08,128] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 3980) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,132] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,136] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:08,140] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,142] INFO [Controller id=3] Currently active brokers in the cluster: Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,142] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:39:08,142] INFO [Controller id=3] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:39:08,143] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:39:08,145] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,145] INFO [Controller id=3] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,145] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:39:08,145] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:08,146] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:39:08,159] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,159] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,160] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:39:08,161] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,161] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,161] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,162] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,164] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,164] INFO [Controller id=3] Ready to serve as the new controller with epoch 30 (kafka.controller.KafkaController)
[2022-05-03 18:39:08,168] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,168] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,168] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,168] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:39:08,169] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:39:08,176] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:39:08,262] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:39:08,352] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,353] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,353] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:08,353] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:39:08,354] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:39:08,355] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:08,356] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:08,356] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,357] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,357] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,357] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:39:08,359] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:39:16,346] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:39:22,631] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:22,654] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 31 and epoch zk version is now 31 (kafka.controller.KafkaController)
[2022-05-03 18:39:22,656] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:39:22,661] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:39:22,663] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:39:22,666] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:39:22,677] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 4283) (kafka.controller.KafkaController)
[2022-05-03 18:39:22,690] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:39:22,694] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:22,710] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:22,713] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:39:22,713] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:39:22,713] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:39:22,713] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:39:22,717] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:39:22,717] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:39:22,717] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:39:22,717] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:39:22,718] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:39:22,729] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:22,730] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:22,733] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:22,733] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:39:22,734] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:22,734] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:22,734] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:39:22,737] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:39:22,737] INFO [Controller id=0] Ready to serve as the new controller with epoch 31 (kafka.controller.KafkaController)
[2022-05-03 18:39:22,746] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:39:22,747] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:39:22,748] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:39:22,748] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:39:22,749] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:39:22,762] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:39:27,763] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:39:27,764] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:39:37,666] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:39:37,666] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:37,669] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:37,671] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:39:37,675] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:39:37,677] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:39:37,680] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4283, 3 -> 4331) (kafka.controller.KafkaController)
[2022-05-03 18:39:37,711] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:37,726] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:39:42,666] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:39:42,667] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:42,670] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:42,670] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:39:42,672] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:39:42,673] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:39:42,674] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4283, 3 -> 4331, 4 -> 4347) (kafka.controller.KafkaController)
[2022-05-03 18:39:42,709] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:42,722] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:39:47,685] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:39:47,685] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:39:47,688] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:39:47,688] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:39:47,689] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:39:47,690] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:39:47,692] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4283, 3 -> 4331, 4 -> 4347, 5 -> 4364) (kafka.controller.KafkaController)
[2022-05-03 18:39:47,733] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:39:47,748] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:39:52,011] INFO [Controller id=0] New topics: [Set(Sensor)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(Sensor,Some(gKuKmEnRROKCh4lVOXsGOQ),HashMap(Sensor-0 -> ReplicaAssignment(replicas=0,4,5, addingReplicas=, removingReplicas=), Sensor-5 -> ReplicaAssignment(replicas=5,3,4, addingReplicas=, removingReplicas=), Sensor-2 -> ReplicaAssignment(replicas=3,5,4, addingReplicas=, removingReplicas=), Sensor-3 -> ReplicaAssignment(replicas=4,3,0, addingReplicas=, removingReplicas=), Sensor-1 -> ReplicaAssignment(replicas=5,0,3, addingReplicas=, removingReplicas=), Sensor-4 -> ReplicaAssignment(replicas=0,5,3, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:39:52,012] INFO [Controller id=0] New partition creation callback for Sensor-0,Sensor-5,Sensor-2,Sensor-3,Sensor-1,Sensor-4 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,284] DEBUG [Controller id=0] Delete topics listener fired for topics Sensor to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:40:24,284] INFO [Controller id=0] Starting topic deletion for topics Sensor (kafka.controller.KafkaController)
[2022-05-03 18:40:24,285] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,287] INFO [Topic Deletion Manager 0] Deletion of topic Sensor (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,425] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:40:24,428] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=4],[Topic=Sensor,Partition=2,Replica=4],[Topic=Sensor,Partition=3,Replica=4],[Topic=Sensor,Partition=0,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,430] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,434] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:40:24,435] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=3],[Topic=Sensor,Partition=4,Replica=3],[Topic=Sensor,Partition=2,Replica=3],[Topic=Sensor,Partition=1,Replica=3],[Topic=Sensor,Partition=3,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,436] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,438] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:40:24,438] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=4,Replica=0],[Topic=Sensor,Partition=3,Replica=0],[Topic=Sensor,Partition=0,Replica=0],[Topic=Sensor,Partition=1,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,439] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,440] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:40:24,440] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=5],[Topic=Sensor,Partition=2,Replica=5],[Topic=Sensor,Partition=0,Replica=5],[Topic=Sensor,Partition=4,Replica=5],[Topic=Sensor,Partition=1,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,441] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,490] INFO [Topic Deletion Manager 0] Deletion of topic Sensor successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:24,492] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:40:24,493] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:40:24,686] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,686] DEBUG [Controller id=0] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,686] DEBUG [Controller id=0] Live brokers: 0,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,688] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:40:24,690] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,690] DEBUG [Controller id=0] All shutting down brokers: 3,5 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,690] DEBUG [Controller id=0] Live brokers: 0,4 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,690] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:40:24,691] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,691] DEBUG [Controller id=0] All shutting down brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,691] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,691] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:40:24,692] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,692] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:40:24,692] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:40:24,693] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:40:25,671] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,672] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,672] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,674] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:40:25,674] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:40:25,674] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:40:25,675] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,677] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:40:25,685] INFO [Controller id=0] Newly added brokers: , deleted brokers: 5, bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:40:25,685] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,686] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,686] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,689] INFO [Controller id=0] Broker failure callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:40:25,689] INFO [Controller id=0] Removed 5 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:40:25,691] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:40:25,692] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4283, 3 -> 4331, 4 -> 4347) (kafka.controller.KafkaController)
[2022-05-03 18:40:25,694] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,694] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,694] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,796] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,796] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,796] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,824] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,825] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,825] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,825] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:40:25,826] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:40:25,826] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:40:25,827] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,827] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,828] WARN [RequestSendThread controllerId=0] Controller 0 epoch 31 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=31, brokerEpoch=4283, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9092 (id: 0 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,829] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,829] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,829] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,831] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,831] WARN [RequestSendThread controllerId=0] Controller 0 epoch 31 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=31, brokerEpoch=4331, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,832] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,832] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,832] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,834] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,834] WARN [RequestSendThread controllerId=0] Controller 0 epoch 31 fails to send request (type: UpdateMetadataRequest=, controllerId=0, controllerEpoch=31, brokerEpoch=4347, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=0, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9092, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9096 (id: 4 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,834] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,834] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,834] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,836] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:40:25,852] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,854] INFO [Controller id=4] 4 successfully elected as the controller. Epoch incremented to 32 and epoch zk version is now 32 (kafka.controller.KafkaController)
[2022-05-03 18:40:25,857] INFO [Controller id=4] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:40:25,861] INFO [Controller id=4] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:40:25,862] DEBUG [Controller id=3] Broker 4 was elected as controller instead of broker 3 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2022-05-03 18:40:25,863] INFO [Controller id=4] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:40:25,865] INFO [Controller id=4] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:40:25,871] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,872] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,872] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,872] INFO [Controller id=4] Initialized broker epochs cache: HashMap(3 -> 4331, 4 -> 4347) (kafka.controller.KafkaController)
[2022-05-03 18:40:25,873] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:40:25,873] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:40:25,874] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:40:25,875] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,876] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:40:25,876] DEBUG [Controller id=4] Register BrokerModifications handler for Set(3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:40:25,883] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:40:25,886] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:40:25,889] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,889] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,892] INFO [Controller id=4] Currently active brokers in the cluster: Set(3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:40:25,892] INFO [Controller id=4] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:40:25,892] INFO [Controller id=4] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:40:25,892] INFO [Controller id=4] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:40:25,895] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:40:25,895] INFO [Controller id=4] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:40:25,896] INFO [Controller id=4] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:40:25,896] INFO [Topic Deletion Manager 4] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:40:25,896] INFO [Controller id=4] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:40:25,903] INFO [ReplicaStateMachine controllerId=4] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,904] INFO [ReplicaStateMachine controllerId=4] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,905] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,905] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,906] INFO [ReplicaStateMachine controllerId=4] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,906] DEBUG [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,906] INFO [PartitionStateMachine controllerId=4] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:40:25,907] INFO [PartitionStateMachine controllerId=4] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:40:25,909] DEBUG [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:40:25,909] INFO [Controller id=4] Ready to serve as the new controller with epoch 32 (kafka.controller.KafkaController)
[2022-05-03 18:40:25,914] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:40:25,914] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:40:25,914] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:40:25,914] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:40:25,915] INFO [Controller id=4] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:40:25,923] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:40:25,926] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,926] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:40:25,927] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:40:25,928] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set(3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:40:25,929] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:40:25,930] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:40:25,931] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,932] WARN [RequestSendThread controllerId=4] Controller 4 epoch 32 fails to send request (type: UpdateMetadataRequest=, controllerId=4, controllerEpoch=32, brokerEpoch=4331, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9095 (id: 3 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,932] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,932] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,932] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,934] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,934] WARN [RequestSendThread controllerId=4] Controller 4 epoch 32 fails to send request (type: UpdateMetadataRequest=, controllerId=4, controllerEpoch=32, brokerEpoch=4347, partitionStates=[], liveBrokers=UpdateMetadataBroker(id=3, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9095, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null), UpdateMetadataBroker(id=4, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9096, host='joao', listener='PLAINTEXT', securityProtocol=0)], rack=null)) to broker joao:9096 (id: 4 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:40:25,934] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,934] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,934] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:40:25,936] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:42:24,767] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:42:31,178] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:42:31,202] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 33 and epoch zk version is now 33 (kafka.controller.KafkaController)
[2022-05-03 18:42:31,204] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:42:31,209] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:42:31,212] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:42:31,214] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:42:31,227] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 4439) (kafka.controller.KafkaController)
[2022-05-03 18:42:31,234] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:42:31,240] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:42:31,262] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:42:31,266] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:42:31,267] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:42:31,267] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:42:31,267] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:42:31,270] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:42:31,270] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:42:31,271] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:42:31,271] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:42:31,272] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:42:31,284] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:42:31,285] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:42:31,289] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:42:31,289] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:42:31,290] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:42:31,290] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:42:31,293] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:42:31,294] INFO [Controller id=0] Ready to serve as the new controller with epoch 33 (kafka.controller.KafkaController)
[2022-05-03 18:42:31,296] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:42:31,302] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:42:31,303] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:42:31,303] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:42:31,304] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:42:31,305] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:42:31,316] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:42:36,318] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:42:36,319] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:42:46,192] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:42:46,192] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:42:46,196] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:42:46,198] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:42:46,202] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:42:46,205] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:42:46,207] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4439, 3 -> 4487) (kafka.controller.KafkaController)
[2022-05-03 18:42:46,236] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:42:46,249] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:42:51,239] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:42:51,240] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:42:51,243] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:42:51,243] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:42:51,244] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:42:51,245] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:42:51,246] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4439, 3 -> 4487, 4 -> 4503) (kafka.controller.KafkaController)
[2022-05-03 18:42:51,286] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:42:51,306] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:42:56,232] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:42:56,232] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:42:56,235] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:42:56,235] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:42:56,237] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:42:56,238] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:42:56,239] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4439, 3 -> 4487, 4 -> 4503, 5 -> 4520) (kafka.controller.KafkaController)
[2022-05-03 18:42:56,278] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:42:56,293] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:43:00,464] INFO [Controller id=0] New topics: [Set(Sensor)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(Sensor,Some(2fYIDkopRa-A3Q9kTXEOzA),HashMap(Sensor-0 -> ReplicaAssignment(replicas=5,3,4, addingReplicas=, removingReplicas=), Sensor-5 -> ReplicaAssignment(replicas=3,0,5, addingReplicas=, removingReplicas=), Sensor-2 -> ReplicaAssignment(replicas=4,0,5, addingReplicas=, removingReplicas=), Sensor-3 -> ReplicaAssignment(replicas=0,5,3, addingReplicas=, removingReplicas=), Sensor-1 -> ReplicaAssignment(replicas=3,4,0, addingReplicas=, removingReplicas=), Sensor-4 -> ReplicaAssignment(replicas=5,4,0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:43:00,465] INFO [Controller id=0] New partition creation callback for Sensor-0,Sensor-5,Sensor-2,Sensor-3,Sensor-1,Sensor-4 (kafka.controller.KafkaController)
[2022-05-03 18:45:18,290] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:46:38,201] DEBUG [Controller id=0] Delete topics listener fired for topics Sensor to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:46:38,201] INFO [Controller id=0] Starting topic deletion for topics Sensor (kafka.controller.KafkaController)
[2022-05-03 18:46:38,203] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,205] INFO [Topic Deletion Manager 0] Deletion of topic Sensor (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,344] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(Sensor-5 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:46:38,346] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=3],[Topic=Sensor,Partition=3,Replica=3],[Topic=Sensor,Partition=0,Replica=3],[Topic=Sensor,Partition=1,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,347] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,348] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:46:38,348] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=1,Replica=0],[Topic=Sensor,Partition=4,Replica=0],[Topic=Sensor,Partition=3,Replica=0],[Topic=Sensor,Partition=5,Replica=0],[Topic=Sensor,Partition=2,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,349] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,352] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-2 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:46:38,353] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=4,Replica=4],[Topic=Sensor,Partition=2,Replica=4],[Topic=Sensor,Partition=0,Replica=4],[Topic=Sensor,Partition=1,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,353] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,354] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:46:38,354] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=4,Replica=5],[Topic=Sensor,Partition=5,Replica=5],[Topic=Sensor,Partition=3,Replica=5],[Topic=Sensor,Partition=2,Replica=5],[Topic=Sensor,Partition=0,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,354] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,427] INFO [Topic Deletion Manager 0] Deletion of topic Sensor successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:46:38,429] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:46:38,431] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:46:38,593] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,594] DEBUG [Controller id=0] All shutting down brokers: 4 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,594] DEBUG [Controller id=0] Live brokers: 0,3,5 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,596] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:46:38,598] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,598] DEBUG [Controller id=0] All shutting down brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,598] DEBUG [Controller id=0] Live brokers: 0,5 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,598] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:46:38,598] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,598] DEBUG [Controller id=0] All shutting down brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,599] DEBUG [Controller id=0] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,599] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:46:38,599] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,600] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:46:38,600] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:46:38,600] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:46:39,255] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,256] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,256] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,257] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:46:39,257] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:46:39,258] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:46:39,258] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:46:39,259] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:46:39,342] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,343] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,343] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,344] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:46:39,344] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:46:39,346] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:46:39,346] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:46:39,346] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,346] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,346] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,348] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,348] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,348] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,350] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,350] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,350] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,351] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,351] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,351] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:46:39,352] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:46:39,410] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,411] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,411] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,411] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:46:39,412] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:46:39,412] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:46:39,412] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:46:39,413] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:46:39,805] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,805] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,805] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:46:39,806] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:46:39,807] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:46:39,808] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:46:39,809] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:46:39,810] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:46:46,955] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:47:08,590] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:47:08,619] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 34 and epoch zk version is now 34 (kafka.controller.KafkaController)
[2022-05-03 18:47:08,623] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:47:08,629] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:47:08,632] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:47:08,635] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:47:08,650] INFO [Controller id=3] Initialized broker epochs cache: HashMap(3 -> 4735) (kafka.controller.KafkaController)
[2022-05-03 18:47:08,662] DEBUG [Controller id=3] Register BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:47:08,678] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:47:08,688] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:47:08,691] INFO [Controller id=3] Currently active brokers in the cluster: Set(3) (kafka.controller.KafkaController)
[2022-05-03 18:47:08,692] INFO [Controller id=3] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:47:08,692] INFO [Controller id=3] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:47:08,693] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:47:08,697] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:47:08,698] INFO [Controller id=3] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:47:08,698] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:47:08,699] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:47:08,700] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:47:08,717] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:47:08,718] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:47:08,724] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:47:08,725] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:47:08,725] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:47:08,726] INFO [RequestSendThread controllerId=3] Controller 3 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:47:08,727] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:47:08,732] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:47:08,732] INFO [Controller id=3] Ready to serve as the new controller with epoch 34 (kafka.controller.KafkaController)
[2022-05-03 18:47:08,740] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:47:08,740] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:47:08,740] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:47:08,741] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:47:08,742] INFO [Controller id=3] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:47:08,761] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:47:13,763] INFO [Controller id=3] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:47:13,763] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:47:13,865] INFO [Controller id=3] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:47:13,865] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:47:13,869] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:47:13,871] INFO [Controller id=3] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:47:13,876] INFO [RequestSendThread controllerId=3] Controller 3 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:47:13,879] DEBUG [Controller id=3] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:47:13,881] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 4735, 4 -> 4753) (kafka.controller.KafkaController)
[2022-05-03 18:47:13,924] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:47:13,942] DEBUG [Controller id=4] Broker 3 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:47:18,573] INFO [Controller id=3] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:47:18,573] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:47:18,576] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:47:18,576] INFO [Controller id=3] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:47:18,578] DEBUG [Controller id=3] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:47:18,580] INFO [RequestSendThread controllerId=3] Controller 3 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:47:18,581] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 4735, 4 -> 4753, 5 -> 4769) (kafka.controller.KafkaController)
[2022-05-03 18:47:18,623] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:47:18,640] DEBUG [Controller id=5] Broker 3 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:48:42,655] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,655] DEBUG [Controller id=3] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,656] DEBUG [Controller id=3] Live brokers: 4,5 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,658] TRACE [Controller id=3] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:48:42,661] INFO [Controller id=3] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,661] DEBUG [Controller id=3] All shutting down brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,661] DEBUG [Controller id=3] Live brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,662] TRACE [Controller id=3] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:48:42,662] INFO [Controller id=3] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,662] DEBUG [Controller id=3] All shutting down brokers: 3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:48:42,662] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:48:42,662] TRACE [Controller id=3] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:48:43,824] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:43,826] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:43,826] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:43,826] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:48:43,827] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:48:43,828] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:43,828] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:43,829] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:48:43,840] INFO [Controller id=3] Newly added brokers: , deleted brokers: 5, bounced brokers: , all live brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:48:43,841] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,841] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,841] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,845] INFO [Controller id=3] Broker failure callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:48:43,846] INFO [Controller id=3] Removed 5 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-05-03 18:48:43,847] DEBUG [Controller id=3] Unregister BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:48:43,849] INFO [Controller id=3] Updated broker epochs cache: HashMap(3 -> 4735, 4 -> 4753) (kafka.controller.KafkaController)
[2022-05-03 18:48:43,854] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:48:43,854] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:48:43,959] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9095 (id: 3 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9095 (id: 3 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:48:43,960] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:48:43,994] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:43,994] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:43,994] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:43,995] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:48:43,995] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3, 4) (kafka.controller.KafkaController)
[2022-05-03 18:48:43,996] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:43,996] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:43,997] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,997] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,998] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,998] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,999] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,999] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:48:43,999] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:48:44,000] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:48:44,001] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:48:44,020] INFO [Controller id=4] 4 successfully elected as the controller. Epoch incremented to 35 and epoch zk version is now 35 (kafka.controller.KafkaController)
[2022-05-03 18:48:44,022] INFO [Controller id=4] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:48:44,026] INFO [Controller id=4] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:48:44,028] INFO [Controller id=4] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:48:44,031] INFO [Controller id=4] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:48:44,038] INFO [Controller id=4] Initialized broker epochs cache: HashMap(4 -> 4753) (kafka.controller.KafkaController)
[2022-05-03 18:48:44,042] DEBUG [Controller id=4] Register BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:48:44,045] DEBUG [Channel manager on controller 4]: Controller 4 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:48:44,050] INFO [RequestSendThread controllerId=4] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:48:44,052] INFO [Controller id=4] Currently active brokers in the cluster: Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:48:44,053] INFO [Controller id=4] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:48:44,053] INFO [Controller id=4] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:48:44,053] INFO [Controller id=4] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:48:44,057] INFO [Controller id=4] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:48:44,057] INFO [Controller id=4] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:48:44,057] INFO [Controller id=4] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:48:44,058] INFO [Topic Deletion Manager 4] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:48:44,059] INFO [Controller id=4] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:48:44,070] INFO [ReplicaStateMachine controllerId=4] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:44,071] INFO [ReplicaStateMachine controllerId=4] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:44,073] INFO [ReplicaStateMachine controllerId=4] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:44,073] DEBUG [ReplicaStateMachine controllerId=4] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:44,074] INFO [PartitionStateMachine controllerId=4] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:44,074] INFO [PartitionStateMachine controllerId=4] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:44,074] WARN [RequestSendThread controllerId=4] Controller 4's connection to broker joao:9096 (id: 4 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to joao:9096 (id: 4 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:48:44,077] DEBUG [PartitionStateMachine controllerId=4] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:44,077] INFO [Controller id=4] Ready to serve as the new controller with epoch 35 (kafka.controller.KafkaController)
[2022-05-03 18:48:44,083] INFO [Controller id=4] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:48:44,083] INFO [Controller id=4] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:48:44,083] INFO [Controller id=4] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:48:44,084] INFO [Controller id=4] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:48:44,084] INFO [Controller id=4] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:48:44,093] INFO [Controller id=4] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:48:44,098] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:44,101] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:44,101] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:44,101] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:48:44,102] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set(4) (kafka.controller.KafkaController)
[2022-05-03 18:48:44,103] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:44,104] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:44,105] INFO [RequestSendThread controllerId=4] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:48:44,105] TRACE [RequestSendThread controllerId=4] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2022-05-03 18:48:44,105] INFO [RequestSendThread controllerId=4] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:48:44,105] INFO [RequestSendThread controllerId=4] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:48:44,107] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:48:46,878] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@46f5f779, name=log4j:logger=kafka.controller (kafka.controller)
[2022-05-03 18:48:53,282] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:48:53,313] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 36 and epoch zk version is now 36 (kafka.controller.KafkaController)
[2022-05-03 18:48:53,316] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-05-03 18:48:53,321] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-05-03 18:48:53,325] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-05-03 18:48:53,329] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-05-03 18:48:53,346] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 4792) (kafka.controller.KafkaController)
[2022-05-03 18:48:53,354] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:48:53,365] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:48:53,387] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:48:53,389] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-05-03 18:48:53,389] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:48:53,389] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-05-03 18:48:53,390] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-05-03 18:48:53,394] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-05-03 18:48:53,394] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:48:53,394] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-05-03 18:48:53,395] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-05-03 18:48:53,396] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-05-03 18:48:53,409] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:53,409] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:53,412] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:53,413] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:48:53,413] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:53,414] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:53,416] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:48:53,418] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:48:53,418] INFO [Controller id=0] Ready to serve as the new controller with epoch 36 (kafka.controller.KafkaController)
[2022-05-03 18:48:53,428] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:48:53,429] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-05-03 18:48:53,429] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-05-03 18:48:53,429] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-05-03 18:48:53,430] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-05-03 18:48:53,443] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-05-03 18:48:58,445] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-05-03 18:48:58,446] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-05-03 18:49:08,128] INFO [Controller id=0] Newly added brokers: 3, deleted brokers: , bounced brokers: , all live brokers: 0,3 (kafka.controller.KafkaController)
[2022-05-03 18:49:08,128] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:49:08,131] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:49:08,133] INFO [Controller id=0] New broker startup callback for 3 (kafka.controller.KafkaController)
[2022-05-03 18:49:08,136] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9095 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:49:08,138] DEBUG [Controller id=0] Register BrokerModifications handler for List(3) (kafka.controller.KafkaController)
[2022-05-03 18:49:08,141] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4792, 3 -> 4840) (kafka.controller.KafkaController)
[2022-05-03 18:49:08,170] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:08,187] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:49:13,193] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:49:13,193] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:49:13,197] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:49:13,197] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2022-05-03 18:49:13,198] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2022-05-03 18:49:13,199] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9096 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:49:13,200] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4792, 3 -> 4840, 4 -> 4856) (kafka.controller.KafkaController)
[2022-05-03 18:49:13,239] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:13,255] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:49:18,211] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:49:18,211] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2022-05-03 18:49:18,214] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-05-03 18:49:18,214] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2022-05-03 18:49:18,216] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2022-05-03 18:49:18,216] INFO [RequestSendThread controllerId=0] Controller 0 connected to joao:9097 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-05-03 18:49:18,218] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 4792, 3 -> 4840, 4 -> 4856, 5 -> 4872) (kafka.controller.KafkaController)
[2022-05-03 18:49:18,258] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:18,273] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-05-03 18:49:22,593] INFO [Controller id=0] New topics: [Set(Sensor)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(Sensor,Some(9xMr0jr5Q2GuhZ5I0h3Dwg),HashMap(Sensor-0 -> ReplicaAssignment(replicas=4,5,3, addingReplicas=, removingReplicas=), Sensor-5 -> ReplicaAssignment(replicas=0,4,5, addingReplicas=, removingReplicas=), Sensor-2 -> ReplicaAssignment(replicas=5,4,0, addingReplicas=, removingReplicas=), Sensor-3 -> ReplicaAssignment(replicas=3,0,5, addingReplicas=, removingReplicas=), Sensor-1 -> ReplicaAssignment(replicas=0,3,4, addingReplicas=, removingReplicas=), Sensor-4 -> ReplicaAssignment(replicas=4,3,0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-05-03 18:49:22,594] INFO [Controller id=0] New partition creation callback for Sensor-0,Sensor-5,Sensor-2,Sensor-3,Sensor-1,Sensor-4 (kafka.controller.KafkaController)
[2022-05-03 18:49:32,686] DEBUG [Controller id=0] Delete topics listener fired for topics Sensor to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:49:32,687] INFO [Controller id=0] Starting topic deletion for topics Sensor (kafka.controller.KafkaController)
[2022-05-03 18:49:32,689] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,693] INFO [Topic Deletion Manager 0] Deletion of topic Sensor (re)started (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,845] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:49:32,848] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=1,Replica=0],[Topic=Sensor,Partition=4,Replica=0],[Topic=Sensor,Partition=3,Replica=0],[Topic=Sensor,Partition=5,Replica=0],[Topic=Sensor,Partition=2,Replica=0] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,850] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,851] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 4: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:49:32,851] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=4],[Topic=Sensor,Partition=2,Replica=4],[Topic=Sensor,Partition=0,Replica=4],[Topic=Sensor,Partition=4,Replica=4],[Topic=Sensor,Partition=1,Replica=4] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,852] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,854] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 5: request error = NONE, partition errors = HashMap(Sensor-5 -> NONE, Sensor-2 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:49:32,854] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=5,Replica=5],[Topic=Sensor,Partition=2,Replica=5],[Topic=Sensor,Partition=3,Replica=5],[Topic=Sensor,Partition=0,Replica=5] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,855] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,856] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 3: request error = NONE, partition errors = HashMap(Sensor-4 -> NONE, Sensor-3 -> NONE, Sensor-0 -> NONE, Sensor-1 -> NONE) (kafka.controller.KafkaController)
[2022-05-03 18:49:32,856] DEBUG [Topic Deletion Manager 0] Deletion successfully completed for replicas [Topic=Sensor,Partition=4,Replica=3],[Topic=Sensor,Partition=3,Replica=3],[Topic=Sensor,Partition=0,Replica=3],[Topic=Sensor,Partition=1,Replica=3] (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,856] INFO [Topic Deletion Manager 0] Handling deletion for topics Sensor (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,913] INFO [Topic Deletion Manager 0] Deletion of topic Sensor successfully completed (kafka.controller.TopicDeletionManager)
[2022-05-03 18:49:32,914] INFO [Controller id=0] New topics: [Set()], deleted topics: [HashSet()], new partition replica assignment [Set()] (kafka.controller.KafkaController)
[2022-05-03 18:49:32,916] DEBUG [Controller id=0] Delete topics listener fired for topics  to be deleted (kafka.controller.KafkaController)
[2022-05-03 18:49:33,090] INFO [Controller id=0] Shutting down broker 5 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,091] DEBUG [Controller id=0] All shutting down brokers: 5 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,091] DEBUG [Controller id=0] Live brokers: 0,3,4 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,094] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:49:33,106] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,107] DEBUG [Controller id=0] All shutting down brokers: 0,5 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,107] DEBUG [Controller id=0] Live brokers: 3,4 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,107] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:49:33,108] INFO [Controller id=0] Shutting down broker 3 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,108] DEBUG [Controller id=0] All shutting down brokers: 0,3,5 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,108] DEBUG [Controller id=0] Live brokers: 4 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,109] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:49:33,109] INFO [Controller id=0] Shutting down broker 4 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,109] DEBUG [Controller id=0] All shutting down brokers: 0,3,4,5 (kafka.controller.KafkaController)
[2022-05-03 18:49:33,109] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-05-03 18:49:33,110] TRACE [Controller id=0] All leaders =  (kafka.controller.KafkaController)
[2022-05-03 18:49:33,965] INFO [ControllerEventThread controllerId=5] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:33,966] INFO [ControllerEventThread controllerId=5] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:33,966] INFO [ControllerEventThread controllerId=5] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:33,967] DEBUG [Controller id=5] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:49:33,967] DEBUG [Controller id=5] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:49:33,968] INFO [PartitionStateMachine controllerId=5] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:49:33,968] INFO [ReplicaStateMachine controllerId=5] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:49:33,969] INFO [Controller id=5] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:49:34,093] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,094] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,094] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,095] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:49:34,095] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:49:34,096] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:49:34,096] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:49:34,097] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:49:34,153] INFO [ControllerEventThread controllerId=4] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,154] INFO [ControllerEventThread controllerId=4] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,154] INFO [ControllerEventThread controllerId=4] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,154] DEBUG [Controller id=4] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:49:34,155] DEBUG [Controller id=4] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-05-03 18:49:34,155] INFO [PartitionStateMachine controllerId=4] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:49:34,156] INFO [ReplicaStateMachine controllerId=4] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:49:34,157] INFO [Controller id=4] Resigned (kafka.controller.KafkaController)
[2022-05-03 18:49:34,225] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,225] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,225] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-05-03 18:49:34,226] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-05-03 18:49:34,227] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 3, 4, 5) (kafka.controller.KafkaController)
[2022-05-03 18:49:34,228] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-05-03 18:49:34,229] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-05-03 18:49:34,229] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,229] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,229] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,231] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,231] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,231] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,233] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,233] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,233] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,234] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,234] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,234] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-05-03 18:49:34,236] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
