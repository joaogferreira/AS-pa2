[2022-05-03 18:07:58,338] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:07:58,366] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:07:58,370] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3) for 5 partitions (state.change.logger)
[2022-05-03 18:07:58,390] INFO [Controller id=3 epoch=9] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,391] INFO [Controller id=3 epoch=9] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,392] INFO [Controller id=3 epoch=9] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,392] INFO [Controller id=3 epoch=9] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,397] INFO [Controller id=3 epoch=9] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,397] INFO [Controller id=3 epoch=9] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,397] INFO [Controller id=3 epoch=9] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,397] INFO [Controller id=3 epoch=9] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,398] INFO [Controller id=3 epoch=9] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,404] INFO [Controller id=3 epoch=9] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,404] INFO [Controller id=3 epoch=9] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,404] INFO [Controller id=3 epoch=9] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,404] INFO [Controller id=3 epoch=9] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:07:58,405] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:07:58,405] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3) for 6 partitions (state.change.logger)
[2022-05-03 18:07:58,415] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:07:58,432] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:07:58,435] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:07:58,436] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:07:58,437] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:07:58,438] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:07:58,438] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:07:58,439] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:07:58,439] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-4 (last update controller epoch 8) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,445] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-3 (last update controller epoch 8) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,446] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-5 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,447] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,447] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-1 (last update controller epoch 8) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,451] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:07:58,460] INFO [Broker id=3] Finished LeaderAndIsr request in 46ms correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:07:58,470] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 2 (state.change.logger)
[2022-05-03 18:07:58,472] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:07:58,473] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 9 for partition Sensor-4 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,474] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 9 for partition Sensor-3 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,474] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 9 for partition Sensor-5 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,474] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 9 for partition Sensor-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,474] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 9 for partition Sensor-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:07:58,475] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:07:58,476] INFO [Broker id=3] Finished LeaderAndIsr request in 3ms correlationId 3 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:07:58,479] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 4 (state.change.logger)
[2022-05-03 18:08:03,127] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:08:03,130] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:08:03,134] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:08:03,135] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4) for 4 partitions (state.change.logger)
[2022-05-03 18:08:03,138] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 6 (state.change.logger)
[2022-05-03 18:08:03,148] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:03,149] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:03,149] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:03,149] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:03,150] INFO [Controller id=3 epoch=9] Changed partition Sensor-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=5, isr=List(4), zkVersion=5) (state.change.logger)
[2022-05-03 18:08:03,150] INFO [Controller id=3 epoch=9] Changed partition Sensor-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=5, isr=List(4), zkVersion=5) (state.change.logger)
[2022-05-03 18:08:03,150] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:08:03,151] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:08:03,151] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:08:03,152] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:08:03,156] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:08:03,157] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:08:03,158] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 7 for 2 partitions (state.change.logger)
[2022-05-03 18:08:03,193] INFO [Broker id=3] Finished LeaderAndIsr request in 41ms correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:08:03,196] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 8 (state.change.logger)
[2022-05-03 18:08:03,396] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 0 (state.change.logger)
[2022-05-03 18:08:03,417] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:08:03,441] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-3 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:08:03,446] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-5 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:08:03,447] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:08:03,447] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:08:03,451] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:08:03,463] INFO [Broker id=4] Finished LeaderAndIsr request in 46ms correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:08:03,470] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 2 (state.change.logger)
[2022-05-03 18:08:03,474] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:08:03,478] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 9 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:08:03,486] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:08:03,494] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:08:03,498] INFO [Broker id=4] Finished LeaderAndIsr request in 24ms correlationId 3 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:08:03,502] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 4 (state.change.logger)
[2022-05-03 18:08:04,489] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:08:04,491] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 9 (state.change.logger)
[2022-05-03 18:08:04,491] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 5 (state.change.logger)
[2022-05-03 18:08:04,504] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:08:04,505] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 10 (state.change.logger)
[2022-05-03 18:08:04,506] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 6 (state.change.logger)
[2022-05-03 18:08:08,013] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:08:08,014] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(5) for 6 partitions (state.change.logger)
[2022-05-03 18:08:08,017] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:08:08,017] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:08:08,021] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 12 (state.change.logger)
[2022-05-03 18:08:08,021] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 8 (state.change.logger)
[2022-05-03 18:08:08,026] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:08,026] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:08,026] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:08,027] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:08:08,027] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:08:08,230] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 0 (state.change.logger)
[2022-05-03 18:08:08,252] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:08:08,273] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-4 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:08:08,281] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:08:08,281] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:08:08,282] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:08:08,282] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 9 for partition Sensor-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:08:08,285] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 1 for 2 partitions (state.change.logger)
[2022-05-03 18:08:08,320] INFO [Broker id=5] Finished LeaderAndIsr request in 70ms correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:08:08,326] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 2 (state.change.logger)
[2022-05-03 18:08:08,330] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:08:08,332] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 13 (state.change.logger)
[2022-05-03 18:08:08,332] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 9 (state.change.logger)
[2022-05-03 18:08:08,334] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 3 (state.change.logger)
[2022-05-03 18:08:08,338] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:08:08,341] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 14 (state.change.logger)
[2022-05-03 18:08:08,341] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 10 (state.change.logger)
[2022-05-03 18:08:08,341] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 4 (state.change.logger)
[2022-05-03 18:11:18,976] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:18,978] INFO [Controller id=3 epoch=9] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:11:18,981] INFO [Broker id=3] Handling StopReplica request correlationId 15 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:11:18,984] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 15 epoch 9 for partition Sensor-5 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:18,984] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 15 epoch 9 for partition Sensor-2 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:18,986] INFO [Controller id=3 epoch=9] Partition Sensor-5 state changed to (Leader:4,ISR:4,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:9) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:18,986] INFO [Controller id=3 epoch=9] Partition Sensor-2 state changed to (Leader:4,ISR:4,5,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:9) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:18,987] INFO [Controller id=3 epoch=9] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:18,987] INFO [Controller id=3 epoch=9] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:18,987] INFO [Controller id=3 epoch=9] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:18,988] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:11:18,988] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:11:18,988] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:11:18,988] INFO [Controller id=3 epoch=9] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:11:18,989] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:11:18,989] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 5 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:11:18,990] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 5 from controller 3 epoch 9 for partition Sensor-4 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:18,990] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 3 epoch 9 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:11:18,990] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:11:18,991] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:11:18,991] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:11:18,991] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 5 from controller 3 epoch 9 for partition Sensor-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:18,991] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 16 (state.change.logger)
[2022-05-03 18:11:18,993] INFO [Broker id=3] Handling StopReplica request correlationId 17 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:11:18,994] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 17 epoch 9 for partition Sensor-5 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:18,994] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 17 epoch 9 for partition Sensor-2 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:18,994] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 5 for 2 partitions (state.change.logger)
[2022-05-03 18:11:18,997] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 11 from controller 3 epoch 9 for partition Sensor-5 (last update controller epoch 9) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:11:18,997] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:11:19,000] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 11 from controller 3 epoch 9 for partition Sensor-2 (last update controller epoch 9) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:11:19,000] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 11 from controller 3 epoch 9 for partition Sensor-3 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:19,001] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 11 for 0 partitions (state.change.logger)
[2022-05-03 18:11:19,001] INFO [Broker id=4] Finished LeaderAndIsr request in 12ms correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:11:19,004] INFO [Controller id=3 epoch=9] Changed partition Sensor-5 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=7, isr=List(5), zkVersion=9) (state.change.logger)
[2022-05-03 18:11:19,004] INFO [Controller id=3 epoch=9] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=7, isr=List(5), zkVersion=9) (state.change.logger)
[2022-05-03 18:11:19,004] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:11:19,005] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 12 (state.change.logger)
[2022-05-03 18:11:19,005] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:11:19,005] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:11:19,005] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,006] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:19,006] INFO [Controller id=3 epoch=9] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:11:19,008] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 13 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,009] INFO [Controller id=3 epoch=9] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:19,010] INFO [Controller id=3 epoch=9] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:19,010] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:11:19,011] INFO [Broker id=5] Finished LeaderAndIsr request in 21ms correlationId 5 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:11:19,011] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:11:19,011] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:11:19,011] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 13 for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,011] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:11:19,013] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,014] INFO [Controller id=3 epoch=9] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:11:19,014] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 6 (state.change.logger)
[2022-05-03 18:11:19,016] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,019] INFO [Broker id=4] Finished LeaderAndIsr request in 12ms correlationId 13 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,020] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,021] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 3 epoch 9 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,022] ERROR [Controller id=3 epoch=9] Controller 3 epoch 9 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:19,024] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:19,024] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:19,024] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 14 (state.change.logger)
[2022-05-03 18:11:19,024] INFO [Controller id=3 epoch=9] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:11:19,027] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:11:19,027] INFO [Broker id=4] Handling StopReplica request correlationId 15 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,028] INFO [Controller id=3 epoch=9] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:19,029] INFO [Controller id=3 epoch=9] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:19,029] INFO [Controller id=3 epoch=9] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:19,029] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:11:19,029] INFO [Controller id=3 epoch=9] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:11:19,029] INFO [Controller id=3 epoch=9] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:11:19,030] INFO [Controller id=3 epoch=9] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:11:19,033] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:11:19,035] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 16 (state.change.logger)
[2022-05-03 18:11:19,036] INFO [Broker id=5] Finished LeaderAndIsr request in 20ms correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,036] INFO [Broker id=4] Handling StopReplica request correlationId 17 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:11:19,038] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 8 (state.change.logger)
[2022-05-03 18:11:19,038] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 18 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:11:19,039] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 18 from controller 3 epoch 9 for partition Sensor-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:19,039] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 18 for 0 partitions (state.change.logger)
[2022-05-03 18:11:19,039] INFO [Broker id=4] Finished LeaderAndIsr request in 1ms correlationId 18 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:11:19,039] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:11:19,040] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 9 from controller 3 epoch 9 for partition Sensor-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:19,040] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 3 epoch 9 with correlation id 9 for 0 partitions (state.change.logger)
[2022-05-03 18:11:19,040] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:11:19,041] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 19 (state.change.logger)
[2022-05-03 18:11:19,042] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 10 (state.change.logger)
[2022-05-03 18:11:19,045] INFO [Broker id=5] Handling StopReplica request correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:11:19,051] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 9 with correlation id 12 (state.change.logger)
[2022-05-03 18:11:19,052] INFO [Broker id=5] Handling StopReplica request correlationId 13 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:11:20,035] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(4, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:11:20,060] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:11:20,062] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:11:20,062] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:11:20,064] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:20,064] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:11:20,066] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,066] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,066] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,066] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,066] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-4 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,066] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-3 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,067] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,067] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,067] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:11:20,067] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,067] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:11:20,067] INFO [Broker id=4] Finished LeaderAndIsr request in 3ms correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:20,067] INFO [Broker id=5] Finished LeaderAndIsr request in 3ms correlationId 1 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:11:20,071] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 2 (state.change.logger)
[2022-05-03 18:11:20,071] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 2 (state.change.logger)
[2022-05-03 18:11:20,090] INFO [Controller id=5 epoch=10] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,090] INFO [Controller id=5 epoch=10] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,091] INFO [Controller id=5 epoch=10] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,091] INFO [Controller id=5 epoch=10] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,096] INFO [Controller id=5 epoch=10] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,096] INFO [Controller id=5 epoch=10] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,096] INFO [Controller id=5 epoch=10] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,096] INFO [Controller id=5 epoch=10] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,097] INFO [Controller id=5 epoch=10] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:20,097] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:11:20,097] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:11:20,097] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:20,099] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 10 for partition Sensor-3 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,099] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 10 for partition Sensor-4 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,099] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,099] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:11:20,099] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 10 for partition Sensor-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:11:20,099] INFO [Broker id=4] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:20,100] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:11:20,102] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 4 (state.change.logger)
[2022-05-03 18:11:20,102] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 4 (state.change.logger)
[2022-05-03 18:11:20,123] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:20,124] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:20,124] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:20,124] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:20,125] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:24,029] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:24,029] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:24,029] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:24,030] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:24,032] INFO [Controller id=5 epoch=10] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:11:24,034] INFO [Broker id=5] Handling StopReplica request correlationId 5 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:24,036] INFO [Controller id=5 epoch=10] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:24,036] INFO [Controller id=5 epoch=10] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:24,036] INFO [Controller id=5 epoch=10] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:24,037] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:11:24,037] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:11:24,037] INFO [Controller id=5 epoch=10] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:11:24,038] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 5 from controller 5 for 1 partitions (state.change.logger)
[2022-05-03 18:11:24,038] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 5 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:24,038] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 5 for 0 partitions (state.change.logger)
[2022-05-03 18:11:24,038] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 6 (state.change.logger)
[2022-05-03 18:11:24,038] INFO [Broker id=4] Finished LeaderAndIsr request in 0ms correlationId 5 from controller 5 for 1 partitions (state.change.logger)
[2022-05-03 18:11:24,040] INFO [Broker id=5] Handling StopReplica request correlationId 7 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:24,041] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 6 (state.change.logger)
[2022-05-03 18:11:24,042] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:24,042] INFO [Controller id=5 epoch=10] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:11:24,043] INFO [Broker id=4] Handling StopReplica request correlationId 7 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:24,045] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:24,045] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:24,045] INFO [Controller id=5 epoch=10] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:24,046] INFO [Controller id=5 epoch=10] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:24,046] INFO [Controller id=5 epoch=10] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:24,047] INFO [Controller id=5 epoch=10] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:24,047] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:11:24,047] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:11:24,048] INFO [Controller id=5 epoch=10] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:11:24,048] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 8 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:24,048] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 8 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:24,048] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 8 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:24,049] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 8 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:24,049] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 8 for 0 partitions (state.change.logger)
[2022-05-03 18:11:24,049] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 8 (state.change.logger)
[2022-05-03 18:11:24,049] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 8 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:24,050] INFO [Broker id=4] Handling StopReplica request correlationId 9 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:24,050] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:24,051] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:24,051] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 9 (state.change.logger)
[2022-05-03 18:11:25,128] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:25,133] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:25,133] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:25,134] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:25,134] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:25,134] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:25,134] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:25,135] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:25,138] INFO [Controller id=5 epoch=10] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:25,138] INFO [Controller id=5 epoch=10] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:25,138] INFO [Controller id=5 epoch=10] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:25,138] INFO [Controller id=5 epoch=10] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:25,139] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:11:25,139] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(5) for 4 partitions (state.change.logger)
[2022-05-03 18:11:25,140] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 10 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:25,140] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 10 epoch 10 for partition Sensor-5 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:25,140] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 10 epoch 10 for partition Sensor-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:25,140] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 10 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:25,140] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 10 for 0 partitions (state.change.logger)
[2022-05-03 18:11:25,140] INFO [Broker id=5] Finished LeaderAndIsr request in 0ms correlationId 10 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:25,142] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 11 (state.change.logger)
[2022-05-03 18:11:29,046] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:29,046] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:29,046] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:29,047] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:29,047] INFO [Controller id=5 epoch=10] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:11:29,048] INFO [Broker id=5] Handling StopReplica request correlationId 12 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:29,049] INFO [Controller id=5 epoch=10] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:29,050] INFO [Controller id=5 epoch=10] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:29,050] INFO [Controller id=5 epoch=10] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:10) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:29,050] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(5) for 3 partitions (state.change.logger)
[2022-05-03 18:11:29,050] INFO [Controller id=5 epoch=10] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:11:29,052] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 13 (state.change.logger)
[2022-05-03 18:11:29,053] INFO [Broker id=5] Handling StopReplica request correlationId 14 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:11:29,930] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:11:29,931] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(0) for 6 partitions (state.change.logger)
[2022-05-03 18:11:29,933] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:11:29,933] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:11:29,944] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:29,944] ERROR [Controller id=5 epoch=10] Controller 5 epoch 10 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:29,945] INFO [Controller id=5 epoch=10] Changed partition Sensor-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=5, isr=List(0), zkVersion=5) (state.change.logger)
[2022-05-03 18:11:29,945] INFO [Controller id=5 epoch=10] Changed partition Sensor-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=5, isr=List(0), zkVersion=5) (state.change.logger)
[2022-05-03 18:11:29,945] INFO [Controller id=5 epoch=10] Changed partition Sensor-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=5, isr=List(0), zkVersion=5) (state.change.logger)
[2022-05-03 18:11:29,945] INFO [Controller id=5 epoch=10] Changed partition Sensor-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=5, isr=List(0), zkVersion=5) (state.change.logger)
[2022-05-03 18:11:29,945] INFO [Controller id=5 epoch=10] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:11:29,945] INFO [Controller id=5 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,144] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 10 with correlation id 0 (state.change.logger)
[2022-05-03 18:11:30,164] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,184] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-4 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:30,192] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-3 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:30,193] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:30,194] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 10 for partition Sensor-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:30,197] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 5 epoch 10 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:11:30,210] INFO [Broker id=0] Finished LeaderAndIsr request in 47ms correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,295] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:11:30,328] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:11:30,330] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0) for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,334] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,338] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 11 as part of the become-leader transition for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,346] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:30,355] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:30,357] INFO [Controller id=0 epoch=11] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,357] INFO [Controller id=0 epoch=11] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:11) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,358] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:30,358] INFO [Controller id=0 epoch=11] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:11) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,358] INFO [Controller id=0 epoch=11] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,358] INFO [Controller id=0 epoch=11] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,360] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:30,363] INFO [Controller id=0 epoch=11] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,363] INFO [Controller id=0 epoch=11] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,364] INFO [Controller id=0 epoch=11] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,364] INFO [Controller id=0 epoch=11] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,364] INFO [Broker id=0] Finished LeaderAndIsr request in 30ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,365] INFO [Controller id=0 epoch=11] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,368] INFO [Controller id=0 epoch=11] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:11) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,369] INFO [Controller id=0 epoch=11] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:11) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,369] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2022-05-03 18:11:30,369] INFO [Controller id=0 epoch=11] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,370] INFO [Controller id=0 epoch=11] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:11) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:11:30,370] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:11:30,370] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0) for 6 partitions (state.change.logger)
[2022-05-03 18:11:30,372] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,374] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 11 for partition Sensor-4 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:30,374] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 11 for partition Sensor-3 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:30,374] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 11 for partition Sensor-0 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:30,374] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 11 for partition Sensor-1 since its associated leader epoch 5 matches the current leader epoch (state.change.logger)
[2022-05-03 18:11:30,374] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:11:30,378] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2022-05-03 18:11:30,397] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:30,400] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:30,401] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:44,969] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:11:44,971] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(3) for 6 partitions (state.change.logger)
[2022-05-03 18:11:44,974] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:11:44,974] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3) for 5 partitions (state.change.logger)
[2022-05-03 18:11:44,977] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 6 (state.change.logger)
[2022-05-03 18:11:44,980] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:44,981] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:44,981] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:45,195] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2022-05-03 18:11:45,215] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:11:45,240] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:45,241] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:45,242] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition Sensor-5 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:45,243] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition Sensor-2 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:45,244] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:45,245] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:11:45,286] INFO [Broker id=3] Finished LeaderAndIsr request in 73ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:11:45,292] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2022-05-03 18:11:45,333] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3) for 1 partitions (state.change.logger)
[2022-05-03 18:11:45,335] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 7 (state.change.logger)
[2022-05-03 18:11:45,335] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 3 (state.change.logger)
[2022-05-03 18:11:45,347] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3) for 2 partitions (state.change.logger)
[2022-05-03 18:11:45,349] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 8 (state.change.logger)
[2022-05-03 18:11:45,350] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2022-05-03 18:11:49,971] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:11:49,972] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:11:49,974] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:11:49,975] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 4 partitions (state.change.logger)
[2022-05-03 18:11:49,977] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 10 (state.change.logger)
[2022-05-03 18:11:49,978] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 6 (state.change.logger)
[2022-05-03 18:11:49,981] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:49,981] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:11:49,981] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:11:50,196] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2022-05-03 18:11:50,214] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:11:50,241] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:50,242] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition Sensor-5 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:50,243] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:50,243] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition Sensor-2 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:50,245] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 2 partitions (state.change.logger)
[2022-05-03 18:11:50,278] INFO [Broker id=4] Finished LeaderAndIsr request in 65ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:11:50,284] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2022-05-03 18:11:50,286] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:11:50,288] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 11 (state.change.logger)
[2022-05-03 18:11:50,289] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 3 (state.change.logger)
[2022-05-03 18:11:50,289] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 7 (state.change.logger)
[2022-05-03 18:11:50,295] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:11:50,297] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 12 (state.change.logger)
[2022-05-03 18:11:50,297] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 8 (state.change.logger)
[2022-05-03 18:11:50,298] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2022-05-03 18:11:55,016] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:11:55,017] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(5) for 6 partitions (state.change.logger)
[2022-05-03 18:11:55,019] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:11:55,020] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:11:55,022] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 14 (state.change.logger)
[2022-05-03 18:11:55,022] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 6 (state.change.logger)
[2022-05-03 18:11:55,023] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 10 (state.change.logger)
[2022-05-03 18:11:55,031] INFO [Controller id=0 epoch=11] Changed partition Sensor-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=9, isr=List(5), zkVersion=11) (state.change.logger)
[2022-05-03 18:11:55,031] INFO [Controller id=0 epoch=11] Changed partition Sensor-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=9, isr=List(5), zkVersion=11) (state.change.logger)
[2022-05-03 18:11:55,031] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:11:55,032] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:11:55,032] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:11:55,033] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,033] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,033] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,035] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,035] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 15 (state.change.logger)
[2022-05-03 18:11:55,035] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,036] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,036] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,038] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 7 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,038] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 11 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,045] INFO [Broker id=3] Finished LeaderAndIsr request in 12ms correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,045] INFO [Broker id=4] Finished LeaderAndIsr request in 12ms correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,048] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 12 (state.change.logger)
[2022-05-03 18:11:55,048] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 8 (state.change.logger)
[2022-05-03 18:11:55,265] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 0 (state.change.logger)
[2022-05-03 18:11:55,285] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:11:55,321] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,322] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition Sensor-5 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:55,322] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,323] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 11 for partition Sensor-2 (last update controller epoch 11) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:11:55,323] INFO [Broker id=5] Follower Sensor-1 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,326] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:11:55,369] INFO [Broker id=5] Finished LeaderAndIsr request in 86ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:11:55,376] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 2 (state.change.logger)
[2022-05-03 18:11:55,376] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:11:55,379] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,379] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 16 (state.change.logger)
[2022-05-03 18:11:55,380] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 13 (state.change.logger)
[2022-05-03 18:11:55,380] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 9 (state.change.logger)
[2022-05-03 18:11:55,386] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 11 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,386] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,389] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 17 (state.change.logger)
[2022-05-03 18:11:55,389] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 14 (state.change.logger)
[2022-05-03 18:11:55,389] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 10 (state.change.logger)
[2022-05-03 18:11:55,391] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,397] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:11:55,400] INFO [Broker id=5] Finished LeaderAndIsr request in 22ms correlationId 3 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:11:55,402] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 4 (state.change.logger)
[2022-05-03 18:11:55,405] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 5 (state.change.logger)
[2022-05-03 18:11:55,407] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 6 (state.change.logger)
[2022-05-03 18:11:56,353] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:11:56,356] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 7 (state.change.logger)
[2022-05-03 18:11:56,356] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 15 (state.change.logger)
[2022-05-03 18:11:56,357] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 18 (state.change.logger)
[2022-05-03 18:11:56,358] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 11 (state.change.logger)
[2022-05-03 18:11:56,868] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:11:56,870] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 19 (state.change.logger)
[2022-05-03 18:11:56,871] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 8 (state.change.logger)
[2022-05-03 18:11:56,871] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 12 (state.change.logger)
[2022-05-03 18:11:56,871] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 16 (state.change.logger)
[2022-05-03 18:12:50,923] INFO [Controller id=0 epoch=11] Changed partition Sensor-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=6, isr=List(3, 5), zkVersion=8) (state.change.logger)
[2022-05-03 18:12:50,923] INFO [Controller id=0 epoch=11] Changed partition Sensor-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=6, isr=List(3, 4), zkVersion=8) (state.change.logger)
[2022-05-03 18:12:50,923] INFO [Controller id=0 epoch=11] Changed partition Sensor-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=6, isr=List(4, 5), zkVersion=8) (state.change.logger)
[2022-05-03 18:12:50,923] INFO [Controller id=0 epoch=11] Changed partition Sensor-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=6, isr=List(3, 5), zkVersion=8) (state.change.logger)
[2022-05-03 18:12:50,923] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,923] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,923] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,924] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,924] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,924] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 20 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,924] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:50,925] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 17 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:12:50,925] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:12:50,925] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,925] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,925] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,925] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,926] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 0 epoch 11 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,926] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 17 for 3 partitions (state.change.logger)
[2022-05-03 18:12:50,926] INFO [Broker id=5] Leader Sensor-4 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [3,5] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,926] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,927] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,927] INFO [Broker id=0] Follower Sensor-0 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,928] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,928] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 20 for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,929] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 0 epoch 11 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,930] INFO [Broker id=5] Leader Sensor-1 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [3,5] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,932] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,933] INFO [Controller id=0 epoch=11] Changed partition Sensor-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=7, isr=List(3), zkVersion=9) (state.change.logger)
[2022-05-03 18:12:50,933] INFO [Controller id=0 epoch=11] Changed partition Sensor-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=7, isr=List(5), zkVersion=9) (state.change.logger)
[2022-05-03 18:12:50,933] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,933] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,933] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 9 for 1 partitions (state.change.logger)
[2022-05-03 18:12:50,934] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,934] INFO [Broker id=4] Leader Sensor-3 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [3,4] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,934] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 5 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,934] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,936] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:50,936] INFO [Broker id=0] Finished LeaderAndIsr request in 12ms correlationId 20 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,938] INFO [Controller id=0 epoch=11] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:12:50,941] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 21 (state.change.logger)
[2022-05-03 18:12:50,944] INFO [Broker id=3] Finished LeaderAndIsr request in 20ms correlationId 17 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:12:50,944] INFO [Broker id=4] Leader Sensor-0 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:12:50,947] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 18 (state.change.logger)
[2022-05-03 18:12:50,949] INFO [Controller id=0 epoch=11] Partition Sensor-5 state changed to (Leader:5,ISR:5,3,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:11) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:50,950] INFO [Controller id=0 epoch=11] Partition Sensor-2 state changed to (Leader:5,ISR:5,3,LeaderEpoch:10,ZkVersion:14,ControllerEpoch:11) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:50,950] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 19 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:12:50,953] INFO [Broker id=5] Finished LeaderAndIsr request in 28ms correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:12:50,954] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 19 from controller 0 epoch 11 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:12:50,955] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,955] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,955] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,956] INFO [Controller id=0 epoch=11] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:12:50,956] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 10 (state.change.logger)
[2022-05-03 18:12:50,957] INFO [Broker id=4] Finished LeaderAndIsr request in 32ms correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,959] INFO [Broker id=3] Leader Sensor-3 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [3] addingReplicas [] removingReplicas []. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:50,959] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:50,959] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:50,959] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:50,959] INFO [Controller id=0 epoch=11] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:12:50,959] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:12:50,960] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 0 epoch 11 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:12:50,960] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 14 (state.change.logger)
[2022-05-03 18:12:50,960] INFO [Broker id=5] Leader Sensor-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:50,962] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 15 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Controller id=0 epoch=11] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Controller id=0 epoch=11] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 15 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Controller id=0 epoch=11] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Controller id=0 epoch=11] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:11) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:50,963] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,964] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,964] INFO [Controller id=0 epoch=11] Sending LeaderAndIsr request to broker 5 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:50,964] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,964] INFO [Broker id=5] Finished LeaderAndIsr request in 5ms correlationId 11 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:12:50,964] INFO [Controller id=0 epoch=11] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:12:50,964] INFO [Broker id=4] Finished LeaderAndIsr request in 2ms correlationId 15 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,966] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 12 (state.change.logger)
[2022-05-03 18:12:50,966] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 16 (state.change.logger)
[2022-05-03 18:12:50,967] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:50,967] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:50,967] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,967] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:50,968] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 0 epoch 11 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,967] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:50,968] INFO [Broker id=3] Finished LeaderAndIsr request in 18ms correlationId 19 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:12:50,968] ERROR [Controller id=0 epoch=11] Controller 0 epoch 11 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:50,968] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [5,3] addingReplicas [] removingReplicas []. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:12:50,969] INFO [Broker id=4] Handling StopReplica request correlationId 17 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,973] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 13 from controller 0 epoch 11 for partition Sensor-5 (last update controller epoch 11) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:12:50,974] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [5,3] addingReplicas [] removingReplicas []. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:12:50,974] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 17 epoch 11 for partition Sensor-5 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,974] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 17 epoch 11 for partition Sensor-2 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,975] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:50,975] INFO [Controller id=0 epoch=11] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:50,976] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 13 from controller 0 epoch 11 for partition Sensor-2 (last update controller epoch 11) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:12:50,976] INFO [Broker id=5] Finished LeaderAndIsr request in 9ms correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,977] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 20 (state.change.logger)
[2022-05-03 18:12:50,978] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 21 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,978] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 14 (state.change.logger)
[2022-05-03 18:12:50,979] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:12:50,979] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:12:50,980] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 21 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,980] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 15 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,980] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 15 from controller 0 epoch 11 as part of the become-leader transition for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,981] INFO [Broker id=5] Leader Sensor-4 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:50,984] INFO [Broker id=3] Finished LeaderAndIsr request in 6ms correlationId 21 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,985] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 15 from controller 0 epoch 11 for partition Sensor-4 (last update controller epoch 11) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:12:50,985] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:12:50,988] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 15 from controller 0 epoch 11 for partition Sensor-5 (last update controller epoch 11) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:12:50,988] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 22 (state.change.logger)
[2022-05-03 18:12:50,988] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:12:50,988] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 18 (state.change.logger)
[2022-05-03 18:12:50,992] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 15 from controller 0 epoch 11 for partition Sensor-2 (last update controller epoch 11) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:12:50,992] INFO [Broker id=4] Handling StopReplica request correlationId 19 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,992] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 19 epoch 11 for partition Sensor-5 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,992] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 19 epoch 11 for partition Sensor-2 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,992] INFO [Broker id=5] Leader Sensor-1 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:50,993] INFO [Broker id=3] Handling StopReplica request correlationId 23 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,994] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 20 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,994] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:12:50,994] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:12:50,994] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 15 from controller 0 epoch 11 for partition Sensor-1 (last update controller epoch 11) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:12:50,995] INFO [Broker id=5] Finished LeaderAndIsr request in 15ms correlationId 15 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:12:50,995] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 11 with correlation id 20 for 2 partitions (state.change.logger)
[2022-05-03 18:12:50,995] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 11 for partition Sensor-4 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,995] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 11 for partition Sensor-5 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,995] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 11 for partition Sensor-2 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,995] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 11 for partition Sensor-1 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:50,997] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 16 (state.change.logger)
[2022-05-03 18:12:51,002] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 24 (state.change.logger)
[2022-05-03 18:12:51,002] INFO [Broker id=4] Finished LeaderAndIsr request in 9ms correlationId 20 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:12:51,004] INFO [Broker id=3] Handling StopReplica request correlationId 25 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:12:51,004] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 11 for partition Sensor-4 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:51,004] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 11 for partition Sensor-5 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:51,004] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 11 for partition Sensor-2 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:51,004] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 11 for partition Sensor-1 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:51,004] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 11 with correlation id 21 (state.change.logger)
[2022-05-03 18:12:52,064] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:12:52,093] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:12:52,095] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:12:52,095] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 5 with 5 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:52,096] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:12:52,098] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:12:52,098] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:12:52,098] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:52,100] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,100] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,100] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,100] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,100] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,100] INFO [Broker id=5] Finished LeaderAndIsr request in 3ms correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:12:52,100] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 1 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=4] Finished LeaderAndIsr request in 3ms correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:12:52,101] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was 6. (state.change.logger)
[2022-05-03 18:12:52,102] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 12 with correlation id 1 for 4 partitions (state.change.logger)
[2022-05-03 18:12:52,102] INFO [Broker id=3] Finished LeaderAndIsr request in 4ms correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:12:52,105] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 2 (state.change.logger)
[2022-05-03 18:12:52,105] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 2 (state.change.logger)
[2022-05-03 18:12:52,106] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 2 (state.change.logger)
[2022-05-03 18:12:52,113] INFO [Controller id=3 epoch=12] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:52,114] INFO [Controller id=3 epoch=12] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:52,114] INFO [Controller id=3 epoch=12] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:52,114] INFO [Controller id=3 epoch=12] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:52,116] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:52,116] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:52,117] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 5 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:52,117] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 3 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=5] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:52,118] INFO [Broker id=3] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:52,119] INFO [Broker id=4] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:12:52,121] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 4 (state.change.logger)
[2022-05-03 18:12:52,121] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 4 (state.change.logger)
[2022-05-03 18:12:52,122] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 4 (state.change.logger)
[2022-05-03 18:12:55,969] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:55,969] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:55,969] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:55,969] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:55,970] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:55,971] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:55,971] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:55,976] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:55,976] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:55,977] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:55,978] INFO [Controller id=3 epoch=12] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:12:55,980] INFO [Broker id=3] Handling StopReplica request correlationId 5 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,981] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 5 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,981] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 5 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,981] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 5 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,981] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 5 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,982] INFO [Controller id=3 epoch=12] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,983] INFO [Controller id=3 epoch=12] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,983] INFO [Controller id=3 epoch=12] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,983] INFO [Controller id=3 epoch=12] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,983] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:55,983] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 5 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:55,983] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,984] INFO [Controller id=3 epoch=12] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:12:55,984] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 5 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 5 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 3 with correlation id 5 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Controller id=3 epoch=12] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 5 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 5 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 5 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 5 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 5 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,985] INFO [Broker id=4] Finished LeaderAndIsr request in 1ms correlationId 5 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:12:55,986] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 6 (state.change.logger)
[2022-05-03 18:12:55,986] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 5 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,988] INFO [Broker id=3] Handling StopReplica request correlationId 7 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,988] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,988] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,988] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,988] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,989] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 6 (state.change.logger)
[2022-05-03 18:12:55,989] INFO [Controller id=3 epoch=12] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,989] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 6 (state.change.logger)
[2022-05-03 18:12:55,989] INFO [Controller id=3 epoch=12] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Controller id=3 epoch=12] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Controller id=3 epoch=12] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Broker id=4] Handling StopReplica request correlationId 7 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:55,990] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 7 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,991] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 5 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:55,991] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Controller id=3 epoch=12] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 8 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 8 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 8 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 7 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 8 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 7 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 7 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,992] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 7 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,993] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 7 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:55,993] INFO [Broker id=3] Finished LeaderAndIsr request in 1ms correlationId 8 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:55,993] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 8 (state.change.logger)
[2022-05-03 18:12:55,995] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 9 (state.change.logger)
[2022-05-03 18:12:55,995] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 8 (state.change.logger)
[2022-05-03 18:12:55,996] INFO [Broker id=4] Handling StopReplica request correlationId 9 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:12:55,996] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 9 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,996] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 9 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,996] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 9 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:55,996] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 9 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:57,444] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:57,455] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:57,455] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:57,455] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:57,456] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:57,456] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:57,456] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:12:57,456] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:12:57,459] INFO [Controller id=3 epoch=12] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:57,459] INFO [Controller id=3 epoch=12] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:57,460] INFO [Controller id=3 epoch=12] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:57,460] INFO [Controller id=3 epoch=12] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:12:57,460] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:12:57,460] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 5 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:12:57,460] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 9 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 10 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 9 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 9 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 3 with correlation id 9 epoch 12 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 10 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 10 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=3] Ignoring LeaderAndIsr request from controller 3 with correlation id 10 epoch 12 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:12:57,462] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 9 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:57,463] INFO [Broker id=3] Finished LeaderAndIsr request in 1ms correlationId 10 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:12:57,465] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 10 (state.change.logger)
[2022-05-03 18:12:57,465] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 11 (state.change.logger)
[2022-05-03 18:13:00,982] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:00,982] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:00,982] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:00,982] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:00,982] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:00,983] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:00,983] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:00,991] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:00,991] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:00,992] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:00,992] INFO [Controller id=3 epoch=12] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:13:00,993] INFO [Broker id=3] Handling StopReplica request correlationId 12 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:13:00,994] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 12 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:00,994] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 12 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:00,994] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 12 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:00,994] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 12 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:00,996] INFO [Controller id=3 epoch=12] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:00,996] INFO [Controller id=3 epoch=12] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:00,997] INFO [Controller id=3 epoch=12] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:00,997] INFO [Controller id=3 epoch=12] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:12) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:00,998] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 5 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:13:00,998] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:13:00,999] INFO [Controller id=3 epoch=12] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:13:01,000] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 13 (state.change.logger)
[2022-05-03 18:13:01,003] INFO [Broker id=3] Handling StopReplica request correlationId 14 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:13:01,003] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 14 epoch 12 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:01,003] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 14 epoch 12 for partition Sensor-5 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:01,003] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 14 epoch 12 for partition Sensor-2 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:01,003] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 14 epoch 12 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:01,534] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(3, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:13:01,535] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(0) for 6 partitions (state.change.logger)
[2022-05-03 18:13:01,536] INFO [Controller id=3 epoch=12] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:13:01,537] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet(0, 3, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:13:01,541] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,541] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,542] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,542] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,542] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,542] ERROR [Controller id=3 epoch=12] Controller 3 epoch 12 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:01,542] INFO [Controller id=3 epoch=12] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:01,777] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 0 (state.change.logger)
[2022-05-03 18:13:01,796] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:13:01,825] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:01,826] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:01,827] INFO [Broker id=0] Follower Sensor-0 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:01,828] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:01,829] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 3 epoch 12 with correlation id 1 for 4 partitions (state.change.logger)
[2022-05-03 18:13:01,882] INFO [Broker id=0] Finished LeaderAndIsr request in 86ms correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:13:01,889] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 12 with correlation id 2 (state.change.logger)
[2022-05-03 18:13:02,066] INFO [Controller id=5 epoch=13] Sending UpdateMetadata request to brokers HashSet(0, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:13:02,088] INFO [Controller id=5 epoch=13] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:13:02,089] INFO [Controller id=5 epoch=13] Sending LeaderAndIsr request to broker 5 with 5 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:13:02,089] INFO [Controller id=5 epoch=13] Sending UpdateMetadata request to brokers HashSet(0, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:13:02,092] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,094] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 13 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,094] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 13 for partition Sensor-3 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,094] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 13 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,094] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 13 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,096] INFO [Broker id=0] Finished LeaderAndIsr request in 4ms correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,101] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 13 with correlation id 2 (state.change.logger)
[2022-05-03 18:13:02,110] INFO [Controller id=5 epoch=13] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,110] INFO [Controller id=5 epoch=13] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,110] INFO [Controller id=5 epoch=13] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,110] INFO [Controller id=5 epoch=13] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,110] INFO [Controller id=5 epoch=13] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:13) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,114] INFO [Controller id=5 epoch=13] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:13) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,115] INFO [Controller id=5 epoch=13] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:13) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,115] INFO [Controller id=5 epoch=13] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:13) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,115] INFO [Controller id=5 epoch=13] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:13) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,116] INFO [Controller id=5 epoch=13] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:13:02,116] INFO [Controller id=5 epoch=13] Sending LeaderAndIsr request to broker 5 with 5 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:13:02,116] INFO [Controller id=5 epoch=13] Sending UpdateMetadata request to brokers HashSet(0, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:13:02,117] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,117] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 13 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,117] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 13 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,118] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 13 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,119] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 13 for partition Sensor-3 (last update controller epoch 13) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:02,121] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 5 epoch 13 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:13:02,121] INFO [Broker id=0] Finished LeaderAndIsr request in 4ms correlationId 3 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,124] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 13 with correlation id 4 (state.change.logger)
[2022-05-03 18:13:02,136] ERROR [Controller id=5 epoch=13] Controller 5 epoch 13 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,136] INFO [Controller id=5 epoch=13] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:02,250] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:13:02,272] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:13:02,277] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0) for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,279] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,279] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 14 for partition Sensor-4 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,279] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 14 for partition Sensor-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,280] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 14 for partition Sensor-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2022-05-03 18:13:02,280] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-3 (last update controller epoch 13) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:02,280] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:13:02,280] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,284] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2022-05-03 18:13:02,299] INFO [Controller id=0 epoch=14] Partition Sensor-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,299] INFO [Controller id=0 epoch=14] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,299] INFO [Controller id=0 epoch=14] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,300] INFO [Controller id=0 epoch=14] Partition Sensor-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,300] INFO [Controller id=0 epoch=14] Partition Sensor-4 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,309] INFO [Controller id=0 epoch=14] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,309] INFO [Controller id=0 epoch=14] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,309] INFO [Controller id=0 epoch=14] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:9,ZkVersion:11,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,309] INFO [Controller id=0 epoch=14] Partition Sensor-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,310] INFO [Controller id=0 epoch=14] Partition Sensor-4 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,313] INFO [Controller id=0 epoch=14] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,313] INFO [Controller id=0 epoch=14] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,313] INFO [Controller id=0 epoch=14] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:9,ZkVersion:11,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,313] INFO [Controller id=0 epoch=14] Partition Sensor-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:13:02,313] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:13:02,314] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0) for 6 partitions (state.change.logger)
[2022-05-03 18:13:02,315] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,315] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 14 for partition Sensor-4 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:02,315] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 14 for partition Sensor-3 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:02,315] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 14 for partition Sensor-0 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:02,316] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 14 for partition Sensor-1 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:02,316] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:13:02,316] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:02,319] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2022-05-03 18:13:02,339] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,339] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,340] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,340] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,340] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,341] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:02,342] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:16,450] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:13:16,452] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(3) for 6 partitions (state.change.logger)
[2022-05-03 18:13:16,455] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:13:16,456] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3) for 5 partitions (state.change.logger)
[2022-05-03 18:13:16,458] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 6 (state.change.logger)
[2022-05-03 18:13:16,466] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:16,466] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:16,467] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:16,467] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:16,467] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:16,468] INFO [Controller id=0 epoch=14] Changed partition Sensor-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=10, isr=List(3), zkVersion=12) (state.change.logger)
[2022-05-03 18:13:16,468] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:13:16,468] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:13:16,468] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3) for 1 partitions (state.change.logger)
[2022-05-03 18:13:16,470] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:13:16,470] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 7. (state.change.logger)
[2022-05-03 18:13:16,471] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 7 for 1 partitions (state.change.logger)
[2022-05-03 18:13:16,473] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 7 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:13:16,476] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 8 (state.change.logger)
[2022-05-03 18:13:16,692] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2022-05-03 18:13:16,714] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:13:16,734] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-4 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:16,738] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-3 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:16,738] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-5 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:16,738] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-2 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:16,738] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-1 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:16,740] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:13:16,747] INFO [Broker id=3] Finished LeaderAndIsr request in 34ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:13:16,753] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2022-05-03 18:13:16,756] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:13:16,759] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 14 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:13:16,765] INFO [Broker id=3] Leader Sensor-3 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:16,771] INFO [Broker id=3] Finished LeaderAndIsr request in 15ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:13:16,774] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2022-05-03 18:13:17,776] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3) for 1 partitions (state.change.logger)
[2022-05-03 18:13:17,778] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 9 (state.change.logger)
[2022-05-03 18:13:17,778] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 5 (state.change.logger)
[2022-05-03 18:13:21,482] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:13:21,483] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:13:21,486] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:13:21,486] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 4 partitions (state.change.logger)
[2022-05-03 18:13:21,489] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 11 (state.change.logger)
[2022-05-03 18:13:21,490] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 7 (state.change.logger)
[2022-05-03 18:13:21,494] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:21,494] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:21,494] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:21,494] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:21,495] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:13:21,495] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:13:21,724] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2022-05-03 18:13:21,744] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:21,772] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:21,773] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-5 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:21,774] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-0 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:21,774] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-2 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:21,776] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 1 for 1 partitions (state.change.logger)
[2022-05-03 18:13:21,822] INFO [Broker id=4] Finished LeaderAndIsr request in 79ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:21,828] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2022-05-03 18:13:21,832] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:13:21,834] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 12 (state.change.logger)
[2022-05-03 18:13:21,834] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 8 (state.change.logger)
[2022-05-03 18:13:21,834] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 3 (state.change.logger)
[2022-05-03 18:13:26,442] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:13:26,443] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(5) for 6 partitions (state.change.logger)
[2022-05-03 18:13:26,445] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:13:26,445] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:13:26,447] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 14 (state.change.logger)
[2022-05-03 18:13:26,448] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 10 (state.change.logger)
[2022-05-03 18:13:26,449] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 5 (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Changed partition Sensor-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=9, isr=List(5), zkVersion=11) (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Changed partition Sensor-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=13, isr=List(5), zkVersion=17) (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Changed partition Sensor-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=13, isr=List(5), zkVersion=17) (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Changed partition Sensor-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=9, isr=List(5), zkVersion=11) (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Changed partition Sensor-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=9, isr=List(5), zkVersion=11) (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:13:26,454] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 5 with 5 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:13:26,455] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:13:26,456] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 15 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:13:26,456] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was 7. (state.change.logger)
[2022-05-03 18:13:26,456] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 11 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:26,456] INFO [Broker id=0] Follower Sensor-0 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was 7. (state.change.logger)
[2022-05-03 18:13:26,456] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was 7. (state.change.logger)
[2022-05-03 18:13:26,456] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 6 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:13:26,457] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 15 for 3 partitions (state.change.logger)
[2022-05-03 18:13:26,457] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 13 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,458] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,458] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 13 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,458] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 15 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:13:26,459] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,460] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 13 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,460] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 13 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,460] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,461] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 11 for 4 partitions (state.change.logger)
[2022-05-03 18:13:26,461] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 16 (state.change.logger)
[2022-05-03 18:13:26,461] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 6 for 3 partitions (state.change.logger)
[2022-05-03 18:13:26,468] INFO [Broker id=4] Finished LeaderAndIsr request in 11ms correlationId 6 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:13:26,471] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 7 (state.change.logger)
[2022-05-03 18:13:26,500] INFO [Broker id=3] Finished LeaderAndIsr request in 44ms correlationId 11 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:13:26,503] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 12 (state.change.logger)
[2022-05-03 18:13:26,708] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 0 (state.change.logger)
[2022-05-03 18:13:26,729] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:13:26,756] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-4 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:26,759] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-5 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:26,759] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-0 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:26,759] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-2 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:26,759] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 14 for partition Sensor-1 (last update controller epoch 14) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:13:26,761] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:13:26,769] INFO [Broker id=5] Finished LeaderAndIsr request in 41ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:13:26,774] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 2 (state.change.logger)
[2022-05-03 18:13:26,777] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:13:26,781] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 14 as part of the become-leader transition for 5 partitions (state.change.logger)
[2022-05-03 18:13:26,787] INFO [Broker id=5] Leader Sensor-4 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,795] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,798] INFO [Broker id=5] Leader Sensor-0 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,802] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,804] INFO [Broker id=5] Leader Sensor-1 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:13:26,808] INFO [Broker id=5] Finished LeaderAndIsr request in 31ms correlationId 3 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:13:26,811] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 4 (state.change.logger)
[2022-05-03 18:13:27,795] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:13:27,797] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 13 (state.change.logger)
[2022-05-03 18:13:27,797] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 8 (state.change.logger)
[2022-05-03 18:13:27,797] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 17 (state.change.logger)
[2022-05-03 18:13:27,797] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 5 (state.change.logger)
[2022-05-03 18:13:27,807] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:13:27,809] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 18 (state.change.logger)
[2022-05-03 18:13:27,809] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 14 (state.change.logger)
[2022-05-03 18:13:27,809] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 9 (state.change.logger)
[2022-05-03 18:13:27,809] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 6 (state.change.logger)
[2022-05-03 18:13:28,303] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:13:28,305] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 19 (state.change.logger)
[2022-05-03 18:13:28,306] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 7 (state.change.logger)
[2022-05-03 18:13:28,306] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 15 (state.change.logger)
[2022-05-03 18:13:28,306] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 10 (state.change.logger)
[2022-05-03 18:13:28,312] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:13:28,314] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 20 (state.change.logger)
[2022-05-03 18:13:28,314] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 8 (state.change.logger)
[2022-05-03 18:13:28,315] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 16 (state.change.logger)
[2022-05-03 18:13:28,315] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 11 (state.change.logger)
[2022-05-03 18:13:28,321] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:13:28,323] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 21 (state.change.logger)
[2022-05-03 18:13:28,323] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 9 (state.change.logger)
[2022-05-03 18:13:28,323] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 17 (state.change.logger)
[2022-05-03 18:13:28,324] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 12 (state.change.logger)
[2022-05-03 18:15:08,219] INFO [Controller id=0 epoch=14] Changed partition Sensor-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0, 4), zkVersion=14) (state.change.logger)
[2022-05-03 18:15:08,226] INFO [Controller id=0 epoch=14] Changed partition Sensor-5 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=14, isr=List(4, 3), zkVersion=20) (state.change.logger)
[2022-05-03 18:15:08,226] INFO [Controller id=0 epoch=14] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=14, isr=List(3, 4), zkVersion=20) (state.change.logger)
[2022-05-03 18:15:08,226] INFO [Controller id=0 epoch=14] Changed partition Sensor-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(3, 0), zkVersion=14) (state.change.logger)
[2022-05-03 18:15:08,226] INFO [Controller id=0 epoch=14] Changed partition Sensor-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0, 3), zkVersion=14) (state.change.logger)
[2022-05-03 18:15:08,226] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,226] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,227] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,227] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,228] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 18 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:15:08,228] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 22 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,228] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:15:08,229] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 13 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,229] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:08,229] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was 13. (state.change.logger)
[2022-05-03 18:15:08,229] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,229] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 10 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:15:08,230] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was 13. (state.change.logger)
[2022-05-03 18:15:08,231] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 18 from controller 0 epoch 14 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:15:08,231] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 22 from controller 0 epoch 14 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,231] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 13 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,231] INFO [Broker id=3] Leader Sensor-5 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [4,3] addingReplicas [] removingReplicas []. Previous leader epoch was 13. (state.change.logger)
[2022-05-03 18:15:08,232] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,233] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was 13. (state.change.logger)
[2022-05-03 18:15:08,233] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,233] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was 13. (state.change.logger)
[2022-05-03 18:15:08,233] INFO [Broker id=5] Follower Sensor-1 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,234] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 10 for 5 partitions (state.change.logger)
[2022-05-03 18:15:08,235] INFO [Broker id=3] Leader Sensor-2 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [3,4] addingReplicas [] removingReplicas []. Previous leader epoch was 13. (state.change.logger)
[2022-05-03 18:15:08,239] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,239] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,242] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 18 for 2 partitions (state.change.logger)
[2022-05-03 18:15:08,243] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0,3] addingReplicas [] removingReplicas []. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,248] INFO [Broker id=5] Finished LeaderAndIsr request in 19ms correlationId 10 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:15:08,254] INFO [Controller id=0 epoch=14] Changed partition Sensor-5 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=15, isr=List(4), zkVersion=21) (state.change.logger)
[2022-05-03 18:15:08,254] INFO [Controller id=0 epoch=14] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=15, isr=List(4), zkVersion=21) (state.change.logger)
[2022-05-03 18:15:08,254] INFO [Controller id=0 epoch=14] Changed partition Sensor-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=11, isr=List(0, 4), zkVersion=15) (state.change.logger)
[2022-05-03 18:15:08,254] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,254] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,255] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,255] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,255] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,256] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:08,258] INFO [Broker id=4] Finished LeaderAndIsr request in 30ms correlationId 13 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,259] INFO [Controller id=0 epoch=14] Sending StopReplica request for 2 replicas to broker 3 (state.change.logger)
[2022-05-03 18:15:08,261] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 14 (state.change.logger)
[2022-05-03 18:15:08,263] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 15 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,263] INFO [Broker id=3] Finished LeaderAndIsr request in 36ms correlationId 18 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:15:08,264] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,266] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 19 (state.change.logger)
[2022-05-03 18:15:08,266] INFO [Controller id=0 epoch=14] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:08,267] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [3,0] addingReplicas [] removingReplicas []. Previous leader epoch was 9. (state.change.logger)
[2022-05-03 18:15:08,267] INFO [Controller id=0 epoch=14] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:08,267] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,268] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 20 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,268] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,268] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:15:08,268] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:15:08,268] INFO [Controller id=0 epoch=14] Sending StopReplica request for 2 replicas to broker 3 (state.change.logger)
[2022-05-03 18:15:08,269] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was 14. (state.change.logger)
[2022-05-03 18:15:08,269] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 15 from controller 0 epoch 14 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,269] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was 14. (state.change.logger)
[2022-05-03 18:15:08,269] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 20 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,273] INFO [Broker id=4] Leader Sensor-3 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:15:08,275] INFO [Broker id=3] Finished LeaderAndIsr request in 7ms correlationId 20 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,276] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,276] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,277] INFO [Controller id=0 epoch=14] Changed partition Sensor-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=12, isr=List(0), zkVersion=16) (state.change.logger)
[2022-05-03 18:15:08,277] INFO [Broker id=0] Finished LeaderAndIsr request in 49ms correlationId 22 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,277] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,277] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,278] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,278] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 21 (state.change.logger)
[2022-05-03 18:15:08,278] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,279] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 23 (state.change.logger)
[2022-05-03 18:15:08,279] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:08,280] INFO [Controller id=0 epoch=14] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2022-05-03 18:15:08,281] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 24 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,281] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:15:08,281] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 14. (state.change.logger)
[2022-05-03 18:15:08,281] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 24 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,284] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 24 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,284] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 14. (state.change.logger)
[2022-05-03 18:15:08,284] INFO [Controller id=0 epoch=14] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:08,285] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,285] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:15:08,285] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,285] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 25 (state.change.logger)
[2022-05-03 18:15:08,285] INFO [Controller id=0 epoch=14] Sending StopReplica request for 1 replicas to broker 4 (state.change.logger)
[2022-05-03 18:15:08,286] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 26 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:08,287] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 26 from controller 0 epoch 14 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:15:08,287] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:15:08,289] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,290] INFO [Broker id=4] Finished LeaderAndIsr request in 27ms correlationId 15 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:08,289] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,290] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,290] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:08,291] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:08,291] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:08,292] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 16 (state.change.logger)
[2022-05-03 18:15:08,293] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 26 from controller 0 epoch 14 for partition Sensor-4 (last update controller epoch 14) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:15:08,293] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:15:08,294] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 17 (state.change.logger)
[2022-05-03 18:15:08,295] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 18 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,295] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 12 from offset 0 with high watermark 0. Previous leader epoch was 11. (state.change.logger)
[2022-05-03 18:15:08,295] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 18 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,295] INFO [Broker id=4] Finished LeaderAndIsr request in 0ms correlationId 18 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,296] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 26 from controller 0 epoch 14 for partition Sensor-1 (last update controller epoch 14) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:15:08,297] INFO [Broker id=0] Finished LeaderAndIsr request in 11ms correlationId 26 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:08,297] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 19 (state.change.logger)
[2022-05-03 18:15:08,298] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 27 (state.change.logger)
[2022-05-03 18:15:08,299] INFO [Broker id=4] Handling StopReplica request correlationId 20 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,299] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 28 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,300] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 28 from controller 0 epoch 14 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,300] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 11. (state.change.logger)
[2022-05-03 18:15:08,302] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 20 epoch 14 for partition Sensor-0 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:08,303] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 28 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,304] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 29 (state.change.logger)
[2022-05-03 18:15:08,305] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 30 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,305] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 30 from controller 0 epoch 14 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,305] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:15:08,308] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 30 from controller 0 epoch 14 for partition Sensor-0 (last update controller epoch 14) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:15:08,308] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 30 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,309] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 21 (state.change.logger)
[2022-05-03 18:15:08,310] INFO [Broker id=4] Handling StopReplica request correlationId 22 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:15:08,310] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 31 (state.change.logger)
[2022-05-03 18:15:08,310] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 22 epoch 14 for partition Sensor-0 since its associated leader epoch 10 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,323] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:09,327] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,327] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,327] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,327] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,328] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,328] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,328] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:09,330] INFO [Controller id=0 epoch=14] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,331] INFO [Controller id=0 epoch=14] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,331] INFO [Controller id=0 epoch=14] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,331] INFO [Controller id=0 epoch=14] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,331] INFO [Controller id=0 epoch=14] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,331] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:09,331] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:15:09,331] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:15:09,332] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 5 partitions (state.change.logger)
[2022-05-03 18:15:09,333] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 32 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,333] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 32 epoch 14 for partition Sensor-4 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,333] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 32 epoch 14 for partition Sensor-0 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,333] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 32 epoch 14 for partition Sensor-1 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,333] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 23 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,333] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 32 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,334] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 33 (state.change.logger)
[2022-05-03 18:15:09,335] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 23 epoch 14 for partition Sensor-5 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,335] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 23 epoch 14 for partition Sensor-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,336] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was 10. (state.change.logger)
[2022-05-03 18:15:09,336] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 14 with correlation id 23 for 1 partitions (state.change.logger)
[2022-05-03 18:15:09,336] INFO [Broker id=4] Finished LeaderAndIsr request in 3ms correlationId 23 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,338] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 24 (state.change.logger)
[2022-05-03 18:15:09,339] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:09,343] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,343] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,343] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,343] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,343] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,343] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:09,343] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:09,345] INFO [Controller id=0 epoch=14] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,346] INFO [Controller id=0 epoch=14] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,346] INFO [Controller id=0 epoch=14] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,346] INFO [Controller id=0 epoch=14] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,346] INFO [Controller id=0 epoch=14] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:09,346] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:09,346] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:15:09,346] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 4) for 5 partitions (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 34 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 34 epoch 14 for partition Sensor-4 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 34 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 34 epoch 14 for partition Sensor-1 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 25 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 25 epoch 14 for partition Sensor-5 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 25 epoch 14 for partition Sensor-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 25 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:09,347] INFO [Broker id=0] Finished LeaderAndIsr request in 0ms correlationId 34 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,348] INFO [Broker id=4] Finished LeaderAndIsr request in 1ms correlationId 25 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:15:09,349] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 35 (state.change.logger)
[2022-05-03 18:15:09,349] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 26 (state.change.logger)
[2022-05-03 18:15:13,296] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:13,296] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:13,296] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:13,297] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:13,297] INFO [Controller id=0 epoch=14] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:15:13,298] INFO [Broker id=4] Handling StopReplica request correlationId 27 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:13,299] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 27 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:13,299] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 27 epoch 14 for partition Sensor-0 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:13,300] INFO [Controller id=0 epoch=14] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:13,300] INFO [Controller id=0 epoch=14] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:13,300] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:13,301] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:15:13,301] INFO [Controller id=0 epoch=14] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:15:13,302] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 36 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:13,302] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 36 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:13,302] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 36 epoch 14 for partition Sensor-0 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:13,302] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 28 (state.change.logger)
[2022-05-03 18:15:13,303] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 36 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:13,305] INFO [Broker id=4] Handling StopReplica request correlationId 29 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:13,305] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 29 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:13,305] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 29 epoch 14 for partition Sensor-0 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:13,305] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 37 (state.change.logger)
[2022-05-03 18:15:13,305] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:13,305] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:13,306] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:13,306] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:13,306] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:13,306] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:18,309] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:18,309] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:18,310] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:18,311] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:18,311] INFO [Controller id=0 epoch=14] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:15:18,312] INFO [Broker id=4] Handling StopReplica request correlationId 30 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:18,312] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 30 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:18,312] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 30 epoch 14 for partition Sensor-0 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:18,314] INFO [Controller id=0 epoch=14] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:18,314] INFO [Controller id=0 epoch=14] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:11,ZkVersion:15,ControllerEpoch:14) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:18,314] INFO [Controller id=0 epoch=14] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:18,314] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet(0, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:15:18,315] INFO [Controller id=0 epoch=14] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:15:18,315] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 38 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:18,316] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 38 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:18,316] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 38 epoch 14 for partition Sensor-0 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:18,316] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 31 (state.change.logger)
[2022-05-03 18:15:18,316] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 38 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:18,318] INFO [Broker id=4] Handling StopReplica request correlationId 32 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:15:18,318] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 32 epoch 14 for partition Sensor-3 since its associated leader epoch 12 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:18,318] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 32 epoch 14 for partition Sensor-0 since its associated leader epoch 11 matches the current leader epoch (state.change.logger)
[2022-05-03 18:15:18,318] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:18,318] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:18,318] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:18,318] ERROR [Controller id=0 epoch=14] Controller 0 epoch 14 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:18,319] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:18,319] INFO [Controller id=0 epoch=14] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:18,319] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 14 with correlation id 39 (state.change.logger)
[2022-05-03 18:15:19,521] INFO [Controller id=4 epoch=15] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:15:19,543] INFO [Controller id=4 epoch=15] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:15:19,546] INFO [Controller id=4 epoch=15] Sending UpdateMetadata request to brokers HashSet(4) for 4 partitions (state.change.logger)
[2022-05-03 18:15:19,570] INFO [Controller id=4 epoch=15] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,571] INFO [Controller id=4 epoch=15] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,571] INFO [Controller id=4 epoch=15] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,572] INFO [Controller id=4 epoch=15] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,576] INFO [Controller id=4 epoch=15] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,577] INFO [Controller id=4 epoch=15] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:15) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,577] INFO [Controller id=4 epoch=15] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:15) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,577] INFO [Controller id=4 epoch=15] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,578] INFO [Controller id=4 epoch=15] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,580] INFO [Controller id=4 epoch=15] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:15) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,581] INFO [Controller id=4 epoch=15] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:15) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,581] INFO [Controller id=4 epoch=15] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:15) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,581] INFO [Controller id=4 epoch=15] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,581] INFO [Controller id=4 epoch=15] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:12,ZkVersion:16,ControllerEpoch:15) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:19,581] INFO [Controller id=4 epoch=15] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:15:19,581] INFO [Controller id=4 epoch=15] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:15:19,601] ERROR [Controller id=4 epoch=15] Controller 4 epoch 15 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:19,602] ERROR [Controller id=4 epoch=15] Controller 4 epoch 15 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:19,602] ERROR [Controller id=4 epoch=15] Controller 4 epoch 15 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:19,602] ERROR [Controller id=4 epoch=15] Controller 4 epoch 15 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:19,603] INFO [Controller id=4 epoch=15] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:32,889] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:15:32,928] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:15:32,930] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3) for 5 partitions (state.change.logger)
[2022-05-03 18:15:32,957] INFO [Controller id=3 epoch=16] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,958] INFO [Controller id=3 epoch=16] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,958] INFO [Controller id=3 epoch=16] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,958] INFO [Controller id=3 epoch=16] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,964] INFO [Controller id=3 epoch=16] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,965] INFO [Controller id=3 epoch=16] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,965] INFO [Controller id=3 epoch=16] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:15,ZkVersion:21,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,965] INFO [Controller id=3 epoch=16] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,965] INFO [Controller id=3 epoch=16] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,969] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:15:32,976] INFO [Controller id=3 epoch=16] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:16) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,976] INFO [Controller id=3 epoch=16] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,976] INFO [Controller id=3 epoch=16] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:16) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,976] INFO [Controller id=3 epoch=16] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:16) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:15:32,976] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:15:32,977] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3) for 6 partitions (state.change.logger)
[2022-05-03 18:15:32,990] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-4 (last update controller epoch 15) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:32,996] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-3 (last update controller epoch 15) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:32,997] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-5 (last update controller epoch 14) but cannot become follower since the new leader 4 is unavailable. (state.change.logger)
[2022-05-03 18:15:32,998] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-2 (last update controller epoch 14) but cannot become follower since the new leader 4 is unavailable. (state.change.logger)
[2022-05-03 18:15:32,999] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-1 (last update controller epoch 15) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:33,000] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:15:33,006] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:33,008] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:33,009] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:33,010] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:33,010] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:33,011] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:33,012] INFO [Broker id=3] Finished LeaderAndIsr request in 45ms correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:15:33,013] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:33,024] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 2 (state.change.logger)
[2022-05-03 18:15:33,027] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:15:33,028] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 16 for partition Sensor-4 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:33,029] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 16 for partition Sensor-3 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:33,029] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 16 for partition Sensor-5 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:33,029] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 16 for partition Sensor-2 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:33,029] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 3 from controller 3 epoch 16 for partition Sensor-1 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:33,030] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:15:33,030] INFO [Broker id=3] Finished LeaderAndIsr request in 4ms correlationId 3 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:15:33,034] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 4 (state.change.logger)
[2022-05-03 18:15:37,687] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:15:37,689] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:15:37,693] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:15:37,693] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4) for 4 partitions (state.change.logger)
[2022-05-03 18:15:37,696] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 6 (state.change.logger)
[2022-05-03 18:15:37,705] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:37,706] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:37,706] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:37,706] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:37,707] INFO [Controller id=3 epoch=16] Changed partition Sensor-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=17, isr=List(4), zkVersion=23) (state.change.logger)
[2022-05-03 18:15:37,707] INFO [Controller id=3 epoch=16] Changed partition Sensor-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=17, isr=List(4), zkVersion=23) (state.change.logger)
[2022-05-03 18:15:37,707] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:15:37,708] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:15:37,708] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:15:37,709] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:15:37,714] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:15:37,715] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:15:37,716] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 7 for 2 partitions (state.change.logger)
[2022-05-03 18:15:37,757] INFO [Broker id=3] Finished LeaderAndIsr request in 48ms correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:15:37,761] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 8 (state.change.logger)
[2022-05-03 18:15:37,964] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 0 (state.change.logger)
[2022-05-03 18:15:37,984] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:15:38,008] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-3 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:38,013] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-5 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:38,013] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-0 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:38,013] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-2 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:38,015] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:15:38,024] INFO [Broker id=4] Finished LeaderAndIsr request in 40ms correlationId 1 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:15:38,030] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 2 (state.change.logger)
[2022-05-03 18:15:38,034] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:15:38,038] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 3 epoch 16 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:15:38,045] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:15:38,053] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:15:38,057] INFO [Broker id=4] Finished LeaderAndIsr request in 23ms correlationId 3 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:15:38,060] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 4 (state.change.logger)
[2022-05-03 18:15:39,063] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:15:39,065] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 9 (state.change.logger)
[2022-05-03 18:15:39,065] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 5 (state.change.logger)
[2022-05-03 18:15:39,076] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:15:39,077] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 10 (state.change.logger)
[2022-05-03 18:15:39,078] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 6 (state.change.logger)
[2022-05-03 18:15:42,767] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:15:42,768] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(5) for 6 partitions (state.change.logger)
[2022-05-03 18:15:42,770] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:15:42,771] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:15:42,773] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 12 (state.change.logger)
[2022-05-03 18:15:42,773] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 8 (state.change.logger)
[2022-05-03 18:15:42,776] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:42,777] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:42,777] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:42,778] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:15:42,778] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:15:43,006] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 0 (state.change.logger)
[2022-05-03 18:15:43,021] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:15:43,038] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-4 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:43,045] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:15:43,045] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-0 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:43,046] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:15:43,046] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 3 epoch 16 for partition Sensor-1 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:15:43,048] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 1 for 2 partitions (state.change.logger)
[2022-05-03 18:15:43,088] INFO [Broker id=5] Finished LeaderAndIsr request in 67ms correlationId 1 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:15:43,096] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:15:43,097] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 2 (state.change.logger)
[2022-05-03 18:15:43,098] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 13 (state.change.logger)
[2022-05-03 18:15:43,098] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 9 (state.change.logger)
[2022-05-03 18:15:43,101] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 3 (state.change.logger)
[2022-05-03 18:15:43,104] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:15:43,106] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 14 (state.change.logger)
[2022-05-03 18:15:43,106] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 10 (state.change.logger)
[2022-05-03 18:15:43,107] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 4 (state.change.logger)
[2022-05-03 18:17:41,359] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:41,360] INFO [Controller id=3 epoch=16] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:17:41,363] INFO [Broker id=3] Handling StopReplica request correlationId 15 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:17:41,365] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 15 epoch 16 for partition Sensor-5 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:41,365] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 15 epoch 16 for partition Sensor-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:41,368] INFO [Controller id=3 epoch=16] Partition Sensor-5 state changed to (Leader:4,ISR:4,5,LeaderEpoch:18,ZkVersion:26,ControllerEpoch:16) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,368] INFO [Controller id=3 epoch=16] Partition Sensor-2 state changed to (Leader:4,ISR:4,5,LeaderEpoch:18,ZkVersion:26,ControllerEpoch:16) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,368] INFO [Controller id=3 epoch=16] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:16) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,369] INFO [Controller id=3 epoch=16] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,369] INFO [Controller id=3 epoch=16] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,369] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,369] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,369] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:17:41,369] INFO [Controller id=3 epoch=16] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:17:41,370] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:17:41,370] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 5 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:17:41,371] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 5 from controller 3 epoch 16 for partition Sensor-4 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:41,371] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 3 epoch 16 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,371] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 17. (state.change.logger)
[2022-05-03 18:17:41,372] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 18 from offset 0 with high watermark 0. Previous leader epoch was 17. (state.change.logger)
[2022-05-03 18:17:41,372] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 18 from offset 0 with high watermark 0. Previous leader epoch was 17. (state.change.logger)
[2022-05-03 18:17:41,373] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 5 from controller 3 epoch 16 for partition Sensor-1 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:41,373] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 16 (state.change.logger)
[2022-05-03 18:17:41,375] INFO [Broker id=3] Handling StopReplica request correlationId 17 from controller 3 for 5 partitions (state.change.logger)
[2022-05-03 18:17:41,375] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 17 epoch 16 for partition Sensor-5 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:41,375] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 3 with correlation id 17 epoch 16 for partition Sensor-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:41,377] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 5 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,378] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 11 from controller 3 epoch 16 for partition Sensor-5 (last update controller epoch 16) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:17:41,378] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 17. (state.change.logger)
[2022-05-03 18:17:41,381] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 11 from controller 3 epoch 16 for partition Sensor-2 (last update controller epoch 16) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:17:41,381] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 11 from controller 3 epoch 16 for partition Sensor-3 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:41,381] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 11 for 0 partitions (state.change.logger)
[2022-05-03 18:17:41,382] INFO [Broker id=4] Finished LeaderAndIsr request in 12ms correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:17:41,385] INFO [Controller id=3 epoch=16] Changed partition Sensor-5 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=19, isr=List(5), zkVersion=27) (state.change.logger)
[2022-05-03 18:17:41,385] INFO [Controller id=3 epoch=16] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=19, isr=List(5), zkVersion=27) (state.change.logger)
[2022-05-03 18:17:41,385] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 12 (state.change.logger)
[2022-05-03 18:17:41,385] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,386] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,386] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,386] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,387] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:41,387] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 13 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,387] INFO [Controller id=3 epoch=16] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:17:41,390] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was 18. (state.change.logger)
[2022-05-03 18:17:41,391] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was 18. (state.change.logger)
[2022-05-03 18:17:41,391] INFO [Controller id=3 epoch=16] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:16) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,391] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 13 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,392] INFO [Controller id=3 epoch=16] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,392] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,392] INFO [Broker id=5] Finished LeaderAndIsr request in 22ms correlationId 5 from controller 3 for 4 partitions (state.change.logger)
[2022-05-03 18:17:41,393] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,393] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,394] INFO [Controller id=3 epoch=16] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:17:41,395] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 6 (state.change.logger)
[2022-05-03 18:17:41,398] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,399] INFO [Broker id=4] Finished LeaderAndIsr request in 12ms correlationId 13 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,399] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:41,400] ERROR [Controller id=3 epoch=16] Controller 3 epoch 16 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:41,400] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:41,400] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:41,400] INFO [Controller id=3 epoch=16] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:17:41,401] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 14 (state.change.logger)
[2022-05-03 18:17:41,402] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 3 epoch 16 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,405] INFO [Broker id=4] Handling StopReplica request correlationId 15 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,406] INFO [Controller id=3 epoch=16] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,406] INFO [Controller id=3 epoch=16] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,406] INFO [Controller id=3 epoch=16] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:13,ZkVersion:17,ControllerEpoch:16) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:41,407] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,407] INFO [Controller id=3 epoch=16] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:17:41,407] INFO [Controller id=3 epoch=16] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:17:41,408] INFO [Controller id=3 epoch=16] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:17:41,408] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 18. (state.change.logger)
[2022-05-03 18:17:41,413] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 16 (state.change.logger)
[2022-05-03 18:17:41,414] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 18. (state.change.logger)
[2022-05-03 18:17:41,414] INFO [Broker id=4] Handling StopReplica request correlationId 17 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,417] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 18 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:17:41,417] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 18 from controller 3 epoch 16 for partition Sensor-0 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:41,417] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 18 for 0 partitions (state.change.logger)
[2022-05-03 18:17:41,417] INFO [Broker id=5] Finished LeaderAndIsr request in 19ms correlationId 7 from controller 3 for 2 partitions (state.change.logger)
[2022-05-03 18:17:41,417] INFO [Broker id=4] Finished LeaderAndIsr request in 0ms correlationId 18 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:17:41,419] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 19 (state.change.logger)
[2022-05-03 18:17:41,420] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 8 (state.change.logger)
[2022-05-03 18:17:41,421] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:17:41,421] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 9 from controller 3 epoch 16 for partition Sensor-0 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:41,421] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 3 epoch 16 with correlation id 9 for 0 partitions (state.change.logger)
[2022-05-03 18:17:41,422] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 9 from controller 3 for 1 partitions (state.change.logger)
[2022-05-03 18:17:41,424] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 10 (state.change.logger)
[2022-05-03 18:17:41,426] INFO [Broker id=5] Handling StopReplica request correlationId 11 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:17:41,433] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 3 epoch 16 with correlation id 12 (state.change.logger)
[2022-05-03 18:17:41,434] INFO [Broker id=5] Handling StopReplica request correlationId 13 from controller 3 for 3 partitions (state.change.logger)
[2022-05-03 18:17:42,696] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(4, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:17:42,721] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:17:42,724] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:17:42,724] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:17:42,726] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:17:42,726] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:17:42,727] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,728] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,728] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 17 for partition Sensor-4 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,728] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,728] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 17 for partition Sensor-0 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,728] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 17 for partition Sensor-1 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,728] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,728] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 17 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:17:42,728] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 17 for partition Sensor-3 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,728] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 5 epoch 17 for partition Sensor-0 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,728] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 5 epoch 17 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:17:42,728] INFO [Broker id=5] Finished LeaderAndIsr request in 2ms correlationId 1 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:17:42,729] INFO [Broker id=4] Finished LeaderAndIsr request in 2ms correlationId 1 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:17:42,732] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 2 (state.change.logger)
[2022-05-03 18:17:42,732] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 2 (state.change.logger)
[2022-05-03 18:17:42,746] INFO [Controller id=5 epoch=17] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,747] INFO [Controller id=5 epoch=17] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,747] INFO [Controller id=5 epoch=17] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,748] INFO [Controller id=5 epoch=17] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,752] INFO [Controller id=5 epoch=17] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,752] INFO [Controller id=5 epoch=17] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,753] INFO [Controller id=5 epoch=17] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,753] INFO [Controller id=5 epoch=17] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,753] INFO [Controller id=5 epoch=17] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:42,753] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:17:42,753] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:17:42,753] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:42,755] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 17 for partition Sensor-4 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,755] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 17 for partition Sensor-3 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,755] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 17 for partition Sensor-0 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,755] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 17 for partition Sensor-1 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,755] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 3 from controller 5 epoch 17 for partition Sensor-0 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 17 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 5 epoch 17 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:17:42,755] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 5 for 5 partitions (state.change.logger)
[2022-05-03 18:17:42,756] INFO [Broker id=4] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:17:42,758] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 4 (state.change.logger)
[2022-05-03 18:17:42,758] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 4 (state.change.logger)
[2022-05-03 18:17:42,776] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,777] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,777] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,777] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:42,778] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:46,405] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:46,406] INFO [Controller id=5 epoch=17] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:17:46,408] INFO [Broker id=4] Handling StopReplica request correlationId 5 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:17:46,409] INFO [Controller id=5 epoch=17] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:46,409] INFO [Controller id=5 epoch=17] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:46,409] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 5 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:46,410] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 5 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:46,410] INFO [Controller id=5 epoch=17] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:46,410] INFO [Controller id=5 epoch=17] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:46,410] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:17:46,410] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:17:46,410] INFO [Controller id=5 epoch=17] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:17:46,412] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 5 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:46,412] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:46,412] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:46,412] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 5 from controller 5 epoch 17 for partition Sensor-0 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:46,412] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 17 with correlation id 5 for 0 partitions (state.change.logger)
[2022-05-03 18:17:46,413] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 5 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:46,414] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 6 (state.change.logger)
[2022-05-03 18:17:46,415] INFO [Broker id=4] Handling StopReplica request correlationId 7 from controller 5 for 4 partitions (state.change.logger)
[2022-05-03 18:17:46,415] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:46,415] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:46,415] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 6 (state.change.logger)
[2022-05-03 18:17:46,418] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:46,419] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:46,419] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:46,420] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:46,420] INFO [Controller id=5 epoch=17] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:17:46,421] INFO [Broker id=5] Handling StopReplica request correlationId 7 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:46,422] INFO [Controller id=5 epoch=17] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:46,423] INFO [Controller id=5 epoch=17] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:46,423] INFO [Controller id=5 epoch=17] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:46,423] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:17:46,424] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:17:46,424] INFO [Controller id=5 epoch=17] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:17:46,426] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 8 (state.change.logger)
[2022-05-03 18:17:46,428] INFO [Broker id=5] Handling StopReplica request correlationId 9 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:47,599] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:47,604] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,604] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,604] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,604] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,605] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,605] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:47,605] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:47,607] INFO [Controller id=5 epoch=17] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:47,608] INFO [Controller id=5 epoch=17] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:19,ZkVersion:27,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:47,608] INFO [Controller id=5 epoch=17] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:47,608] INFO [Controller id=5 epoch=17] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:47,608] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:17:47,608] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(5) for 4 partitions (state.change.logger)
[2022-05-03 18:17:47,610] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 10 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:47,610] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 10 epoch 17 for partition Sensor-5 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:47,610] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 10 epoch 17 for partition Sensor-2 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:47,610] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 10 from controller 5 epoch 17 for partition Sensor-0 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:17:47,610] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 5 epoch 17 with correlation id 10 for 0 partitions (state.change.logger)
[2022-05-03 18:17:47,610] INFO [Broker id=5] Finished LeaderAndIsr request in 0ms correlationId 10 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:47,612] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 11 (state.change.logger)
[2022-05-03 18:17:51,430] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:51,430] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:51,431] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:51,431] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:51,431] INFO [Controller id=5 epoch=17] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:17:51,432] INFO [Broker id=5] Handling StopReplica request correlationId 12 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:51,434] INFO [Controller id=5 epoch=17] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:51,434] INFO [Controller id=5 epoch=17] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:51,434] INFO [Controller id=5 epoch=17] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:14,ZkVersion:18,ControllerEpoch:17) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:51,435] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(5) for 3 partitions (state.change.logger)
[2022-05-03 18:17:51,435] INFO [Controller id=5 epoch=17] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:17:51,437] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 13 (state.change.logger)
[2022-05-03 18:17:51,439] INFO [Broker id=5] Handling StopReplica request correlationId 14 from controller 5 for 3 partitions (state.change.logger)
[2022-05-03 18:17:52,368] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:17:52,369] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(0) for 6 partitions (state.change.logger)
[2022-05-03 18:17:52,371] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:17:52,371] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,385] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:52,385] ERROR [Controller id=5 epoch=17] Controller 5 epoch 17 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:52,387] INFO [Controller id=5 epoch=17] Changed partition Sensor-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), zkVersion=19) (state.change.logger)
[2022-05-03 18:17:52,387] INFO [Controller id=5 epoch=17] Changed partition Sensor-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=16, isr=List(0), zkVersion=20) (state.change.logger)
[2022-05-03 18:17:52,387] INFO [Controller id=5 epoch=17] Changed partition Sensor-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), zkVersion=19) (state.change.logger)
[2022-05-03 18:17:52,387] INFO [Controller id=5 epoch=17] Changed partition Sensor-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), zkVersion=19) (state.change.logger)
[2022-05-03 18:17:52,387] INFO [Controller id=5 epoch=17] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:17:52,387] INFO [Controller id=5 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,568] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:17:52,608] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:17:52,611] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0) for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,634] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 17 with correlation id 0 (state.change.logger)
[2022-05-03 18:17:52,646] INFO [Controller id=0 epoch=18] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,648] INFO [Controller id=0 epoch=18] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,649] INFO [Controller id=0 epoch=18] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,649] INFO [Controller id=0 epoch=18] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,649] INFO [Controller id=0 epoch=18] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,654] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,656] INFO [Controller id=0 epoch=18] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,657] INFO [Controller id=0 epoch=18] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,657] INFO [Controller id=0 epoch=18] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:16,ZkVersion:20,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,657] INFO [Controller id=0 epoch=18] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,657] INFO [Controller id=0 epoch=18] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,660] INFO [Controller id=0 epoch=18] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,660] INFO [Controller id=0 epoch=18] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,660] INFO [Controller id=0 epoch=18] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:16,ZkVersion:20,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,660] INFO [Controller id=0 epoch=18] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:15,ZkVersion:19,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:17:52,661] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:17:52,661] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0) for 6 partitions (state.change.logger)
[2022-05-03 18:17:52,676] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 18 as part of the become-leader transition for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,688] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:52,689] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:17:52,692] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:17:52,693] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:17:52,699] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:17:52,701] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:17:52,705] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:17:52,721] INFO [Broker id=0] Finished LeaderAndIsr request in 69ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,727] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 2 (state.change.logger)
[2022-05-03 18:17:52,730] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,731] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 18 for partition Sensor-4 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:52,731] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 18 for partition Sensor-3 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:52,731] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 18 for partition Sensor-0 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:52,731] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 3 epoch 18 for partition Sensor-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:17:52,732] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:17:52,736] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 4 (state.change.logger)
[2022-05-03 18:18:07,309] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:18:07,311] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(3) for 6 partitions (state.change.logger)
[2022-05-03 18:18:07,316] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:18:07,316] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3) for 5 partitions (state.change.logger)
[2022-05-03 18:18:07,319] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 6 (state.change.logger)
[2022-05-03 18:18:07,322] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:07,322] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:07,323] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:07,551] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 0 (state.change.logger)
[2022-05-03 18:18:07,574] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:18:07,604] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:07,605] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:07,606] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 18 for partition Sensor-5 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:18:07,606] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 18 for partition Sensor-2 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:18:07,607] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:07,609] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:18:07,653] INFO [Broker id=3] Finished LeaderAndIsr request in 79ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:18:07,659] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 2 (state.change.logger)
[2022-05-03 18:18:07,704] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3) for 1 partitions (state.change.logger)
[2022-05-03 18:18:07,706] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 7 (state.change.logger)
[2022-05-03 18:18:07,706] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 3 (state.change.logger)
[2022-05-03 18:18:07,720] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3) for 2 partitions (state.change.logger)
[2022-05-03 18:18:07,722] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 8 (state.change.logger)
[2022-05-03 18:18:07,723] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 4 (state.change.logger)
[2022-05-03 18:18:12,326] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:18:12,327] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:18:12,329] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:18:12,329] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 4 partitions (state.change.logger)
[2022-05-03 18:18:12,332] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 10 (state.change.logger)
[2022-05-03 18:18:12,332] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 6 (state.change.logger)
[2022-05-03 18:18:12,335] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:12,336] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:12,336] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:12,568] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 0 (state.change.logger)
[2022-05-03 18:18:12,586] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:18:12,619] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:12,620] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 18 for partition Sensor-5 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:18:12,621] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:12,621] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 18 for partition Sensor-2 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:18:12,624] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 1 for 2 partitions (state.change.logger)
[2022-05-03 18:18:12,672] INFO [Broker id=4] Finished LeaderAndIsr request in 86ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:18:12,676] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 2 (state.change.logger)
[2022-05-03 18:18:12,678] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:18:12,680] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 11 (state.change.logger)
[2022-05-03 18:18:12,680] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 3 (state.change.logger)
[2022-05-03 18:18:12,680] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 7 (state.change.logger)
[2022-05-03 18:18:12,685] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:18:12,687] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 12 (state.change.logger)
[2022-05-03 18:18:12,687] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 8 (state.change.logger)
[2022-05-03 18:18:12,687] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 4 (state.change.logger)
[2022-05-03 18:18:17,348] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:18:17,350] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(5) for 6 partitions (state.change.logger)
[2022-05-03 18:18:17,352] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:18:17,352] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:18:17,354] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 14 (state.change.logger)
[2022-05-03 18:18:17,355] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 10 (state.change.logger)
[2022-05-03 18:18:17,355] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 6 (state.change.logger)
[2022-05-03 18:18:17,362] INFO [Controller id=0 epoch=18] Changed partition Sensor-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=21, isr=List(5), zkVersion=29) (state.change.logger)
[2022-05-03 18:18:17,362] INFO [Controller id=0 epoch=18] Changed partition Sensor-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=21, isr=List(5), zkVersion=29) (state.change.logger)
[2022-05-03 18:18:17,362] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:17,363] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:17,363] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:17,363] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,364] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,365] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,365] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 15 (state.change.logger)
[2022-05-03 18:18:17,366] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,366] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,366] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,366] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,368] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 7 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,369] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 11 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,375] INFO [Broker id=4] Finished LeaderAndIsr request in 10ms correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,375] INFO [Broker id=3] Finished LeaderAndIsr request in 11ms correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,379] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 8 (state.change.logger)
[2022-05-03 18:18:17,379] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 12 (state.change.logger)
[2022-05-03 18:18:17,605] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 0 (state.change.logger)
[2022-05-03 18:18:17,623] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:18:17,656] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,657] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 18 for partition Sensor-5 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:18:17,657] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,657] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 18 for partition Sensor-2 (last update controller epoch 18) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:18:17,658] INFO [Broker id=5] Follower Sensor-1 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,660] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:18:17,697] INFO [Broker id=5] Finished LeaderAndIsr request in 74ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:18:17,703] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 2 (state.change.logger)
[2022-05-03 18:18:17,705] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,708] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:18:17,710] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 16 (state.change.logger)
[2022-05-03 18:18:17,710] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 9 (state.change.logger)
[2022-05-03 18:18:17,710] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 13 (state.change.logger)
[2022-05-03 18:18:17,713] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 18 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,717] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,717] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,720] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 17 (state.change.logger)
[2022-05-03 18:18:17,720] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 10 (state.change.logger)
[2022-05-03 18:18:17,720] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 14 (state.change.logger)
[2022-05-03 18:18:17,726] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:18:17,728] INFO [Broker id=5] Finished LeaderAndIsr request in 23ms correlationId 3 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:17,731] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 4 (state.change.logger)
[2022-05-03 18:18:17,733] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 5 (state.change.logger)
[2022-05-03 18:18:17,735] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 6 (state.change.logger)
[2022-05-03 18:18:18,681] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:18:18,683] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 18 (state.change.logger)
[2022-05-03 18:18:18,683] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 15 (state.change.logger)
[2022-05-03 18:18:18,683] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 11 (state.change.logger)
[2022-05-03 18:18:18,683] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 7 (state.change.logger)
[2022-05-03 18:18:18,692] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:18:18,694] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 19 (state.change.logger)
[2022-05-03 18:18:18,694] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 12 (state.change.logger)
[2022-05-03 18:18:18,694] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 16 (state.change.logger)
[2022-05-03 18:18:18,695] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 8 (state.change.logger)
[2022-05-03 18:18:19,193] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:18:19,195] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 20 (state.change.logger)
[2022-05-03 18:18:19,195] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 9 (state.change.logger)
[2022-05-03 18:18:19,196] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 17 (state.change.logger)
[2022-05-03 18:18:19,196] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 13 (state.change.logger)
[2022-05-03 18:18:19,201] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:18:19,203] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 21 (state.change.logger)
[2022-05-03 18:18:19,204] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 14 (state.change.logger)
[2022-05-03 18:18:19,204] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 10 (state.change.logger)
[2022-05-03 18:18:19,204] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 18 (state.change.logger)
[2022-05-03 18:18:32,062] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:32,064] INFO [Controller id=0 epoch=18] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:18:32,067] INFO [Broker id=3] Handling StopReplica request correlationId 19 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:18:32,070] INFO [Controller id=0 epoch=18] Partition Sensor-5 state changed to (Leader:5,ISR:5,4,LeaderEpoch:22,ZkVersion:32,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,070] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 19 epoch 18 for partition Sensor-4 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,070] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 19 epoch 18 for partition Sensor-5 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,070] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 19 epoch 18 for partition Sensor-2 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,070] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 19 epoch 18 for partition Sensor-3 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,070] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 19 epoch 18 for partition Sensor-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,071] INFO [Controller id=0 epoch=18] Partition Sensor-2 state changed to (Leader:5,ISR:5,4,LeaderEpoch:22,ZkVersion:32,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,071] INFO [Controller id=0 epoch=18] Partition Sensor-3 state changed to (Leader:0,ISR:0,4,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,071] INFO [Controller id=0 epoch=18] Partition Sensor-1 state changed to (Leader:0,ISR:0,5,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,071] INFO [Controller id=0 epoch=18] Partition Sensor-4 state changed to (Leader:0,ISR:0,5,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,071] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,072] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,072] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,072] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:18:32,072] INFO [Controller id=0 epoch=18] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:18:32,073] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 22 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,073] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 11 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:18:32,073] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 15 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,074] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 22 from controller 0 epoch 18 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,074] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 0 epoch 18 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,074] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was 16. (state.change.logger)
[2022-05-03 18:18:32,074] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 22 from offset 0 with high watermark 0 ISR [5,4] addingReplicas [] removingReplicas []. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:18:32,074] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [0,5] addingReplicas [] removingReplicas []. Previous leader epoch was 15. (state.change.logger)
[2022-05-03 18:18:32,075] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:18:32,075] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:18:32,077] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 15 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,080] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 22 from controller 0 epoch 18 for partition Sensor-4 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,081] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 16. (state.change.logger)
[2022-05-03 18:18:32,081] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 11 from controller 0 epoch 18 for partition Sensor-5 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,081] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 22 from offset 0 with high watermark 0 ISR [5,4] addingReplicas [] removingReplicas []. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:18:32,082] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 20 (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 22 from controller 0 epoch 18 for partition Sensor-3 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=3] Handling StopReplica request correlationId 21 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 21 epoch 18 for partition Sensor-4 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 21 epoch 18 for partition Sensor-5 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 21 epoch 18 for partition Sensor-2 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 21 epoch 18 for partition Sensor-3 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 21 epoch 18 for partition Sensor-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,084] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [0,5] addingReplicas [] removingReplicas []. Previous leader epoch was 15. (state.change.logger)
[2022-05-03 18:18:32,085] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 11 from controller 0 epoch 18 for partition Sensor-2 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,087] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was 15. (state.change.logger)
[2022-05-03 18:18:32,087] INFO [Broker id=5] Follower Sensor-1 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was 15. (state.change.logger)
[2022-05-03 18:18:32,088] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 22 from controller 0 epoch 18 for partition Sensor-1 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,088] INFO [Broker id=0] Finished LeaderAndIsr request in 15ms correlationId 22 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,088] INFO [Controller id=0 epoch=18] Changed partition Sensor-5 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=23, isr=List(4), zkVersion=33) (state.change.logger)
[2022-05-03 18:18:32,088] INFO [Controller id=0 epoch=18] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=23, isr=List(4), zkVersion=33) (state.change.logger)
[2022-05-03 18:18:32,088] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 11 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,088] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,089] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,089] INFO [Broker id=5] Finished LeaderAndIsr request in 16ms correlationId 11 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:18:32,089] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,089] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,089] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:32,090] INFO [Controller id=0 epoch=18] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:18:32,090] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 22 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,090] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 23 (state.change.logger)
[2022-05-03 18:18:32,091] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:18:32,092] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:18:32,093] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 12 (state.change.logger)
[2022-05-03 18:18:32,094] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 24 (state.change.logger)
[2022-05-03 18:18:32,095] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,096] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 22 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,096] INFO [Broker id=4] Finished LeaderAndIsr request in 23ms correlationId 15 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,096] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was 22. (state.change.logger)
[2022-05-03 18:18:32,096] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was 22. (state.change.logger)
[2022-05-03 18:18:32,097] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 13 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,098] INFO [Controller id=0 epoch=18] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,099] INFO [Controller id=0 epoch=18] Partition Sensor-0 state changed to (Leader:0,ISR:0,4,LeaderEpoch:16,ZkVersion:22,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,099] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 16 (state.change.logger)
[2022-05-03 18:18:32,099] INFO [Controller id=0 epoch=18] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,099] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,100] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,100] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,100] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,100] INFO [Controller id=0 epoch=18] Sending StopReplica request for 3 replicas to broker 5 (state.change.logger)
[2022-05-03 18:18:32,101] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 25 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,101] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 17 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,102] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 25 from controller 0 epoch 18 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,102] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 16. (state.change.logger)
[2022-05-03 18:18:32,103] INFO [Broker id=5] Finished LeaderAndIsr request in 8ms correlationId 13 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,104] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,104] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,105] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:32,105] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:32,105] INFO [Controller id=0 epoch=18] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:18:32,106] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 25 from controller 0 epoch 18 for partition Sensor-4 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,106] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 14 (state.change.logger)
[2022-05-03 18:18:32,107] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 17 from controller 0 epoch 18 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,107] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 15. (state.change.logger)
[2022-05-03 18:18:32,108] INFO [Broker id=3] Finished LeaderAndIsr request in 18ms correlationId 22 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,110] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 25 from controller 0 epoch 18 for partition Sensor-0 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,110] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 16. (state.change.logger)
[2022-05-03 18:18:32,111] INFO [Broker id=5] Handling StopReplica request correlationId 15 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,112] INFO [Controller id=0 epoch=18] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,112] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 23 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 22. (state.change.logger)
[2022-05-03 18:18:32,112] INFO [Controller id=0 epoch=18] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:32,113] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,113] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 25 from controller 0 epoch 18 for partition Sensor-1 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,113] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,114] INFO [Broker id=0] Finished LeaderAndIsr request in 13ms correlationId 25 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:32,114] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:18:32,114] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,115] INFO [Controller id=0 epoch=18] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:18:32,116] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 26 (state.change.logger)
[2022-05-03 18:18:32,117] INFO [Broker id=5] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 15 epoch 18 for partition Sensor-4 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,117] INFO [Broker id=5] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 15 epoch 18 for partition Sensor-0 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,117] INFO [Broker id=5] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 15 epoch 18 for partition Sensor-1 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,118] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 27 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,119] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,119] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 27 from controller 0 epoch 18 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,120] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,120] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 17. (state.change.logger)
[2022-05-03 18:18:32,120] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,120] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:32,121] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:32,121] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:32,122] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 23 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 22. (state.change.logger)
[2022-05-03 18:18:32,123] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 27 from controller 0 epoch 18 for partition Sensor-3 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,123] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 16. (state.change.logger)
[2022-05-03 18:18:32,125] INFO [Broker id=4] Finished LeaderAndIsr request in 24ms correlationId 17 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,126] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 27 from controller 0 epoch 18 for partition Sensor-0 (last update controller epoch 18) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:18:32,127] INFO [Broker id=0] Finished LeaderAndIsr request in 9ms correlationId 27 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,128] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 18 (state.change.logger)
[2022-05-03 18:18:32,129] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 28 (state.change.logger)
[2022-05-03 18:18:32,129] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 19 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:18:32,130] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was 15. (state.change.logger)
[2022-05-03 18:18:32,131] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 19 for 1 partitions (state.change.logger)
[2022-05-03 18:18:32,133] INFO [Broker id=4] Finished LeaderAndIsr request in 4ms correlationId 19 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:18:32,135] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 20 (state.change.logger)
[2022-05-03 18:18:32,138] INFO [Broker id=4] Handling StopReplica request correlationId 21 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,142] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 21 epoch 18 for partition Sensor-3 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,142] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 21 epoch 18 for partition Sensor-0 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,149] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 22 (state.change.logger)
[2022-05-03 18:18:32,152] INFO [Broker id=4] Handling StopReplica request correlationId 23 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:32,152] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 18 for partition Sensor-3 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:32,152] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 18 for partition Sensor-0 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,321] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:33,325] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,326] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,326] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,326] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,326] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,326] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,327] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:18:33,330] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 5 partitions (state.change.logger)
[2022-05-03 18:18:33,332] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 29 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,332] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 29 epoch 18 for partition Sensor-4 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,332] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 29 epoch 18 for partition Sensor-0 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,332] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 29 epoch 18 for partition Sensor-1 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,332] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 24 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,332] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 29 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,333] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 24 epoch 18 for partition Sensor-5 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,333] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 24 epoch 18 for partition Sensor-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,333] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was 16. (state.change.logger)
[2022-05-03 18:18:33,333] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 24 for 1 partitions (state.change.logger)
[2022-05-03 18:18:33,334] INFO [Broker id=4] Finished LeaderAndIsr request in 2ms correlationId 24 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,334] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 30 (state.change.logger)
[2022-05-03 18:18:33,336] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 25 (state.change.logger)
[2022-05-03 18:18:33,480] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:33,483] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,484] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,485] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,485] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,485] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,485] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:623)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:593)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1617)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:33,486] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:33,489] INFO [Controller id=0 epoch=18] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,489] INFO [Controller id=0 epoch=18] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,489] INFO [Controller id=0 epoch=18] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,489] INFO [Controller id=0 epoch=18] Partition Sensor-1 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,489] INFO [Controller id=0 epoch=18] Partition Sensor-4 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:33,489] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:33,490] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:18:33,490] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 4) for 5 partitions (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 31 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 26 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 31 epoch 18 for partition Sensor-4 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 31 epoch 18 for partition Sensor-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 31 epoch 18 for partition Sensor-1 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 26 epoch 18 for partition Sensor-5 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 0 with correlation id 26 epoch 18 for partition Sensor-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=0] Finished LeaderAndIsr request in 0ms correlationId 31 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,491] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 18 from offset 0 with high watermark 0. Previous leader epoch was 17. (state.change.logger)
[2022-05-03 18:18:33,492] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 18 with correlation id 26 for 1 partitions (state.change.logger)
[2022-05-03 18:18:33,492] INFO [Broker id=4] Finished LeaderAndIsr request in 1ms correlationId 26 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:18:33,493] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 32 (state.change.logger)
[2022-05-03 18:18:33,494] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 27 (state.change.logger)
[2022-05-03 18:18:37,122] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:37,123] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:37,123] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:37,123] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:37,123] INFO [Controller id=0 epoch=18] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:18:37,125] INFO [Broker id=4] Handling StopReplica request correlationId 28 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:37,125] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 28 epoch 18 for partition Sensor-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:37,125] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 28 epoch 18 for partition Sensor-0 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:37,125] INFO [Controller id=0 epoch=18] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:37,126] INFO [Controller id=0 epoch=18] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:37,126] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:37,127] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:18:37,127] INFO [Controller id=0 epoch=18] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:18:37,128] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 33 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:37,128] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 33 epoch 18 for partition Sensor-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:37,128] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 33 epoch 18 for partition Sensor-0 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:37,129] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 29 (state.change.logger)
[2022-05-03 18:18:37,129] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 33 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:37,131] INFO [Broker id=4] Handling StopReplica request correlationId 30 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:37,131] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 30 epoch 18 for partition Sensor-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:37,131] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 30 epoch 18 for partition Sensor-0 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:37,131] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 34 (state.change.logger)
[2022-05-03 18:18:37,132] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:37,132] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:37,133] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:37,133] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:37,133] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:37,133] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:42,133] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:42,133] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:42,134] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:42,134] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:42,134] INFO [Controller id=0 epoch=18] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:18:42,135] INFO [Broker id=4] Handling StopReplica request correlationId 31 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:42,135] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 31 epoch 18 for partition Sensor-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:42,136] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 31 epoch 18 for partition Sensor-0 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:42,136] INFO [Controller id=0 epoch=18] Partition Sensor-3 state changed to (Leader:0,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:42,136] INFO [Controller id=0 epoch=18] Partition Sensor-0 state changed to (Leader:0,ISR:0,LeaderEpoch:17,ZkVersion:23,ControllerEpoch:18) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:42,136] INFO [Controller id=0 epoch=18] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:18:42,137] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet(0, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:18:42,137] INFO [Controller id=0 epoch=18] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:18:42,137] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 35 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:42,138] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 35 epoch 18 for partition Sensor-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:42,138] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 35 epoch 18 for partition Sensor-0 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:42,138] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 32 (state.change.logger)
[2022-05-03 18:18:42,139] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 35 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:42,140] INFO [Broker id=4] Handling StopReplica request correlationId 33 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:18:42,140] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 33 epoch 18 for partition Sensor-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:42,140] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 33 epoch 18 for partition Sensor-0 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2022-05-03 18:18:42,141] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:42,141] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 18 with correlation id 36 (state.change.logger)
[2022-05-03 18:18:42,141] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:42,141] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:42,142] ERROR [Controller id=0 epoch=18] Controller 0 epoch 18 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:42,142] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:42,142] INFO [Controller id=0 epoch=18] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:18:43,244] INFO [Controller id=4 epoch=19] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:18:43,265] INFO [Controller id=4 epoch=19] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:43,266] INFO [Controller id=4 epoch=19] Sending UpdateMetadata request to brokers HashSet(4) for 4 partitions (state.change.logger)
[2022-05-03 18:18:43,287] INFO [Controller id=4 epoch=19] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,288] INFO [Controller id=4 epoch=19] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:19,ZkVersion:25,ControllerEpoch:19) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,288] INFO [Controller id=4 epoch=19] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,288] INFO [Controller id=4 epoch=19] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,292] INFO [Controller id=4 epoch=19] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,293] INFO [Controller id=4 epoch=19] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:19) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,293] INFO [Controller id=4 epoch=19] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:19) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,293] INFO [Controller id=4 epoch=19] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,293] INFO [Controller id=4 epoch=19] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,296] INFO [Controller id=4 epoch=19] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,297] INFO [Controller id=4 epoch=19] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,297] INFO [Controller id=4 epoch=19] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:19,ZkVersion:25,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,297] INFO [Controller id=4 epoch=19] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,297] INFO [Controller id=4 epoch=19] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:19) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:18:43,297] INFO [Controller id=4 epoch=19] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:18:43,297] INFO [Controller id=4 epoch=19] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:18:43,320] ERROR [Controller id=4 epoch=19] Controller 4 epoch 19 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:43,321] ERROR [Controller id=4 epoch=19] Controller 4 epoch 19 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:43,321] ERROR [Controller id=4 epoch=19] Controller 4 epoch 19 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:43,321] ERROR [Controller id=4 epoch=19] Controller 4 epoch 19 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:18:43,322] INFO [Controller id=4 epoch=19] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:19:02,610] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:19:02,649] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:19:02,651] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0) for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,670] INFO [Controller id=0 epoch=20] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:20) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,671] INFO [Controller id=0 epoch=20] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:20) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,671] INFO [Controller id=0 epoch=20] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:20) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,671] INFO [Controller id=0 epoch=20] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:20) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,672] INFO [Controller id=0 epoch=20] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:20) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,678] INFO [Controller id=0 epoch=20] Partition Sensor-5 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,678] INFO [Controller id=0 epoch=20] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:23,ZkVersion:33,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,678] INFO [Controller id=0 epoch=20] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:19,ZkVersion:25,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,678] INFO [Controller id=0 epoch=20] Partition Sensor-1 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,679] INFO [Controller id=0 epoch=20] Partition Sensor-4 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,688] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,694] INFO [Controller id=0 epoch=20] Partition Sensor-3 state changed to (Leader:-1,ISR:0,LeaderEpoch:19,ZkVersion:25,ControllerEpoch:20) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,694] INFO [Controller id=0 epoch=20] Partition Sensor-0 state changed to (Leader:-1,ISR:0,LeaderEpoch:18,ZkVersion:24,ControllerEpoch:20) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,695] INFO [Controller id=0 epoch=20] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:24,ZkVersion:34,ControllerEpoch:20) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,695] INFO [Controller id=0 epoch=20] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:24,ZkVersion:34,ControllerEpoch:20) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:19:02,695] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:19:02,696] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0) for 6 partitions (state.change.logger)
[2022-05-03 18:19:02,713] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-4 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,718] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-3 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,719] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-0 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,720] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-1 (last update controller epoch 19) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,722] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:19:02,734] INFO [Broker id=0] Finished LeaderAndIsr request in 49ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,736] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:19:02,738] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:19:02,741] INFO [Controller id=0 epoch=20] Changed partition Sensor-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), zkVersion=25) (state.change.logger)
[2022-05-03 18:19:02,741] INFO [Controller id=0 epoch=20] Changed partition Sensor-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=20, isr=List(0), zkVersion=26) (state.change.logger)
[2022-05-03 18:19:02,741] INFO [Controller id=0 epoch=20] Changed partition Sensor-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), zkVersion=25) (state.change.logger)
[2022-05-03 18:19:02,741] INFO [Controller id=0 epoch=20] Changed partition Sensor-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), zkVersion=25) (state.change.logger)
[2022-05-03 18:19:02,741] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:19:02,741] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0) for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,745] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 2 (state.change.logger)
[2022-05-03 18:19:02,748] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,748] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 20 for partition Sensor-4 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,749] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 20 for partition Sensor-3 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,749] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 20 for partition Sensor-0 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,749] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 20 for partition Sensor-1 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:02,750] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:19:02,750] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,754] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 4 (state.change.logger)
[2022-05-03 18:19:02,757] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,760] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 20 as part of the become-leader transition for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,764] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:02,772] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 20 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:02,775] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:02,778] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:02,782] INFO [Broker id=0] Finished LeaderAndIsr request in 25ms correlationId 5 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:02,786] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 6 (state.change.logger)
[2022-05-03 18:19:17,406] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:19:17,408] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(3) for 6 partitions (state.change.logger)
[2022-05-03 18:19:17,413] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:19:17,413] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3) for 5 partitions (state.change.logger)
[2022-05-03 18:19:17,416] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 8 (state.change.logger)
[2022-05-03 18:19:17,420] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:19:17,420] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:19:17,420] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:19:17,631] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 0 (state.change.logger)
[2022-05-03 18:19:17,647] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:19:17,671] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:17,672] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 20 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:17,673] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-5 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:17,673] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-2 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:17,674] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:17,676] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:19:17,716] INFO [Broker id=3] Finished LeaderAndIsr request in 70ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:19:17,721] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 2 (state.change.logger)
[2022-05-03 18:19:17,762] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3) for 1 partitions (state.change.logger)
[2022-05-03 18:19:17,764] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 9 (state.change.logger)
[2022-05-03 18:19:17,765] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 3 (state.change.logger)
[2022-05-03 18:19:17,775] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3) for 2 partitions (state.change.logger)
[2022-05-03 18:19:17,777] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 10 (state.change.logger)
[2022-05-03 18:19:17,777] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 4 (state.change.logger)
[2022-05-03 18:19:22,469] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:19:22,470] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(4) for 6 partitions (state.change.logger)
[2022-05-03 18:19:22,473] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:19:22,473] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 4 partitions (state.change.logger)
[2022-05-03 18:19:22,475] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 12 (state.change.logger)
[2022-05-03 18:19:22,476] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 6 (state.change.logger)
[2022-05-03 18:19:22,480] INFO [Controller id=0 epoch=20] Changed partition Sensor-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=25, isr=List(4), zkVersion=35) (state.change.logger)
[2022-05-03 18:19:22,480] INFO [Controller id=0 epoch=20] Changed partition Sensor-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=25, isr=List(4), zkVersion=35) (state.change.logger)
[2022-05-03 18:19:22,480] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:19:22,480] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:19:22,480] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,482] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,482] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 13 (state.change.logger)
[2022-05-03 18:19:22,483] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:22,483] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:22,485] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 7 for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,489] INFO [Broker id=3] Finished LeaderAndIsr request in 8ms correlationId 7 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,493] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 8 (state.change.logger)
[2022-05-03 18:19:22,708] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 0 (state.change.logger)
[2022-05-03 18:19:22,725] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:22,755] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 20 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:22,757] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-5 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:22,757] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:22,757] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 20 for partition Sensor-2 (last update controller epoch 20) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:19:22,759] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 1 for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,800] INFO [Broker id=4] Finished LeaderAndIsr request in 74ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:19:22,807] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 2 (state.change.logger)
[2022-05-03 18:19:22,811] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,812] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:19:22,814] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 14 (state.change.logger)
[2022-05-03 18:19:22,814] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 9 (state.change.logger)
[2022-05-03 18:19:22,817] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,819] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:19:22,821] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 15 (state.change.logger)
[2022-05-03 18:19:22,821] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 10 (state.change.logger)
[2022-05-03 18:19:22,822] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 25 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:22,828] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 25 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:22,831] INFO [Broker id=4] Finished LeaderAndIsr request in 20ms correlationId 3 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:19:22,834] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 4 (state.change.logger)
[2022-05-03 18:19:22,837] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 5 (state.change.logger)
[2022-05-03 18:19:22,839] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 6 (state.change.logger)
[2022-05-03 18:19:23,786] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:19:23,788] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 16 (state.change.logger)
[2022-05-03 18:19:23,788] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 11 (state.change.logger)
[2022-05-03 18:19:23,789] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 7 (state.change.logger)
[2022-05-03 18:19:23,798] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:19:23,801] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 17 (state.change.logger)
[2022-05-03 18:19:23,801] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 12 (state.change.logger)
[2022-05-03 18:19:23,801] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 8 (state.change.logger)
[2022-05-03 18:19:27,496] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:19:27,497] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(5) for 6 partitions (state.change.logger)
[2022-05-03 18:19:27,499] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:19:27,500] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 5 partitions (state.change.logger)
[2022-05-03 18:19:27,502] INFO [Broker id=0] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 19 (state.change.logger)
[2022-05-03 18:19:27,503] INFO [Broker id=4] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 10 (state.change.logger)
[2022-05-03 18:19:27,503] INFO [Broker id=3] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 14 (state.change.logger)
[2022-05-03 18:19:27,742] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 0 (state.change.logger)
[2022-05-03 18:19:27,761] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:19:27,784] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:27,786] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:27,786] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:27,787] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:27,788] INFO [Broker id=5] Follower Sensor-1 starts at leader epoch 19 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:19:27,791] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 1 for 5 partitions (state.change.logger)
[2022-05-03 18:19:27,841] INFO [Broker id=5] Finished LeaderAndIsr request in 81ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:19:27,848] INFO [Broker id=5] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 2 (state.change.logger)
[2022-05-03 18:19:27,850] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:19:27,852] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 20 (state.change.logger)
[2022-05-03 18:19:27,853] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 15 (state.change.logger)
[2022-05-03 18:19:27,853] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 11 (state.change.logger)
[2022-05-03 18:19:27,853] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 3 (state.change.logger)
[2022-05-03 18:19:27,858] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:19:27,860] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 21 (state.change.logger)
[2022-05-03 18:19:27,860] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 12 (state.change.logger)
[2022-05-03 18:19:27,861] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 16 (state.change.logger)
[2022-05-03 18:19:27,861] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 4 (state.change.logger)
[2022-05-03 18:19:27,865] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:19:27,867] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 22 (state.change.logger)
[2022-05-03 18:19:27,867] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 17 (state.change.logger)
[2022-05-03 18:19:27,867] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 13 (state.change.logger)
[2022-05-03 18:19:27,868] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 5 (state.change.logger)
[2022-05-03 18:19:27,871] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:19:27,873] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 23 (state.change.logger)
[2022-05-03 18:19:27,873] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 14 (state.change.logger)
[2022-05-03 18:19:27,873] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 18 (state.change.logger)
[2022-05-03 18:19:27,873] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 6 (state.change.logger)
[2022-05-03 18:23:34,127] INFO [Controller id=0 epoch=20] Changed partition novotopico-1 state from NonExistentPartition to NewPartition with assigned replicas 5,3,4 (state.change.logger)
[2022-05-03 18:23:34,127] INFO [Controller id=0 epoch=20] Changed partition novotopico-2 state from NonExistentPartition to NewPartition with assigned replicas 3,4,0 (state.change.logger)
[2022-05-03 18:23:34,127] INFO [Controller id=0 epoch=20] Changed partition novotopico-4 state from NonExistentPartition to NewPartition with assigned replicas 0,3,4 (state.change.logger)
[2022-05-03 18:23:34,127] INFO [Controller id=0 epoch=20] Changed partition novotopico-5 state from NonExistentPartition to NewPartition with assigned replicas 5,4,0 (state.change.logger)
[2022-05-03 18:23:34,127] INFO [Controller id=0 epoch=20] Changed partition novotopico-3 state from NonExistentPartition to NewPartition with assigned replicas 4,0,5 (state.change.logger)
[2022-05-03 18:23:34,127] INFO [Controller id=0 epoch=20] Changed partition novotopico-0 state from NonExistentPartition to NewPartition with assigned replicas 0,5,3 (state.change.logger)
[2022-05-03 18:23:34,127] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:23:34,130] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:23:34,148] INFO [Controller id=0 epoch=20] Changed partition novotopico-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:23:34,148] INFO [Controller id=0 epoch=20] Changed partition novotopico-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:23:34,148] INFO [Controller id=0 epoch=20] Changed partition novotopico-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:23:34,149] INFO [Controller id=0 epoch=20] Changed partition novotopico-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:23:34,149] INFO [Controller id=0 epoch=20] Changed partition novotopico-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 0, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:23:34,149] INFO [Controller id=0 epoch=20] Changed partition novotopico-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:23:34,149] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:23:34,149] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:23:34,149] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:23:34,150] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:23:34,150] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:23:34,150] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 24 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:23:34,150] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 19 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:23:34,151] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 7 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:23:34,151] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 15 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:23:34,151] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:23:34,156] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 15 from controller 0 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:23:34,157] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 24 from controller 0 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:23:34,161] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 19 from controller 0 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:23:34,162] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 0 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:23:34,172] INFO [Broker id=4] Leader novotopico-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,173] INFO [Broker id=0] Leader novotopico-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,182] INFO [Broker id=4] Follower novotopico-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,183] INFO [Broker id=0] Leader novotopico-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,185] INFO [Broker id=3] Leader novotopico-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,186] INFO [Broker id=5] Leader novotopico-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,190] INFO [Broker id=4] Follower novotopico-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,194] INFO [Broker id=0] Follower novotopico-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,197] INFO [Broker id=4] Follower novotopico-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,200] INFO [Broker id=0] Follower novotopico-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,200] INFO [Broker id=5] Leader novotopico-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,203] INFO [Broker id=4] Follower novotopico-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,204] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 15 for 4 partitions (state.change.logger)
[2022-05-03 18:23:34,205] INFO [Broker id=3] Follower novotopico-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,208] INFO [Broker id=0] Follower novotopico-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,208] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 24 for 3 partitions (state.change.logger)
[2022-05-03 18:23:34,214] INFO [Broker id=3] Follower novotopico-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,214] INFO [Broker id=5] Follower novotopico-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,214] INFO [Broker id=4] Finished LeaderAndIsr request in 63ms correlationId 15 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:23:34,218] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 16 (state.change.logger)
[2022-05-03 18:23:34,221] INFO [Broker id=5] Follower novotopico-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,221] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 7 for 2 partitions (state.change.logger)
[2022-05-03 18:23:34,222] INFO [Broker id=3] Follower novotopico-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:23:34,223] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 19 for 3 partitions (state.change.logger)
[2022-05-03 18:23:34,224] INFO [Broker id=5] Finished LeaderAndIsr request in 72ms correlationId 7 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:23:34,227] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 8 (state.change.logger)
[2022-05-03 18:23:34,229] INFO [Broker id=3] Finished LeaderAndIsr request in 79ms correlationId 19 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:23:34,233] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 20 (state.change.logger)
[2022-05-03 18:23:34,266] INFO [Broker id=0] Finished LeaderAndIsr request in 116ms correlationId 24 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:23:34,269] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 25 (state.change.logger)
[2022-05-03 18:24:03,135] INFO [Controller id=0 epoch=20] Changed partition novotopico-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=1, isr=List(4, 0), zkVersion=1) (state.change.logger)
[2022-05-03 18:24:03,135] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,136] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,136] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,136] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,137] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,137] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,137] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 26 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,137] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:03,137] INFO [Broker id=3] Follower novotopico-2 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,138] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 17 from controller 0 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,138] INFO [Broker id=0] Follower novotopico-2 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,138] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 9 (state.change.logger)
[2022-05-03 18:24:03,138] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 21 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,138] INFO [Broker id=4] Leader novotopico-2 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [4,0] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,139] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 26 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,140] INFO [Controller id=0 epoch=20] Sending StopReplica request for 8 replicas to broker 3 (state.change.logger)
[2022-05-03 18:24:03,143] INFO [Broker id=3] Finished LeaderAndIsr request in 6ms correlationId 21 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,146] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 22 (state.change.logger)
[2022-05-03 18:24:03,149] INFO [Broker id=0] Finished LeaderAndIsr request in 12ms correlationId 26 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Broker id=3] Handling StopReplica request correlationId 23 from controller 0 for 8 partitions (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Controller id=0 epoch=20] Partition novotopico-1 state changed to (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Controller id=0 epoch=20] Partition Sensor-5 state changed to (Leader:4,ISR:4,5,LeaderEpoch:26,ZkVersion:38,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Controller id=0 epoch=20] Partition novotopico-4 state changed to (Leader:0,ISR:0,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Controller id=0 epoch=20] Partition Sensor-2 state changed to (Leader:4,ISR:4,5,LeaderEpoch:26,ZkVersion:38,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Controller id=0 epoch=20] Partition Sensor-3 state changed to (Leader:0,ISR:0,4,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Controller id=0 epoch=20] Partition novotopico-0 state changed to (Leader:0,ISR:0,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,150] INFO [Controller id=0 epoch=20] Partition Sensor-1 state changed to (Leader:0,ISR:0,5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,151] INFO [Controller id=0 epoch=20] Partition Sensor-4 state changed to (Leader:0,ISR:0,5,LeaderEpoch:20,ZkVersion:28,ControllerEpoch:20) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,151] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 5 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,152] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 27 (state.change.logger)
[2022-05-03 18:24:03,152] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,152] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 5 with 1 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,152] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 8 partitions (state.change.logger)
[2022-05-03 18:24:03,153] INFO [Controller id=0 epoch=20] Sending StopReplica request for 8 replicas to broker 3 (state.change.logger)
[2022-05-03 18:24:03,153] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 28 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:24:03,153] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 10 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:24:03,154] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 28 from controller 0 epoch 20 as part of the become-leader transition for 5 partitions (state.change.logger)
[2022-05-03 18:24:03,154] INFO [Broker id=0] Leader novotopico-0 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0,5] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,154] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 10 from controller 0 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition novotopico-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition novotopico-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=5] Leader novotopico-1 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [5,4] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition Sensor-4 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition Sensor-5 since its associated leader epoch 25 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition novotopico-4 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition Sensor-2 since its associated leader epoch 25 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition Sensor-3 since its associated leader epoch 20 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,155] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 23 epoch 20 for partition Sensor-1 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,157] INFO [Broker id=4] Finished LeaderAndIsr request in 20ms correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,160] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 18 (state.change.logger)
[2022-05-03 18:24:03,161] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 28 from controller 0 epoch 20 for partition novotopico-0 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,161] INFO [Broker id=0] Leader novotopico-4 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,162] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 10 from controller 0 epoch 20 for partition novotopico-1 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,162] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 19 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:24:03,162] INFO [Broker id=5] Follower novotopico-0 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,162] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 20 from offset 0 with high watermark 0. Previous leader epoch was 19. (state.change.logger)
[2022-05-03 18:24:03,162] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 26 from offset 0 with high watermark 0. Previous leader epoch was 25. (state.change.logger)
[2022-05-03 18:24:03,163] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 26 from offset 0 with high watermark 0. Previous leader epoch was 25. (state.change.logger)
[2022-05-03 18:24:03,163] INFO [Broker id=5] Follower Sensor-1 starts at leader epoch 20 from offset 0 with high watermark 0. Previous leader epoch was 19. (state.change.logger)
[2022-05-03 18:24:03,163] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 19 from controller 0 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,163] INFO [Broker id=4] Leader Sensor-5 starts at leader epoch 26 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 25. (state.change.logger)
[2022-05-03 18:24:03,164] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 28 from controller 0 epoch 20 for partition novotopico-4 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,164] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 20 from offset 0 with high watermark 0 ISR [0,5] addingReplicas [] removingReplicas []. Previous leader epoch was 19. (state.change.logger)
[2022-05-03 18:24:03,165] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 10 for 5 partitions (state.change.logger)
[2022-05-03 18:24:03,166] INFO [Broker id=5] Finished LeaderAndIsr request in 12ms correlationId 10 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Broker id=3] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 24 (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Changed partition Sensor-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=20, isr=List(4, 5), zkVersion=28) (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Changed partition novotopico-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=2, isr=List(4), zkVersion=2) (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Changed partition Sensor-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=22, isr=List(4), zkVersion=30) (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Changed partition novotopico-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=2, isr=List(5), zkVersion=2) (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Changed partition Sensor-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=21, isr=List(5), zkVersion=29) (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Changed partition Sensor-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=21, isr=List(5), zkVersion=29) (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 28 from controller 0 epoch 20 for partition Sensor-4 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 5 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,167] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,168] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,168] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 5 with 3 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,168] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:24:03,168] INFO [Broker id=5] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 11 (state.change.logger)
[2022-05-03 18:24:03,168] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:03,168] INFO [Controller id=0 epoch=20] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 19 from controller 0 epoch 20 for partition Sensor-5 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 28 from controller 0 epoch 20 for partition Sensor-3 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 12 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Handling StopReplica request correlationId 25 from controller 0 for 8 partitions (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 20 from offset 0 with high watermark 0 ISR [0,5] addingReplicas [] removingReplicas []. Previous leader epoch was 19. (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 26 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 25. (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition novotopico-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition novotopico-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition Sensor-4 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition Sensor-5 since its associated leader epoch 25 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition novotopico-4 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition Sensor-2 since its associated leader epoch 25 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition Sensor-3 since its associated leader epoch 20 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,170] INFO [Broker id=3] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 25 epoch 20 for partition Sensor-1 since its associated leader epoch 19 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,171] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 12 from controller 0 epoch 20 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,171] INFO [Broker id=5] Leader novotopico-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,173] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 28 from controller 0 epoch 20 for partition Sensor-1 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,173] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 19 from controller 0 epoch 20 for partition Sensor-2 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,174] INFO [Broker id=4] Follower novotopico-1 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,174] INFO [Broker id=4] Follower novotopico-4 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,175] INFO [Broker id=0] Finished LeaderAndIsr request in 21ms correlationId 28 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:24:03,175] INFO [Broker id=4] Follower Sensor-3 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,175] INFO [Broker id=5] Leader Sensor-4 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,176] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 19 for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,177] INFO [Broker id=4] Finished LeaderAndIsr request in 15ms correlationId 19 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:24:03,177] INFO [Controller id=0 epoch=20] Partition novotopico-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,178] INFO [Controller id=0 epoch=20] Partition novotopico-3 state changed to (Leader:4,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,178] INFO [Broker id=0] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 29 (state.change.logger)
[2022-05-03 18:24:03,178] INFO [Controller id=0 epoch=20] Partition novotopico-5 state changed to (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:20) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,179] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,179] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,180] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 5 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,180] INFO [Broker id=5] Leader Sensor-1 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,180] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 30 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:24:03,180] INFO [Broker id=4] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 20 (state.change.logger)
[2022-05-03 18:24:03,180] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=0] Follower novotopico-0 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=0] Follower novotopico-4 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Controller id=0 epoch=20] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=0] Follower Sensor-0 starts at leader epoch 20 from offset 0 with high watermark 0. Previous leader epoch was 19. (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 21 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,181] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 30 for 6 partitions (state.change.logger)
[2022-05-03 18:24:03,182] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 21 from controller 0 epoch 20 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,183] INFO [Broker id=4] Leader novotopico-4 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,184] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 20 from offset 0 with high watermark 0. Previous leader epoch was 19. (state.change.logger)
[2022-05-03 18:24:03,185] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 12 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,186] INFO [Broker id=4] Leader Sensor-3 starts at leader epoch 22 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 21. (state.change.logger)
[2022-05-03 18:24:03,189] INFO [Broker id=4] Leader Sensor-0 starts at leader epoch 20 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 19. (state.change.logger)
[2022-05-03 18:24:03,191] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition novotopico-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,192] INFO [Broker id=0] Finished LeaderAndIsr request in 12ms correlationId 30 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:24:03,192] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,193] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition novotopico-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,193] INFO [Controller id=0 epoch=20] Changed partition Sensor-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=21, isr=List(5), zkVersion=29) (state.change.logger)
[2022-05-03 18:24:03,193] INFO [Controller id=0 epoch=20] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=27, isr=List(5), zkVersion=39) (state.change.logger)
[2022-05-03 18:24:03,193] INFO [Controller id=0 epoch=20] Changed partition novotopico-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=2, isr=List(5), zkVersion=2) (state.change.logger)
[2022-05-03 18:24:03,193] INFO [Controller id=0 epoch=20] Changed partition Sensor-5 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=27, isr=List(5), zkVersion=39) (state.change.logger)
[2022-05-03 18:24:03,194] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,195] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,195] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,197] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 5 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,197] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,198] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:03,199] INFO [Broker id=4] Finished LeaderAndIsr request in 18ms correlationId 21 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,199] INFO [Controller id=0 epoch=20] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:24:03,202] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 22 (state.change.logger)
[2022-05-03 18:24:03,204] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 23 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,205] INFO [Broker id=5] Finished LeaderAndIsr request in 35ms correlationId 12 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,205] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 23 from controller 0 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,205] INFO [Broker id=4] Leader novotopico-2 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,208] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 23 from controller 0 epoch 20 for partition novotopico-2 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,209] INFO [Broker id=4] Leader novotopico-3 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [4,5] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,209] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 13 (state.change.logger)
[2022-05-03 18:24:03,209] INFO [Controller id=0 epoch=20] Partition novotopico-1 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,210] INFO [Controller id=0 epoch=20] Partition novotopico-5 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:20) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:03,210] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,210] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,211] INFO [Controller id=0 epoch=20] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:03,211] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,211] INFO [Controller id=0 epoch=20] Sending StopReplica request for 2 replicas to broker 4 (state.change.logger)
[2022-05-03 18:24:03,211] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 14 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,211] INFO [Broker id=4] Skipped the become-leader state change after marking its partition as leader with correlation id 23 from controller 0 epoch 20 for partition novotopico-3 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,212] INFO [Broker id=4] Follower novotopico-5 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,212] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 14 from controller 0 epoch 20 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,212] INFO [Broker id=5] Leader novotopico-5 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [5,4] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,212] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 23 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,215] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 14 from controller 0 epoch 20 for partition novotopico-5 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,216] INFO [Broker id=5] Follower novotopico-3 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2022-05-03 18:24:03,217] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 14 for 1 partitions (state.change.logger)
[2022-05-03 18:24:03,217] INFO [Broker id=4] Finished LeaderAndIsr request in 13ms correlationId 23 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:24:03,219] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition novotopico-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,219] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,220] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 24 (state.change.logger)
[2022-05-03 18:24:03,220] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,220] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition novotopico-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,220] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,221] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 25 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,221] INFO [Broker id=5] Finished LeaderAndIsr request in 10ms correlationId 14 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,221] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,221] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,222] INFO [Broker id=4] Follower novotopico-3 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,222] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 27 from offset 0 with high watermark 0. Previous leader epoch was 26. (state.change.logger)
[2022-05-03 18:24:03,222] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition novotopico-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,222] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,222] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 27 from offset 0 with high watermark 0. Previous leader epoch was 26. (state.change.logger)
[2022-05-03 18:24:03,222] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 20 with correlation id 25 for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,222] ERROR [Controller id=0 epoch=20] Controller 0 epoch 20 failed to change state for partition novotopico-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:03,223] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:03,223] INFO [Controller id=0 epoch=20] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:03,224] INFO [Broker id=5] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 15 (state.change.logger)
[2022-05-03 18:24:03,226] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 16 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,226] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 16 from controller 0 epoch 20 as part of the become-leader transition for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,226] INFO [Broker id=5] Leader novotopico-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,228] INFO [Broker id=4] Finished LeaderAndIsr request in 7ms correlationId 25 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,230] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 27 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 26. (state.change.logger)
[2022-05-03 18:24:03,230] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 26 (state.change.logger)
[2022-05-03 18:24:03,233] INFO [Broker id=5] Leader Sensor-0 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 20. (state.change.logger)
[2022-05-03 18:24:03,233] INFO [Broker id=4] Handling StopReplica request correlationId 27 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,236] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 27 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 26. (state.change.logger)
[2022-05-03 18:24:03,236] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 27 epoch 20 for partition novotopico-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,237] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 27 epoch 20 for partition novotopico-5 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,239] INFO [Broker id=5] Finished LeaderAndIsr request in 13ms correlationId 16 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:24:03,242] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 17 (state.change.logger)
[2022-05-03 18:24:03,244] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 18 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,244] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 18 from controller 0 epoch 20 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,244] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 28 (state.change.logger)
[2022-05-03 18:24:03,244] INFO [Broker id=5] Leader novotopico-1 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,245] INFO [Broker id=4] Handling StopReplica request correlationId 29 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,245] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 29 epoch 20 for partition novotopico-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,245] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 29 epoch 20 for partition novotopico-5 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:03,247] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 18 from controller 0 epoch 20 for partition novotopico-1 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,247] INFO [Broker id=5] Leader novotopico-5 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:03,249] INFO [Broker id=5] Skipped the become-leader state change after marking its partition as leader with correlation id 18 from controller 0 epoch 20 for partition novotopico-5 (last update controller epoch 20) since it is already the leader for the partition. (state.change.logger)
[2022-05-03 18:24:03,250] INFO [Broker id=5] Finished LeaderAndIsr request in 7ms correlationId 18 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:24:03,252] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 20 with correlation id 19 (state.change.logger)
[2022-05-03 18:24:04,042] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:24:04,070] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 9 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,072] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,073] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 5 with 9 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,073] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 12 partitions (state.change.logger)
[2022-05-03 18:24:04,075] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 5 for 9 partitions (state.change.logger)
[2022-05-03 18:24:04,076] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 5 for 9 partitions (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition novotopico-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition novotopico-4 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition novotopico-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-3 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-4 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 1 epoch 21 for partition Sensor-1 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Follower novotopico-1 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Follower novotopico-5 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was 1. (state.change.logger)
[2022-05-03 18:24:04,077] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 5 epoch 21 with correlation id 1 for 2 partitions (state.change.logger)
[2022-05-03 18:24:04,078] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 1 from controller 5 for 9 partitions (state.change.logger)
[2022-05-03 18:24:04,078] INFO [Broker id=4] Finished LeaderAndIsr request in 3ms correlationId 1 from controller 5 for 9 partitions (state.change.logger)
[2022-05-03 18:24:04,082] INFO [Broker id=4] Add 12 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 2 (state.change.logger)
[2022-05-03 18:24:04,082] INFO [Broker id=5] Add 12 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 2 (state.change.logger)
[2022-05-03 18:24:04,087] INFO [Controller id=5 epoch=21] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,088] INFO [Controller id=5 epoch=21] Partition novotopico-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,088] INFO [Controller id=5 epoch=21] Partition novotopico-4 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,088] INFO [Controller id=5 epoch=21] Partition novotopico-5 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,089] INFO [Controller id=5 epoch=21] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,089] INFO [Controller id=5 epoch=21] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,089] INFO [Controller id=5 epoch=21] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,089] INFO [Controller id=5 epoch=21] Partition novotopico-3 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,089] INFO [Controller id=5 epoch=21] Partition novotopico-0 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,090] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,090] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,091] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 5 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,091] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 9 partitions (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition novotopico-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition novotopico-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition Sensor-4 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition novotopico-4 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition Sensor-1 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,092] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition Sensor-3 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,093] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 3 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,093] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,093] INFO [Broker id=4] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,095] INFO [Broker id=5] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 4 (state.change.logger)
[2022-05-03 18:24:04,096] INFO [Broker id=4] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 4 (state.change.logger)
[2022-05-03 18:24:04,276] INFO [Controller id=5 epoch=21] Partition novotopico-1 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,276] INFO [Controller id=5 epoch=21] Partition novotopico-4 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,276] INFO [Controller id=5 epoch=21] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,276] INFO [Controller id=5 epoch=21] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,276] INFO [Controller id=5 epoch=21] Partition novotopico-0 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,276] INFO [Controller id=5 epoch=21] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,276] INFO [Controller id=5 epoch=21] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,277] INFO [Controller id=5 epoch=21] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,277] INFO [Controller id=5 epoch=21] Partition novotopico-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:04,277] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,277] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 5 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:04,277] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet(4, 5) for 9 partitions (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 5 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 5 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition novotopico-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition novotopico-4 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition novotopico-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition Sensor-3 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition Sensor-4 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 5 epoch 21 for partition Sensor-1 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=5] Finished LeaderAndIsr request in 0ms correlationId 5 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,278] INFO [Broker id=4] Finished LeaderAndIsr request in 0ms correlationId 5 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:04,280] INFO [Broker id=4] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 6 (state.change.logger)
[2022-05-03 18:24:04,280] INFO [Broker id=5] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 6 (state.change.logger)
[2022-05-03 18:24:08,218] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,219] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,219] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,220] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:08,220] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:08,221] INFO [Controller id=5 epoch=21] Sending StopReplica request for 6 replicas to broker 4 (state.change.logger)
[2022-05-03 18:24:08,223] INFO [Broker id=4] Handling StopReplica request correlationId 7 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:08,223] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,223] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,223] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,223] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,223] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,223] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 7 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,225] INFO [Controller id=5 epoch=21] Partition novotopico-1 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:08,226] INFO [Controller id=5 epoch=21] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:08,226] INFO [Controller id=5 epoch=21] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:08,226] INFO [Controller id=5 epoch=21] Partition novotopico-5 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:08,226] INFO [Controller id=5 epoch=21] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:08,226] INFO [Controller id=5 epoch=21] Partition novotopico-3 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:08,226] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 5 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:08,226] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet(4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:24:08,227] INFO [Controller id=5 epoch=21] Sending StopReplica request for 6 replicas to broker 4 (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 7 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 7 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 7 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 7 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 7 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 7 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 7 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 8 (state.change.logger)
[2022-05-03 18:24:08,228] INFO [Broker id=5] Finished LeaderAndIsr request in 0ms correlationId 7 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:08,229] INFO [Broker id=4] Handling StopReplica request correlationId 9 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:08,229] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,229] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,229] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,229] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,229] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,229] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 9 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:08,230] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 8 (state.change.logger)
[2022-05-03 18:24:08,234] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,234] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,234] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,235] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,235] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,235] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,235] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,235] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,235] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:08,236] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:08,236] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:13,238] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,239] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,239] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,240] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:13,240] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:13,240] INFO [Controller id=5 epoch=21] Sending StopReplica request for 6 replicas to broker 4 (state.change.logger)
[2022-05-03 18:24:13,241] INFO [Broker id=4] Handling StopReplica request correlationId 10 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:13,241] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 10 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,241] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 10 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,241] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 10 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,241] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 10 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,241] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 10 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,241] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 10 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,243] INFO [Controller id=5 epoch=21] Partition novotopico-1 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:13,243] INFO [Controller id=5 epoch=21] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:13,243] INFO [Controller id=5 epoch=21] Partition Sensor-5 state changed to (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:13,243] INFO [Controller id=5 epoch=21] Partition novotopico-5 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:13,243] INFO [Controller id=5 epoch=21] Partition Sensor-2 state changed to (Leader:5,ISR:5,LeaderEpoch:27,ZkVersion:39,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:13,243] INFO [Controller id=5 epoch=21] Partition novotopico-3 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:21) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:13,244] INFO [Controller id=5 epoch=21] Sending LeaderAndIsr request to broker 5 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:24:13,244] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet(4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:24:13,244] INFO [Controller id=5 epoch=21] Sending StopReplica request for 6 replicas to broker 4 (state.change.logger)
[2022-05-03 18:24:13,245] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 9 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:13,245] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 9 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,245] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 9 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,245] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 9 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,245] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 9 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,245] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 9 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,245] INFO [Broker id=5] Ignoring LeaderAndIsr request from controller 5 with correlation id 9 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,246] INFO [Broker id=5] Finished LeaderAndIsr request in 1ms correlationId 9 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:13,246] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 11 (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=4] Handling StopReplica request correlationId 12 from controller 5 for 6 partitions (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 12 epoch 21 for partition novotopico-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 12 epoch 21 for partition novotopico-3 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 12 epoch 21 for partition Sensor-5 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 12 epoch 21 for partition Sensor-2 since its associated leader epoch 27 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 12 epoch 21 for partition novotopico-5 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=4] Ignoring StopReplica request (delete=false) from controller 5 with correlation id 12 epoch 21 for partition Sensor-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2022-05-03 18:24:13,247] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 5 epoch 21 with correlation id 10 (state.change.logger)
[2022-05-03 18:24:13,249] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,249] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,250] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,250] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-5 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-5 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,250] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,251] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,252] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition Sensor-4 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,252] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-3 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-3 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,252] ERROR [Controller id=5 epoch=21] Controller 5 epoch 21 failed to change state for partition novotopico-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1347)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1309)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1309)
	at kafka.controller.KafkaController.process(KafkaController.scala:2483)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:13,252] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:13,252] INFO [Controller id=5 epoch=21] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:24:14,223] INFO [Controller id=4 epoch=22] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:24:14,245] INFO [Controller id=4 epoch=22] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:24:14,247] INFO [Controller id=4 epoch=22] Sending UpdateMetadata request to brokers HashSet(4) for 9 partitions (state.change.logger)
[2022-05-03 18:24:14,261] INFO [Controller id=4 epoch=22] Partition Sensor-0 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition novotopico-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition novotopico-4 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition novotopico-5 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition Sensor-1 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition Sensor-4 state changed to (Leader:5,ISR:5,LeaderEpoch:21,ZkVersion:29,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition novotopico-3 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,262] INFO [Controller id=4 epoch=22] Partition novotopico-0 state changed to (Leader:5,ISR:5,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:22) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,277] INFO [Controller id=4 epoch=22] Partition novotopico-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,278] INFO [Controller id=4 epoch=22] Partition Sensor-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,278] INFO [Controller id=4 epoch=22] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:28,ZkVersion:40,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,278] INFO [Controller id=4 epoch=22] Partition novotopico-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,278] INFO [Controller id=4 epoch=22] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:28,ZkVersion:40,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,278] INFO [Controller id=4 epoch=22] Partition Sensor-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,278] INFO [Controller id=4 epoch=22] Partition Sensor-4 state changed to (Leader:-1,ISR:5,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,278] INFO [Controller id=4 epoch=22] Partition novotopico-3 state changed to (Leader:-1,ISR:5,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,279] INFO [Controller id=4 epoch=22] Partition novotopico-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:22) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,283] INFO [Controller id=4 epoch=22] Partition novotopico-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,283] INFO [Controller id=4 epoch=22] Partition novotopico-4 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,283] INFO [Controller id=4 epoch=22] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:28,ZkVersion:40,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,284] INFO [Controller id=4 epoch=22] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,284] INFO [Controller id=4 epoch=22] Partition novotopico-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,284] INFO [Controller id=4 epoch=22] Partition Sensor-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,284] INFO [Controller id=4 epoch=22] Partition Sensor-4 state changed to (Leader:-1,ISR:5,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,284] INFO [Controller id=4 epoch=22] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:28,ZkVersion:40,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,285] INFO [Controller id=4 epoch=22] Partition novotopico-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:22) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:24:14,285] INFO [Controller id=4 epoch=22] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:24:14,285] INFO [Controller id=4 epoch=22] Sending UpdateMetadata request to brokers HashSet(4) for 12 partitions (state.change.logger)
[2022-05-03 18:24:14,306] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition novotopico-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,307] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,307] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,307] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition novotopico-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,307] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,308] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,308] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,308] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition novotopico-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,308] ERROR [Controller id=4 epoch=22] Controller 4 epoch 22 failed to change state for partition novotopico-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2452)
	at kafka.controller.KafkaController.process(KafkaController.scala:2497)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:24:14,309] INFO [Controller id=4 epoch=22] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:25:11,278] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:25:11,322] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 9 become-follower partitions (state.change.logger)
[2022-05-03 18:25:11,324] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0) for 9 partitions (state.change.logger)
[2022-05-03 18:25:11,352] INFO [Controller id=0 epoch=23] Partition novotopico-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,352] INFO [Controller id=0 epoch=23] Partition Sensor-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:23,ZkVersion:31,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,353] INFO [Controller id=0 epoch=23] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:29,ZkVersion:41,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,353] INFO [Controller id=0 epoch=23] Partition novotopico-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,354] INFO [Controller id=0 epoch=23] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:29,ZkVersion:41,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,354] INFO [Controller id=0 epoch=23] Partition Sensor-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:23,ZkVersion:31,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,355] INFO [Controller id=0 epoch=23] Partition Sensor-4 state changed to (Leader:-1,ISR:5,LeaderEpoch:23,ZkVersion:31,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,355] INFO [Controller id=0 epoch=23] Partition novotopico-3 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,356] INFO [Controller id=0 epoch=23] Partition novotopico-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,363] INFO [Controller id=0 epoch=23] Partition novotopico-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,364] INFO [Controller id=0 epoch=23] Partition novotopico-4 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,365] INFO [Controller id=0 epoch=23] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:29,ZkVersion:41,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,365] INFO [Controller id=0 epoch=23] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:22,ZkVersion:30,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,365] INFO [Controller id=0 epoch=23] Partition novotopico-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,366] INFO [Controller id=0 epoch=23] Partition Sensor-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:23,ZkVersion:31,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,366] INFO [Controller id=0 epoch=23] Partition Sensor-4 state changed to (Leader:-1,ISR:5,LeaderEpoch:23,ZkVersion:31,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,366] INFO [Controller id=0 epoch=23] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:29,ZkVersion:41,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,367] INFO [Controller id=0 epoch=23] Partition novotopico-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,377] INFO [Controller id=0 epoch=23] Partition novotopico-1 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,378] INFO [Controller id=0 epoch=23] Partition Sensor-0 state changed to (Leader:-1,ISR:5,LeaderEpoch:23,ZkVersion:31,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,378] INFO [Controller id=0 epoch=23] Partition novotopico-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,378] INFO [Controller id=0 epoch=23] Partition novotopico-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,378] INFO [Controller id=0 epoch=23] Partition Sensor-2 state changed to (Leader:-1,ISR:5,LeaderEpoch:29,ZkVersion:41,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,378] INFO [Controller id=0 epoch=23] Partition Sensor-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:23,ZkVersion:31,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,378] INFO [Controller id=0 epoch=23] Partition novotopico-3 state changed to (Leader:-1,ISR:5,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,379] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:11,379] INFO [Controller id=0 epoch=23] Partition Sensor-5 state changed to (Leader:-1,ISR:5,LeaderEpoch:29,ZkVersion:41,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,380] INFO [Controller id=0 epoch=23] Partition novotopico-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:25:11,380] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 9 become-follower partitions (state.change.logger)
[2022-05-03 18:25:11,380] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0) for 12 partitions (state.change.logger)
[2022-05-03 18:25:11,410] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-2 (last update controller epoch 20) but cannot become follower since the new leader 4 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,416] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-0 (last update controller epoch 22) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,417] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-5 (last update controller epoch 22) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,418] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-4 (last update controller epoch 20) but cannot become follower since the new leader 4 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,418] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-3 (last update controller epoch 22) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,419] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-4 (last update controller epoch 22) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,419] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,420] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-3 (last update controller epoch 20) but cannot become follower since the new leader 4 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,422] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,422] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-0 (last update controller epoch 22) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,422] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,423] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-1 (last update controller epoch 22) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,423] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,424] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,424] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,424] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,425] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,425] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,425] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,426] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:25:11,426] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,426] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:42)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:266)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1527)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1428)
	at kafka.controller.KafkaController.process(KafkaController.scala:2527)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:11,428] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:25:11,437] INFO [Broker id=0] Finished LeaderAndIsr request in 61ms correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:11,449] INFO [Broker id=0] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 2 (state.change.logger)
[2022-05-03 18:25:11,453] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition novotopico-2 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition novotopico-0 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition novotopico-5 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition novotopico-4 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition novotopico-3 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition Sensor-4 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition Sensor-3 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition Sensor-0 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,454] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 23 for partition Sensor-1 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:11,455] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 3 for 0 partitions (state.change.logger)
[2022-05-03 18:25:11,456] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 3 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:11,460] INFO [Broker id=0] Add 12 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 4 (state.change.logger)
[2022-05-03 18:25:26,081] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:25:26,083] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(3) for 12 partitions (state.change.logger)
[2022-05-03 18:25:26,088] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 9 become-follower partitions (state.change.logger)
[2022-05-03 18:25:26,088] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3) for 9 partitions (state.change.logger)
[2022-05-03 18:25:26,090] INFO [Broker id=0] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 6 (state.change.logger)
[2022-05-03 18:25:26,098] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,098] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,098] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,099] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,099] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,099] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,099] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,100] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,100] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,101] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,101] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,101] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:26,101] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:25:26,292] INFO [Broker id=3] Add 12 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 0 (state.change.logger)
[2022-05-03 18:25:26,309] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:26,328] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-2 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,332] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-1 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,332] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-0 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,333] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-4 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,333] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-4 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,334] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-3 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,335] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-5 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,335] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-2 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,335] ERROR [Broker id=3] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-1 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:26,336] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:25:26,346] INFO [Broker id=3] Finished LeaderAndIsr request in 38ms correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:26,352] INFO [Broker id=3] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 2 (state.change.logger)
[2022-05-03 18:25:31,168] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:25:31,169] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(4) for 12 partitions (state.change.logger)
[2022-05-03 18:25:31,171] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 9 become-follower partitions (state.change.logger)
[2022-05-03 18:25:31,171] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 9 partitions (state.change.logger)
[2022-05-03 18:25:31,174] INFO [Broker id=0] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 8 (state.change.logger)
[2022-05-03 18:25:31,175] INFO [Broker id=3] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 4 (state.change.logger)
[2022-05-03 18:25:31,183] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,184] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,184] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,184] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,184] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,184] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,185] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition Sensor-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition Sensor-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,185] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,185] ERROR [Controller id=0 epoch=23] Controller 0 epoch 23 failed to change state for partition novotopico-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition novotopico-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:424)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:919)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:421)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:332)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:238)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:158)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:74)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:59)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:540)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1601)
	at kafka.controller.KafkaController.process(KafkaController.scala:2491)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-03 18:25:31,186] INFO [Controller id=0 epoch=23] Changed partition novotopico-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=4, isr=List(4), zkVersion=4) (state.change.logger)
[2022-05-03 18:25:31,186] INFO [Controller id=0 epoch=23] Changed partition Sensor-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=24, isr=List(4), zkVersion=32) (state.change.logger)
[2022-05-03 18:25:31,186] INFO [Controller id=0 epoch=23] Changed partition novotopico-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=4, isr=List(4), zkVersion=4) (state.change.logger)
[2022-05-03 18:25:31,186] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:25:31,186] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:25:31,187] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:25:31,187] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,189] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,189] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,194] INFO [Broker id=0] Follower novotopico-2 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,194] INFO [Broker id=3] Follower novotopico-2 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,194] INFO [Broker id=0] Follower novotopico-4 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,194] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,194] INFO [Broker id=3] Follower novotopico-4 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,195] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,195] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 9 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,196] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 5 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,236] INFO [Broker id=0] Finished LeaderAndIsr request in 47ms correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,240] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 10 (state.change.logger)
[2022-05-03 18:25:31,245] INFO [Broker id=3] Finished LeaderAndIsr request in 56ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,248] INFO [Broker id=3] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 6 (state.change.logger)
[2022-05-03 18:25:31,431] INFO [Broker id=4] Add 12 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 0 (state.change.logger)
[2022-05-03 18:25:31,452] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:31,482] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-2 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,485] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-1 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,485] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-5 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,485] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-4 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,485] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-3 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,485] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-3 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,485] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-5 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,486] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-0 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,486] ERROR [Broker id=4] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-2 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:31,488] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:25:31,496] INFO [Broker id=4] Finished LeaderAndIsr request in 44ms correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:31,502] INFO [Broker id=4] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 2 (state.change.logger)
[2022-05-03 18:25:31,504] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,509] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 23 as part of the become-leader transition for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,513] INFO [Broker id=4] Leader novotopico-2 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,521] INFO [Broker id=4] Leader novotopico-4 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,524] INFO [Broker id=4] Leader Sensor-3 starts at leader epoch 24 from offset 0 with high watermark 0 ISR [4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:31,529] INFO [Broker id=4] Finished LeaderAndIsr request in 25ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:25:31,533] INFO [Broker id=4] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 4 (state.change.logger)
[2022-05-03 18:25:32,534] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:25:32,536] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 11 (state.change.logger)
[2022-05-03 18:25:32,536] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 5 (state.change.logger)
[2022-05-03 18:25:32,536] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 7 (state.change.logger)
[2022-05-03 18:25:32,549] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:25:32,551] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 12 (state.change.logger)
[2022-05-03 18:25:32,551] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 8 (state.change.logger)
[2022-05-03 18:25:32,552] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 6 (state.change.logger)
[2022-05-03 18:25:33,040] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 1 partitions (state.change.logger)
[2022-05-03 18:25:33,043] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 13 (state.change.logger)
[2022-05-03 18:25:33,043] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 9 (state.change.logger)
[2022-05-03 18:25:33,043] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 7 (state.change.logger)
[2022-05-03 18:25:33,049] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 2 partitions (state.change.logger)
[2022-05-03 18:25:33,050] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 14 (state.change.logger)
[2022-05-03 18:25:33,051] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 8 (state.change.logger)
[2022-05-03 18:25:33,051] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 10 (state.change.logger)
[2022-05-03 18:25:36,191] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:25:36,192] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(5) for 12 partitions (state.change.logger)
[2022-05-03 18:25:36,194] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 9 become-follower partitions (state.change.logger)
[2022-05-03 18:25:36,195] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 9 partitions (state.change.logger)
[2022-05-03 18:25:36,197] INFO [Broker id=0] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 16 (state.change.logger)
[2022-05-03 18:25:36,197] INFO [Broker id=3] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 12 (state.change.logger)
[2022-05-03 18:25:36,197] INFO [Broker id=4] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 10 (state.change.logger)
[2022-05-03 18:25:36,204] INFO [Controller id=0 epoch=23] Changed partition novotopico-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=5, isr=List(5), zkVersion=5) (state.change.logger)
[2022-05-03 18:25:36,204] INFO [Controller id=0 epoch=23] Changed partition Sensor-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=24, isr=List(5), zkVersion=32) (state.change.logger)
[2022-05-03 18:25:36,204] INFO [Controller id=0 epoch=23] Changed partition Sensor-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=30, isr=List(5), zkVersion=42) (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Changed partition novotopico-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=5, isr=List(5), zkVersion=5) (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Changed partition Sensor-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=30, isr=List(5), zkVersion=42) (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Changed partition Sensor-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=24, isr=List(5), zkVersion=32) (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Changed partition Sensor-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=24, isr=List(5), zkVersion=32) (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Changed partition novotopico-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=5, isr=List(5), zkVersion=5) (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Changed partition novotopico-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=5, isr=List(5), zkVersion=5) (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 5 with 9 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:25:36,205] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 9 partitions (state.change.logger)
[2022-05-03 18:25:36,206] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 17 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,206] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 13 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,207] INFO [Broker id=0] Follower novotopico-0 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,207] INFO [Broker id=3] Follower novotopico-1 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,207] INFO [Broker id=0] Follower novotopico-5 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,207] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 11 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,207] INFO [Broker id=0] Follower novotopico-3 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,208] INFO [Broker id=3] Follower novotopico-0 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,208] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,208] INFO [Broker id=0] Follower Sensor-0 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,208] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,208] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,208] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 30 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,208] INFO [Broker id=3] Follower Sensor-2 starts at leader epoch 30 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,209] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 17 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=4] Follower novotopico-1 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=4] Follower novotopico-5 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=4] Follower novotopico-3 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 30 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 30 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,210] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 13 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,211] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 11 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,219] INFO [Broker id=0] Finished LeaderAndIsr request in 13ms correlationId 17 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,221] INFO [Broker id=3] Finished LeaderAndIsr request in 15ms correlationId 13 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,222] INFO [Broker id=0] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 18 (state.change.logger)
[2022-05-03 18:25:36,224] INFO [Broker id=3] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 14 (state.change.logger)
[2022-05-03 18:25:36,246] INFO [Broker id=4] Finished LeaderAndIsr request in 39ms correlationId 11 from controller 0 for 6 partitions (state.change.logger)
[2022-05-03 18:25:36,250] INFO [Broker id=4] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 12 (state.change.logger)
[2022-05-03 18:25:36,441] INFO [Broker id=5] Add 12 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 0 (state.change.logger)
[2022-05-03 18:25:36,463] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:36,493] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-1 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,497] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-0 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,497] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-5 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,497] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition novotopico-3 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,497] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-4 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,498] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-5 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,498] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-0 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,498] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-2 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,498] ERROR [Broker id=5] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 23 for partition Sensor-1 (last update controller epoch 23) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-05-03 18:25:36,500] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 1 for 0 partitions (state.change.logger)
[2022-05-03 18:25:36,510] INFO [Broker id=5] Finished LeaderAndIsr request in 48ms correlationId 1 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:36,516] INFO [Broker id=5] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 2 (state.change.logger)
[2022-05-03 18:25:36,519] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 3 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:36,522] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 23 as part of the become-leader transition for 9 partitions (state.change.logger)
[2022-05-03 18:25:36,528] INFO [Broker id=5] Leader novotopico-1 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,534] INFO [Broker id=5] Leader novotopico-0 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,537] INFO [Broker id=5] Leader novotopico-5 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,541] INFO [Broker id=5] Leader novotopico-3 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,543] INFO [Broker id=5] Leader Sensor-4 starts at leader epoch 24 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,546] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 30 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,549] INFO [Broker id=5] Leader Sensor-0 starts at leader epoch 24 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,551] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 30 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,553] INFO [Broker id=5] Leader Sensor-1 starts at leader epoch 24 from offset 0 with high watermark 0 ISR [5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:36,557] INFO [Broker id=5] Finished LeaderAndIsr request in 38ms correlationId 3 from controller 0 for 9 partitions (state.change.logger)
[2022-05-03 18:25:36,560] INFO [Broker id=5] Add 9 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 4 (state.change.logger)
[2022-05-03 18:25:37,532] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:25:37,534] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 19 (state.change.logger)
[2022-05-03 18:25:37,534] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 5 (state.change.logger)
[2022-05-03 18:25:37,534] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 13 (state.change.logger)
[2022-05-03 18:25:37,535] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 15 (state.change.logger)
[2022-05-03 18:25:37,546] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 7 partitions (state.change.logger)
[2022-05-03 18:25:37,548] INFO [Broker id=0] Add 7 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 20 (state.change.logger)
[2022-05-03 18:25:37,548] INFO [Broker id=5] Add 7 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 6 (state.change.logger)
[2022-05-03 18:25:37,548] INFO [Broker id=3] Add 7 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 16 (state.change.logger)
[2022-05-03 18:25:37,548] INFO [Broker id=4] Add 7 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 14 (state.change.logger)
[2022-05-03 18:25:38,048] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:25:38,050] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 21 (state.change.logger)
[2022-05-03 18:25:38,050] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 15 (state.change.logger)
[2022-05-03 18:25:38,050] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 17 (state.change.logger)
[2022-05-03 18:25:38,050] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 7 (state.change.logger)
[2022-05-03 18:25:38,059] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 8 partitions (state.change.logger)
[2022-05-03 18:25:38,061] INFO [Broker id=0] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 22 (state.change.logger)
[2022-05-03 18:25:38,061] INFO [Broker id=3] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 18 (state.change.logger)
[2022-05-03 18:25:38,061] INFO [Broker id=4] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 16 (state.change.logger)
[2022-05-03 18:25:38,061] INFO [Broker id=5] Add 8 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 8 (state.change.logger)
[2022-05-03 18:25:40,478] INFO [Controller id=0 epoch=23] Changed partition novotopico2-4 state from NonExistentPartition to NewPartition with assigned replicas 3,0,5 (state.change.logger)
[2022-05-03 18:25:40,478] INFO [Controller id=0 epoch=23] Changed partition novotopico2-3 state from NonExistentPartition to NewPartition with assigned replicas 5,3,4 (state.change.logger)
[2022-05-03 18:25:40,478] INFO [Controller id=0 epoch=23] Changed partition novotopico2-2 state from NonExistentPartition to NewPartition with assigned replicas 0,5,3 (state.change.logger)
[2022-05-03 18:25:40,478] INFO [Controller id=0 epoch=23] Changed partition novotopico2-0 state from NonExistentPartition to NewPartition with assigned replicas 3,4,0 (state.change.logger)
[2022-05-03 18:25:40,478] INFO [Controller id=0 epoch=23] Changed partition novotopico2-5 state from NonExistentPartition to NewPartition with assigned replicas 4,5,3 (state.change.logger)
[2022-05-03 18:25:40,478] INFO [Controller id=0 epoch=23] Changed partition novotopico2-1 state from NonExistentPartition to NewPartition with assigned replicas 4,0,5 (state.change.logger)
[2022-05-03 18:25:40,478] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:25:40,479] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:25:40,499] INFO [Controller id=0 epoch=23] Changed partition novotopico2-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 0, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Changed partition novotopico2-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Changed partition novotopico2-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Changed partition novotopico2-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Changed partition novotopico2-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Changed partition novotopico2-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 0, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:25:40,500] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 5 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:25:40,501] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:25:40,501] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 23 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:25:40,502] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 19 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:25:40,502] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 17 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:25:40,502] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:25:40,502] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 9 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:25:40,509] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 0 epoch 23 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:25:40,509] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 23 from controller 0 epoch 23 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:25:40,510] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 17 from controller 0 epoch 23 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:25:40,510] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 19 from controller 0 epoch 23 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:25:40,525] INFO [Broker id=4] Leader novotopico2-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,527] INFO [Broker id=5] Leader novotopico2-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,530] INFO [Broker id=0] Leader novotopico2-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,534] INFO [Broker id=3] Leader novotopico2-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,537] INFO [Broker id=4] Leader novotopico2-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,541] INFO [Broker id=5] Follower novotopico2-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,546] INFO [Broker id=0] Follower novotopico2-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,548] INFO [Broker id=4] Follower novotopico2-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,549] INFO [Broker id=5] Follower novotopico2-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,551] INFO [Broker id=3] Leader novotopico2-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,553] INFO [Broker id=0] Follower novotopico2-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,555] INFO [Broker id=5] Follower novotopico2-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,555] INFO [Broker id=4] Follower novotopico2-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,556] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 17 for 2 partitions (state.change.logger)
[2022-05-03 18:25:40,560] INFO [Broker id=0] Follower novotopico2-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,560] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 23 for 3 partitions (state.change.logger)
[2022-05-03 18:25:40,561] INFO [Broker id=4] Finished LeaderAndIsr request in 59ms correlationId 17 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:25:40,562] INFO [Broker id=5] Follower novotopico2-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,562] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 9 for 4 partitions (state.change.logger)
[2022-05-03 18:25:40,562] INFO [Broker id=3] Follower novotopico2-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,565] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 18 (state.change.logger)
[2022-05-03 18:25:40,567] INFO [Broker id=0] Finished LeaderAndIsr request in 66ms correlationId 23 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:25:40,570] INFO [Broker id=3] Follower novotopico2-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,572] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 24 (state.change.logger)
[2022-05-03 18:25:40,577] INFO [Broker id=3] Follower novotopico2-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:25:40,578] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 19 for 3 partitions (state.change.logger)
[2022-05-03 18:25:40,582] INFO [Broker id=3] Finished LeaderAndIsr request in 81ms correlationId 19 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:25:40,587] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 20 (state.change.logger)
[2022-05-03 18:25:40,624] INFO [Broker id=5] Finished LeaderAndIsr request in 122ms correlationId 9 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:25:40,628] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 10 (state.change.logger)
[2022-05-03 18:29:54,276] INFO [Controller id=0 epoch=23] Changed partition novotopico3-5 state from NonExistentPartition to NewPartition with assigned replicas 3,4,0 (state.change.logger)
[2022-05-03 18:29:54,276] INFO [Controller id=0 epoch=23] Changed partition novotopico3-1 state from NonExistentPartition to NewPartition with assigned replicas 3,5,4 (state.change.logger)
[2022-05-03 18:29:54,276] INFO [Controller id=0 epoch=23] Changed partition novotopico3-4 state from NonExistentPartition to NewPartition with assigned replicas 5,3,4 (state.change.logger)
[2022-05-03 18:29:54,276] INFO [Controller id=0 epoch=23] Changed partition novotopico3-3 state from NonExistentPartition to NewPartition with assigned replicas 0,4,5 (state.change.logger)
[2022-05-03 18:29:54,276] INFO [Controller id=0 epoch=23] Changed partition novotopico3-0 state from NonExistentPartition to NewPartition with assigned replicas 5,0,3 (state.change.logger)
[2022-05-03 18:29:54,276] INFO [Controller id=0 epoch=23] Changed partition novotopico3-2 state from NonExistentPartition to NewPartition with assigned replicas 4,3,0 (state.change.logger)
[2022-05-03 18:29:54,276] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:29:54,277] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Changed partition novotopico3-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Changed partition novotopico3-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 5, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Changed partition novotopico3-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Changed partition novotopico3-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 4, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Changed partition novotopico3-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 0, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Changed partition novotopico3-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 3, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:29:54,287] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:29:54,288] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:29:54,288] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:29:54,288] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 21 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:29:54,289] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 19 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:29:54,289] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 25 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:29:54,289] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 11 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:29:54,289] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:29:54,293] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 25 from controller 0 epoch 23 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:29:54,294] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 21 from controller 0 epoch 23 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:29:54,296] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 0 epoch 23 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:29:54,296] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 19 from controller 0 epoch 23 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:29:54,301] INFO [Broker id=0] Leader novotopico3-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,4,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,302] INFO [Broker id=3] Leader novotopico3-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,5,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,304] INFO [Broker id=4] Leader novotopico3-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,3,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,304] INFO [Broker id=5] Leader novotopico3-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,0,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,310] INFO [Broker id=0] Follower novotopico3-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,311] INFO [Broker id=3] Leader novotopico3-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,314] INFO [Broker id=5] Leader novotopico3-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,314] INFO [Broker id=4] Follower novotopico3-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,317] INFO [Broker id=0] Follower novotopico3-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,320] INFO [Broker id=4] Follower novotopico3-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,320] INFO [Broker id=3] Follower novotopico3-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,323] INFO [Broker id=0] Follower novotopico3-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,323] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 25 for 3 partitions (state.change.logger)
[2022-05-03 18:29:54,324] INFO [Broker id=5] Follower novotopico3-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,325] INFO [Broker id=0] Finished LeaderAndIsr request in 36ms correlationId 25 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:29:54,326] INFO [Broker id=4] Follower novotopico3-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,326] INFO [Broker id=3] Follower novotopico3-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,327] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 26 (state.change.logger)
[2022-05-03 18:29:54,330] INFO [Broker id=5] Follower novotopico3-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,330] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 11 for 2 partitions (state.change.logger)
[2022-05-03 18:29:54,332] INFO [Broker id=5] Finished LeaderAndIsr request in 43ms correlationId 11 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:29:54,333] INFO [Broker id=3] Follower novotopico3-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,333] INFO [Broker id=4] Follower novotopico3-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:29:54,333] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 21 for 3 partitions (state.change.logger)
[2022-05-03 18:29:54,333] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 19 for 4 partitions (state.change.logger)
[2022-05-03 18:29:54,334] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 12 (state.change.logger)
[2022-05-03 18:29:54,335] INFO [Broker id=3] Finished LeaderAndIsr request in 47ms correlationId 21 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:29:54,337] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 22 (state.change.logger)
[2022-05-03 18:29:54,338] INFO [Broker id=4] Finished LeaderAndIsr request in 50ms correlationId 19 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:29:54,340] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 20 (state.change.logger)
[2022-05-03 18:30:16,465] INFO [Controller id=0 epoch=23] Changed partition novotopico-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(5, 0, 3), zkVersion=8) (state.change.logger)
[2022-05-03 18:30:16,465] INFO [Controller id=0 epoch=23] Changed partition Sensor-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=25, isr=List(5, 0, 3), zkVersion=35) (state.change.logger)
[2022-05-03 18:30:16,465] INFO [Controller id=0 epoch=23] Changed partition novotopico-4 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=5, isr=List(4, 0, 3), zkVersion=7) (state.change.logger)
[2022-05-03 18:30:16,465] INFO [Controller id=0 epoch=23] Changed partition Sensor-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=25, isr=List(5, 0, 4), zkVersion=35) (state.change.logger)
[2022-05-03 18:30:16,465] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 4 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,466] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 3 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,466] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,466] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,467] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 27 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:30:16,467] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 4 partitions (state.change.logger)
[2022-05-03 18:30:16,467] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 23 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:30:16,467] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 21 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,467] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 13 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:30:16,468] INFO [Broker id=3] Follower novotopico-0 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:30:16,468] INFO [Broker id=3] Follower novotopico-4 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was 4. (state.change.logger)
[2022-05-03 18:30:16,468] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was 24. (state.change.logger)
[2022-05-03 18:30:16,468] INFO [Broker id=4] Follower novotopico-4 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was 4. (state.change.logger)
[2022-05-03 18:30:16,468] INFO [Broker id=5] Follower novotopico-0 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:30:16,469] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was 24. (state.change.logger)
[2022-05-03 18:30:16,469] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was 24. (state.change.logger)
[2022-05-03 18:30:16,469] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 27 from controller 0 epoch 23 as part of the become-leader transition for 4 partitions (state.change.logger)
[2022-05-03 18:30:16,469] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was 24. (state.change.logger)
[2022-05-03 18:30:16,469] INFO [Broker id=0] Leader novotopico-0 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [5,0,3] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:30:16,470] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 23 for 3 partitions (state.change.logger)
[2022-05-03 18:30:16,470] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 13 for 3 partitions (state.change.logger)
[2022-05-03 18:30:16,470] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 21 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,471] INFO [Broker id=3] Finished LeaderAndIsr request in 4ms correlationId 23 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:30:16,473] INFO [Broker id=0] Leader novotopico-4 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [4,0,3] addingReplicas [] removingReplicas []. Previous leader epoch was 4. (state.change.logger)
[2022-05-03 18:30:16,473] INFO [Broker id=3] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 24 (state.change.logger)
[2022-05-03 18:30:16,474] INFO [Controller id=0 epoch=23] Changed partition novotopico-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=5, isr=List(4, 3, 0), zkVersion=7) (state.change.logger)
[2022-05-03 18:30:16,475] INFO [Controller id=0 epoch=23] Changed partition Sensor-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=31, isr=List(5, 3, 4), zkVersion=45) (state.change.logger)
[2022-05-03 18:30:16,475] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,475] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,476] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,476] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,477] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,477] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 25 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,477] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 25 from offset 0 with high watermark 0 ISR [5,0,3] addingReplicas [] removingReplicas []. Previous leader epoch was 24. (state.change.logger)
[2022-05-03 18:30:16,477] INFO [Broker id=4] Finished LeaderAndIsr request in 10ms correlationId 21 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,478] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 25 from controller 0 epoch 23 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,479] INFO [Broker id=3] Leader novotopico-2 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [4,3,0] addingReplicas [] removingReplicas []. Previous leader epoch was 4. (state.change.logger)
[2022-05-03 18:30:16,480] INFO [Broker id=5] Finished LeaderAndIsr request in 13ms correlationId 13 from controller 0 for 3 partitions (state.change.logger)
[2022-05-03 18:30:16,480] INFO [Broker id=4] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 22 (state.change.logger)
[2022-05-03 18:30:16,480] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 25 from offset 0 with high watermark 0 ISR [5,0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 24. (state.change.logger)
[2022-05-03 18:30:16,482] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 23 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,482] INFO [Broker id=4] Follower novotopico-2 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was 4. (state.change.logger)
[2022-05-03 18:30:16,482] INFO [Broker id=5] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 14 (state.change.logger)
[2022-05-03 18:30:16,482] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 31 from offset 0 with high watermark 0. Previous leader epoch was 30. (state.change.logger)
[2022-05-03 18:30:16,482] INFO [Broker id=3] Leader Sensor-2 starts at leader epoch 31 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was 30. (state.change.logger)
[2022-05-03 18:30:16,483] INFO [Controller id=0 epoch=23] Changed partition novotopico-3 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=6, isr=List(5, 0, 4), zkVersion=8) (state.change.logger)
[2022-05-03 18:30:16,483] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,483] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 23 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,484] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,484] INFO [Controller id=0 epoch=23] Sending LeaderAndIsr request to broker 5 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-05-03 18:30:16,484] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,484] INFO [Broker id=0] Finished LeaderAndIsr request in 17ms correlationId 27 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:30:16,484] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,484] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 31 from offset 0 with high watermark 0. Previous leader epoch was 30. (state.change.logger)
[2022-05-03 18:30:16,485] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 15 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,486] INFO [Broker id=3] Finished LeaderAndIsr request in 9ms correlationId 25 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,486] INFO [Broker id=0] Add 4 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 28 (state.change.logger)
[2022-05-03 18:30:16,487] INFO [Broker id=4] Finished LeaderAndIsr request in 6ms correlationId 23 from controller 0 for 2 partitions (state.change.logger)
[2022-05-03 18:30:16,488] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 29 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,488] INFO [Broker id=3] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 26 (state.change.logger)
[2022-05-03 18:30:16,489] INFO [Broker id=0] Follower novotopico-2 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was 4. (state.change.logger)
[2022-05-03 18:30:16,489] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 29 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,489] INFO [Broker id=5] Finished LeaderAndIsr request in 5ms correlationId 15 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,490] INFO [Broker id=4] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 24 (state.change.logger)
[2022-05-03 18:30:16,490] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 29 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,490] INFO [Broker id=3] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 27 (state.change.logger)
[2022-05-03 18:30:16,491] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 25 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,491] INFO [Broker id=5] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 16 (state.change.logger)
[2022-05-03 18:30:16,491] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 30 (state.change.logger)
[2022-05-03 18:30:16,492] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 25 from controller 0 epoch 23 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,492] INFO [Broker id=4] Leader novotopico-3 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [5,0,4] addingReplicas [] removingReplicas []. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:30:16,492] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 31 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,493] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,493] INFO [Broker id=5] Follower novotopico-3 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:30:16,493] INFO [Broker id=0] Follower novotopico-3 starts at leader epoch 6 from offset 0 with high watermark 0. Previous leader epoch was 5. (state.change.logger)
[2022-05-03 18:30:16,493] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 17 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,494] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 23 with correlation id 31 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,494] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 31 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,496] INFO [Broker id=5] Finished LeaderAndIsr request in 4ms correlationId 17 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,496] INFO [Broker id=4] Finished LeaderAndIsr request in 5ms correlationId 25 from controller 0 for 1 partitions (state.change.logger)
[2022-05-03 18:30:16,496] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 32 (state.change.logger)
[2022-05-03 18:30:16,497] INFO [Broker id=5] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 18 (state.change.logger)
[2022-05-03 18:30:16,498] INFO [Broker id=4] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 26 (state.change.logger)
[2022-05-03 18:31:30,217] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,217] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,218] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:31:30,220] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 33 (state.change.logger)
[2022-05-03 18:31:30,221] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 19 (state.change.logger)
[2022-05-03 18:31:30,222] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 27 (state.change.logger)
[2022-05-03 18:31:30,222] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 28 (state.change.logger)
[2022-05-03 18:31:30,229] INFO [Controller id=0 epoch=23] Partition novotopico3-3 state changed to (Leader:-1,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,229] INFO [Controller id=0 epoch=23] Partition novotopico3-5 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,229] INFO [Controller id=0 epoch=23] Partition novotopico3-0 state changed to (Leader:5,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,229] INFO [Controller id=0 epoch=23] Partition novotopico3-2 state changed to (Leader:4,ISR:4,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,235] INFO [Controller id=0 epoch=23] Partition novotopico3-4 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,235] INFO [Controller id=0 epoch=23] Partition novotopico3-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,235] INFO [Controller id=0 epoch=23] Partition novotopico3-0 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,235] INFO [Controller id=0 epoch=23] Partition novotopico3-1 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,241] INFO [Controller id=0 epoch=23] Partition novotopico3-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,241] INFO [Controller id=0 epoch=23] Partition novotopico3-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,241] INFO [Controller id=0 epoch=23] Partition novotopico3-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,241] INFO [Controller id=0 epoch=23] Partition novotopico3-0 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,241] INFO [Controller id=0 epoch=23] Partition novotopico3-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,244] INFO [Controller id=0 epoch=23] Partition novotopico3-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,244] INFO [Controller id=0 epoch=23] Partition novotopico3-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,244] INFO [Controller id=0 epoch=23] Partition novotopico3-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,244] INFO [Controller id=0 epoch=23] Partition novotopico3-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,244] INFO [Controller id=0 epoch=23] Partition novotopico3-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:31:30,244] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,245] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:31:30,246] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:31:30,246] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:31:30,246] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Broker id=0] Handling StopReplica request correlationId 34 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Broker id=4] Handling StopReplica request correlationId 28 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Broker id=5] Handling StopReplica request correlationId 20 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:31:30,248] INFO [Broker id=3] Handling StopReplica request correlationId 29 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:31:30,258] INFO [Broker id=0] Handling StopReplica request correlationId 35 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:31:30,258] INFO [Broker id=3] Handling StopReplica request correlationId 30 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:31:30,259] INFO [Broker id=4] Handling StopReplica request correlationId 29 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:31:30,260] INFO [Broker id=5] Handling StopReplica request correlationId 21 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:31:30,305] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,306] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,308] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,309] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:31:30,312] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,034] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,034] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,035] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:32:06,036] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 31 (state.change.logger)
[2022-05-03 18:32:06,036] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 36 (state.change.logger)
[2022-05-03 18:32:06,036] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 30 (state.change.logger)
[2022-05-03 18:32:06,037] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 22 (state.change.logger)
[2022-05-03 18:32:06,042] INFO [Controller id=0 epoch=23] Partition novotopico2-2 state changed to (Leader:-1,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,042] INFO [Controller id=0 epoch=23] Partition novotopico2-4 state changed to (Leader:3,ISR:3,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,042] INFO [Controller id=0 epoch=23] Partition novotopico2-1 state changed to (Leader:4,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,042] INFO [Controller id=0 epoch=23] Partition novotopico2-0 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,047] INFO [Controller id=0 epoch=23] Partition novotopico2-4 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,047] INFO [Controller id=0 epoch=23] Partition novotopico2-3 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,047] INFO [Controller id=0 epoch=23] Partition novotopico2-2 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,047] INFO [Controller id=0 epoch=23] Partition novotopico2-5 state changed to (Leader:4,ISR:4,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,047] INFO [Controller id=0 epoch=23] Partition novotopico2-1 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,052] INFO [Controller id=0 epoch=23] Partition novotopico2-4 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,052] INFO [Controller id=0 epoch=23] Partition novotopico2-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,052] INFO [Controller id=0 epoch=23] Partition novotopico2-2 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,052] INFO [Controller id=0 epoch=23] Partition novotopico2-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,052] INFO [Controller id=0 epoch=23] Partition novotopico2-5 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Partition novotopico2-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Partition novotopico2-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Partition novotopico2-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Partition novotopico2-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Broker id=0] Handling StopReplica request correlationId 37 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,056] INFO [Broker id=3] Handling StopReplica request correlationId 32 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:06,057] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:32:06,057] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:32:06,057] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:32:06,057] INFO [Broker id=5] Handling StopReplica request correlationId 23 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:06,057] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:32:06,057] INFO [Broker id=4] Handling StopReplica request correlationId 31 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:06,059] INFO [Broker id=0] Handling StopReplica request correlationId 38 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:06,059] INFO [Broker id=3] Handling StopReplica request correlationId 33 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:06,060] INFO [Broker id=4] Handling StopReplica request correlationId 32 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:06,060] INFO [Broker id=5] Handling StopReplica request correlationId 24 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:06,078] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,081] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,082] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,086] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:06,087] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,088] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,089] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,089] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:32:27,090] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 39 (state.change.logger)
[2022-05-03 18:32:27,090] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 34 (state.change.logger)
[2022-05-03 18:32:27,090] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 25 (state.change.logger)
[2022-05-03 18:32:27,090] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 33 (state.change.logger)
[2022-05-03 18:32:27,096] INFO [Controller id=0 epoch=23] Partition novotopico-2 state changed to (Leader:3,ISR:4,3,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,096] INFO [Controller id=0 epoch=23] Partition novotopico-4 state changed to (Leader:-1,ISR:4,3,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,096] INFO [Controller id=0 epoch=23] Partition novotopico-5 state changed to (Leader:5,ISR:5,4,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,096] INFO [Controller id=0 epoch=23] Partition novotopico-3 state changed to (Leader:4,ISR:5,4,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,096] INFO [Controller id=0 epoch=23] Partition novotopico-0 state changed to (Leader:-1,ISR:5,3,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,100] INFO [Controller id=0 epoch=23] Partition novotopico-0 state changed to (Leader:-1,ISR:3,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,100] INFO [Controller id=0 epoch=23] Partition novotopico-1 state changed to (Leader:-1,ISR:4,3,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,100] INFO [Controller id=0 epoch=23] Partition novotopico-3 state changed to (Leader:4,ISR:4,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,100] INFO [Controller id=0 epoch=23] Partition novotopico-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,104] INFO [Controller id=0 epoch=23] Partition novotopico-0 state changed to (Leader:-1,ISR:3,LeaderEpoch:9,ZkVersion:11,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,104] INFO [Controller id=0 epoch=23] Partition novotopico-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,104] INFO [Controller id=0 epoch=23] Partition novotopico-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,104] INFO [Controller id=0 epoch=23] Partition novotopico-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,107] INFO [Controller id=0 epoch=23] Partition novotopico-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Partition novotopico-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Partition novotopico-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Partition novotopico-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Partition novotopico-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:9,ZkVersion:11,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Broker id=0] Handling StopReplica request correlationId 40 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Broker id=4] Handling StopReplica request correlationId 34 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Broker id=5] Handling StopReplica request correlationId 26 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Broker id=3] Handling StopReplica request correlationId 35 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:32:27,108] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:32:27,110] INFO [Broker id=0] Handling StopReplica request correlationId 41 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:27,110] INFO [Broker id=5] Handling StopReplica request correlationId 27 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:27,111] INFO [Broker id=3] Handling StopReplica request correlationId 36 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:27,112] INFO [Broker id=4] Handling StopReplica request correlationId 35 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:27,134] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,138] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,142] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,143] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:27,144] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,233] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,233] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,233] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:32:44,234] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 42 (state.change.logger)
[2022-05-03 18:32:44,234] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 37 (state.change.logger)
[2022-05-03 18:32:44,234] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 28 (state.change.logger)
[2022-05-03 18:32:44,234] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 23 with correlation id 36 (state.change.logger)
[2022-05-03 18:32:44,238] INFO [Controller id=0 epoch=23] Partition Sensor-4 state changed to (Leader:-1,ISR:5,3,LeaderEpoch:26,ZkVersion:36,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,238] INFO [Controller id=0 epoch=23] Partition Sensor-3 state changed to (Leader:4,ISR:4,3,LeaderEpoch:25,ZkVersion:35,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,238] INFO [Controller id=0 epoch=23] Partition Sensor-0 state changed to (Leader:-1,ISR:5,4,LeaderEpoch:26,ZkVersion:36,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,238] INFO [Controller id=0 epoch=23] Partition Sensor-1 state changed to (Leader:5,ISR:5,3,LeaderEpoch:25,ZkVersion:35,ControllerEpoch:23) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,242] INFO [Controller id=0 epoch=23] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:27,ZkVersion:37,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,243] INFO [Controller id=0 epoch=23] Partition Sensor-5 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:31,ZkVersion:45,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,243] INFO [Controller id=0 epoch=23] Partition Sensor-2 state changed to (Leader:3,ISR:3,4,LeaderEpoch:32,ZkVersion:46,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,243] INFO [Controller id=0 epoch=23] Partition Sensor-1 state changed to (Leader:-1,ISR:3,LeaderEpoch:26,ZkVersion:36,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,243] INFO [Controller id=0 epoch=23] Partition Sensor-4 state changed to (Leader:-1,ISR:3,LeaderEpoch:27,ZkVersion:37,ControllerEpoch:23) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,247] INFO [Controller id=0 epoch=23] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:32,ZkVersion:46,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,247] INFO [Controller id=0 epoch=23] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:33,ZkVersion:47,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,247] INFO [Controller id=0 epoch=23] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:26,ZkVersion:36,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,247] INFO [Controller id=0 epoch=23] Partition Sensor-1 state changed to (Leader:-1,ISR:3,LeaderEpoch:27,ZkVersion:37,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,247] INFO [Controller id=0 epoch=23] Partition Sensor-4 state changed to (Leader:-1,ISR:3,LeaderEpoch:28,ZkVersion:38,ControllerEpoch:23) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,250] INFO [Controller id=0 epoch=23] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:33,ZkVersion:47,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:34,ZkVersion:48,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Partition Sensor-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:27,ZkVersion:37,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:28,ZkVersion:38,ControllerEpoch:23) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Broker id=0] Handling StopReplica request correlationId 43 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Broker id=5] Handling StopReplica request correlationId 29 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Broker id=3] Handling StopReplica request correlationId 38 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Broker id=4] Handling StopReplica request correlationId 37 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,251] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:32:44,252] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:32:44,252] INFO [Controller id=0 epoch=23] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:32:44,252] INFO [Controller id=0 epoch=23] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:32:44,254] INFO [Broker id=0] Handling StopReplica request correlationId 44 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:44,254] INFO [Broker id=4] Handling StopReplica request correlationId 38 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:32:44,254] INFO [Broker id=3] Handling StopReplica request correlationId 39 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:44,263] INFO [Broker id=5] Handling StopReplica request correlationId 30 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:32:44,280] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,290] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,292] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,293] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:32:44,293] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:33:11,301] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:33:11,303] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:33:11,304] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:33:11,304] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:33:12,028] INFO [Controller id=0 epoch=23] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:33:12,589] INFO [Controller id=4 epoch=24] Sending UpdateMetadata request to brokers HashSet(3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:33:12,674] INFO [Controller id=3 epoch=25] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:34:10,480] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:34:25,815] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:34:25,816] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:34:30,446] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:34:30,446] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:34:35,613] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:34:35,613] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:34:39,795] INFO [Controller id=0 epoch=26] Changed partition novotopico3-5 state from NonExistentPartition to NewPartition with assigned replicas 5,4,0 (state.change.logger)
[2022-05-03 18:34:39,795] INFO [Controller id=0 epoch=26] Changed partition novotopico3-1 state from NonExistentPartition to NewPartition with assigned replicas 5,3,4 (state.change.logger)
[2022-05-03 18:34:39,795] INFO [Controller id=0 epoch=26] Changed partition novotopico3-4 state from NonExistentPartition to NewPartition with assigned replicas 0,3,4 (state.change.logger)
[2022-05-03 18:34:39,795] INFO [Controller id=0 epoch=26] Changed partition novotopico3-3 state from NonExistentPartition to NewPartition with assigned replicas 4,0,5 (state.change.logger)
[2022-05-03 18:34:39,795] INFO [Controller id=0 epoch=26] Changed partition novotopico3-0 state from NonExistentPartition to NewPartition with assigned replicas 0,5,3 (state.change.logger)
[2022-05-03 18:34:39,795] INFO [Controller id=0 epoch=26] Changed partition novotopico3-2 state from NonExistentPartition to NewPartition with assigned replicas 3,4,0 (state.change.logger)
[2022-05-03 18:34:39,795] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:34:39,799] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:34:39,826] INFO [Controller id=0 epoch=26] Changed partition novotopico3-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:34:39,826] INFO [Controller id=0 epoch=26] Changed partition novotopico3-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:34:39,826] INFO [Controller id=0 epoch=26] Changed partition novotopico3-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:34:39,826] INFO [Controller id=0 epoch=26] Changed partition novotopico3-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 0, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:34:39,826] INFO [Controller id=0 epoch=26] Changed partition novotopico3-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:34:39,826] INFO [Controller id=0 epoch=26] Changed partition novotopico3-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:34:39,829] INFO [Controller id=0 epoch=26] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:34:39,830] INFO [Controller id=0 epoch=26] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:34:39,831] INFO [Controller id=0 epoch=26] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:34:39,831] INFO [Controller id=0 epoch=26] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:34:39,831] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:34:39,833] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:34:39,838] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:34:39,839] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:34:39,839] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:34:39,840] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 2 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:34:39,873] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 26 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:34:39,874] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 26 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:34:39,877] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 26 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:34:39,880] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 26 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:34:39,940] INFO [Broker id=5] Leader novotopico3-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,946] INFO [Broker id=3] Leader novotopico3-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,947] INFO [Broker id=0] Leader novotopico3-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,949] INFO [Broker id=4] Leader novotopico3-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,963] INFO [Broker id=5] Leader novotopico3-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,968] INFO [Broker id=0] Leader novotopico3-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,975] INFO [Broker id=3] Follower novotopico3-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,979] INFO [Broker id=4] Follower novotopico3-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,985] INFO [Broker id=3] Follower novotopico3-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,985] INFO [Broker id=5] Follower novotopico3-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,987] INFO [Broker id=0] Follower novotopico3-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,993] INFO [Broker id=4] Follower novotopico3-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,994] INFO [Broker id=5] Follower novotopico3-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,994] INFO [Broker id=3] Follower novotopico3-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:39,996] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 26 with correlation id 1 for 2 partitions (state.change.logger)
[2022-05-03 18:34:39,996] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 26 with correlation id 3 for 3 partitions (state.change.logger)
[2022-05-03 18:34:39,997] INFO [Broker id=0] Follower novotopico3-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:40,005] INFO [Broker id=4] Follower novotopico3-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:40,007] INFO [Broker id=0] Follower novotopico3-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:40,010] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 26 with correlation id 4 for 3 partitions (state.change.logger)
[2022-05-03 18:34:40,015] INFO [Broker id=4] Follower novotopico3-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:34:40,016] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 26 with correlation id 2 for 4 partitions (state.change.logger)
[2022-05-03 18:34:40,115] INFO [Broker id=3] Finished LeaderAndIsr request in 276ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:34:40,119] INFO [Broker id=5] Finished LeaderAndIsr request in 278ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:34:40,154] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 2 (state.change.logger)
[2022-05-03 18:34:40,165] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 4 (state.change.logger)
[2022-05-03 18:34:40,168] INFO [Broker id=0] Finished LeaderAndIsr request in 322ms correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:34:40,180] INFO [Broker id=4] Finished LeaderAndIsr request in 341ms correlationId 2 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:34:40,190] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 5 (state.change.logger)
[2022-05-03 18:34:40,219] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 3 (state.change.logger)
[2022-05-03 18:35:15,627] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,627] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,629] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:35:15,631] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 6 (state.change.logger)
[2022-05-03 18:35:15,634] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 5 (state.change.logger)
[2022-05-03 18:35:15,634] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 3 (state.change.logger)
[2022-05-03 18:35:15,634] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 4 (state.change.logger)
[2022-05-03 18:35:15,656] INFO [Controller id=0 epoch=26] Partition novotopico3-5 state changed to (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,656] INFO [Controller id=0 epoch=26] Partition novotopico3-4 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,656] INFO [Controller id=0 epoch=26] Partition novotopico3-3 state changed to (Leader:4,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,656] INFO [Controller id=0 epoch=26] Partition novotopico3-0 state changed to (Leader:-1,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,656] INFO [Controller id=0 epoch=26] Partition novotopico3-2 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,661] INFO [Controller id=0 epoch=26] Partition novotopico3-3 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:26) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,662] INFO [Controller id=0 epoch=26] Partition novotopico3-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:26) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,662] INFO [Controller id=0 epoch=26] Partition novotopico3-0 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:26) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,662] INFO [Controller id=0 epoch=26] Partition novotopico3-1 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:26) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,666] INFO [Controller id=0 epoch=26] Partition novotopico3-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:26) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,666] INFO [Controller id=0 epoch=26] Partition novotopico3-0 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:26) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,666] INFO [Controller id=0 epoch=26] Partition novotopico3-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:26) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,666] INFO [Controller id=0 epoch=26] Partition novotopico3-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:26) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,672] INFO [Controller id=0 epoch=26] Partition novotopico3-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:26) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,672] INFO [Controller id=0 epoch=26] Partition novotopico3-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:26) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,672] INFO [Controller id=0 epoch=26] Partition novotopico3-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:26) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,672] INFO [Controller id=0 epoch=26] Partition novotopico3-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:26) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,672] INFO [Controller id=0 epoch=26] Partition novotopico3-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:26) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:35:15,672] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,673] INFO [Controller id=0 epoch=26] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:35:15,674] INFO [Controller id=0 epoch=26] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:35:15,674] INFO [Controller id=0 epoch=26] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:35:15,674] INFO [Controller id=0 epoch=26] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:35:15,675] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,676] INFO [Controller id=0 epoch=26] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:35:15,676] INFO [Controller id=0 epoch=26] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:35:15,676] INFO [Controller id=0 epoch=26] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:35:15,676] INFO [Controller id=0 epoch=26] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:35:15,676] INFO [Broker id=3] Handling StopReplica request correlationId 6 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:35:15,677] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:35:15,677] INFO [Broker id=4] Handling StopReplica request correlationId 5 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:35:15,677] INFO [Broker id=5] Handling StopReplica request correlationId 4 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:35:15,699] INFO [Broker id=5] Handling StopReplica request correlationId 5 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:35:15,700] INFO [Broker id=3] Handling StopReplica request correlationId 7 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:35:15,702] INFO [Broker id=0] Handling StopReplica request correlationId 8 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:35:15,707] INFO [Broker id=4] Handling StopReplica request correlationId 6 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:35:15,760] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,761] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,771] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,772] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:15,776] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:16,017] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:16,020] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:16,020] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:16,021] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:35:16,843] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0, 3, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:35:17,030] INFO [Controller id=3 epoch=27] Sending UpdateMetadata request to brokers HashSet(3, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:35:17,072] INFO [Controller id=3 epoch=27] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:35:46,147] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:36:01,016] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:36:01,017] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:36:06,099] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:36:06,100] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:36:11,114] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:36:11,115] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:37:48,964] INFO [Controller id=0 epoch=28] Changed partition Sensor-0 state from NonExistentPartition to NewPartition with assigned replicas 0,4,5 (state.change.logger)
[2022-05-03 18:37:48,964] INFO [Controller id=0 epoch=28] Changed partition Sensor-5 state from NonExistentPartition to NewPartition with assigned replicas 5,3,4 (state.change.logger)
[2022-05-03 18:37:48,965] INFO [Controller id=0 epoch=28] Changed partition Sensor-2 state from NonExistentPartition to NewPartition with assigned replicas 3,5,4 (state.change.logger)
[2022-05-03 18:37:48,965] INFO [Controller id=0 epoch=28] Changed partition Sensor-3 state from NonExistentPartition to NewPartition with assigned replicas 4,3,0 (state.change.logger)
[2022-05-03 18:37:48,965] INFO [Controller id=0 epoch=28] Changed partition Sensor-1 state from NonExistentPartition to NewPartition with assigned replicas 5,0,3 (state.change.logger)
[2022-05-03 18:37:48,965] INFO [Controller id=0 epoch=28] Changed partition Sensor-4 state from NonExistentPartition to NewPartition with assigned replicas 0,5,3 (state.change.logger)
[2022-05-03 18:37:48,965] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:37:48,969] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:37:48,999] INFO [Controller id=0 epoch=28] Changed partition Sensor-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 4, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:37:49,000] INFO [Controller id=0 epoch=28] Changed partition Sensor-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:37:49,000] INFO [Controller id=0 epoch=28] Changed partition Sensor-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 5, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:37:49,000] INFO [Controller id=0 epoch=28] Changed partition Sensor-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 3, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:37:49,000] INFO [Controller id=0 epoch=28] Changed partition Sensor-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 0, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:37:49,000] INFO [Controller id=0 epoch=28] Changed partition Sensor-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:37:49,002] INFO [Controller id=0 epoch=28] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:37:49,004] INFO [Controller id=0 epoch=28] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:37:49,005] INFO [Controller id=0 epoch=28] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:37:49,005] INFO [Controller id=0 epoch=28] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:37:49,006] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:37:49,009] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:37:49,013] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:37:49,013] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 2 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:37:49,014] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:37:49,014] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:37:49,047] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 28 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:37:49,051] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 28 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:37:49,053] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 28 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:37:49,056] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 28 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:37:49,109] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,113] INFO [Broker id=3] Leader Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,5,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,114] INFO [Broker id=4] Leader Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,3,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,115] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,126] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,4,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,137] INFO [Broker id=5] Leader Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,0,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,141] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,145] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,149] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,156] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,164] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,165] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,167] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,167] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,169] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 28 with correlation id 4 for 2 partitions (state.change.logger)
[2022-05-03 18:37:49,169] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 28 with correlation id 2 for 3 partitions (state.change.logger)
[2022-05-03 18:37:49,176] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,177] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,193] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,195] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 28 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:37:49,197] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:37:49,199] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 28 with correlation id 3 for 4 partitions (state.change.logger)
[2022-05-03 18:37:49,312] INFO [Broker id=0] Finished LeaderAndIsr request in 298ms correlationId 4 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:37:49,336] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 5 (state.change.logger)
[2022-05-03 18:37:49,341] INFO [Broker id=4] Finished LeaderAndIsr request in 329ms correlationId 2 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:37:49,367] INFO [Broker id=3] Finished LeaderAndIsr request in 351ms correlationId 3 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:37:49,370] INFO [Broker id=5] Finished LeaderAndIsr request in 339ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:37:49,384] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 3 (state.change.logger)
[2022-05-03 18:37:49,392] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 4 (state.change.logger)
[2022-05-03 18:37:49,407] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 2 (state.change.logger)
[2022-05-03 18:39:06,697] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,697] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,698] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:39:06,701] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 6 (state.change.logger)
[2022-05-03 18:39:06,701] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 3 (state.change.logger)
[2022-05-03 18:39:06,702] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 4 (state.change.logger)
[2022-05-03 18:39:06,703] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 5 (state.change.logger)
[2022-05-03 18:39:06,720] INFO [Controller id=0 epoch=28] Partition Sensor-4 state changed to (Leader:-1,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,720] INFO [Controller id=0 epoch=28] Partition Sensor-3 state changed to (Leader:4,ISR:4,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,720] INFO [Controller id=0 epoch=28] Partition Sensor-0 state changed to (Leader:-1,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,721] INFO [Controller id=0 epoch=28] Partition Sensor-1 state changed to (Leader:5,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,728] INFO [Controller id=0 epoch=28] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:28) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,728] INFO [Controller id=0 epoch=28] Partition Sensor-5 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:28) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,728] INFO [Controller id=0 epoch=28] Partition Sensor-2 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:28) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,728] INFO [Controller id=0 epoch=28] Partition Sensor-1 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:28) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,728] INFO [Controller id=0 epoch=28] Partition Sensor-4 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:28) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,735] INFO [Controller id=0 epoch=28] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:28) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,735] INFO [Controller id=0 epoch=28] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:28) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,735] INFO [Controller id=0 epoch=28] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:28) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,735] INFO [Controller id=0 epoch=28] Partition Sensor-1 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:28) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,735] INFO [Controller id=0 epoch=28] Partition Sensor-4 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:28) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,740] INFO [Controller id=0 epoch=28] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:28) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,740] INFO [Controller id=0 epoch=28] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:28) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,740] INFO [Controller id=0 epoch=28] Partition Sensor-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:28) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,740] INFO [Controller id=0 epoch=28] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:28) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:39:06,740] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,742] INFO [Controller id=0 epoch=28] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:39:06,743] INFO [Controller id=0 epoch=28] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:39:06,743] INFO [Controller id=0 epoch=28] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:39:06,743] INFO [Controller id=0 epoch=28] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:39:06,745] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:06,745] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,745] INFO [Controller id=0 epoch=28] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:39:06,745] INFO [Controller id=0 epoch=28] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:39:06,745] INFO [Controller id=0 epoch=28] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:39:06,745] INFO [Controller id=0 epoch=28] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:39:06,746] INFO [Broker id=4] Handling StopReplica request correlationId 5 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:06,746] INFO [Broker id=5] Handling StopReplica request correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:06,746] INFO [Broker id=3] Handling StopReplica request correlationId 6 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:06,762] INFO [Broker id=0] Handling StopReplica request correlationId 8 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:06,762] INFO [Broker id=5] Handling StopReplica request correlationId 5 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:06,763] INFO [Broker id=3] Handling StopReplica request correlationId 7 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:06,763] INFO [Broker id=4] Handling StopReplica request correlationId 6 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:06,819] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,823] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,824] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,828] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:06,831] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:07,085] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:07,088] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:07,088] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:07,089] INFO [Controller id=0 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:08,063] INFO [Controller id=4 epoch=29] Sending UpdateMetadata request to brokers HashSet(3, 4, 5) for 0 partitions (state.change.logger)
[2022-05-03 18:39:08,154] INFO [Controller id=3 epoch=30] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:39:22,721] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:39:37,672] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:39:37,673] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:39:42,671] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:39:42,671] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:39:47,689] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:39:47,689] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:39:52,014] INFO [Controller id=0 epoch=31] Changed partition Sensor-0 state from NonExistentPartition to NewPartition with assigned replicas 0,4,5 (state.change.logger)
[2022-05-03 18:39:52,014] INFO [Controller id=0 epoch=31] Changed partition Sensor-5 state from NonExistentPartition to NewPartition with assigned replicas 5,3,4 (state.change.logger)
[2022-05-03 18:39:52,014] INFO [Controller id=0 epoch=31] Changed partition Sensor-2 state from NonExistentPartition to NewPartition with assigned replicas 3,5,4 (state.change.logger)
[2022-05-03 18:39:52,014] INFO [Controller id=0 epoch=31] Changed partition Sensor-3 state from NonExistentPartition to NewPartition with assigned replicas 4,3,0 (state.change.logger)
[2022-05-03 18:39:52,014] INFO [Controller id=0 epoch=31] Changed partition Sensor-1 state from NonExistentPartition to NewPartition with assigned replicas 5,0,3 (state.change.logger)
[2022-05-03 18:39:52,014] INFO [Controller id=0 epoch=31] Changed partition Sensor-4 state from NonExistentPartition to NewPartition with assigned replicas 0,5,3 (state.change.logger)
[2022-05-03 18:39:52,014] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:52,017] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:52,045] INFO [Controller id=0 epoch=31] Changed partition Sensor-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 4, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:39:52,045] INFO [Controller id=0 epoch=31] Changed partition Sensor-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:39:52,045] INFO [Controller id=0 epoch=31] Changed partition Sensor-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 5, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:39:52,045] INFO [Controller id=0 epoch=31] Changed partition Sensor-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 3, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:39:52,045] INFO [Controller id=0 epoch=31] Changed partition Sensor-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 0, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:39:52,045] INFO [Controller id=0 epoch=31] Changed partition Sensor-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:39:52,048] INFO [Controller id=0 epoch=31] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:39:52,050] INFO [Controller id=0 epoch=31] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:39:52,051] INFO [Controller id=0 epoch=31] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:39:52,051] INFO [Controller id=0 epoch=31] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:39:52,051] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:39:52,054] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:39:52,056] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:52,058] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 2 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:52,058] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:52,058] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:52,080] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 31 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:39:52,085] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 31 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:39:52,089] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 31 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:39:52,090] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 31 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:39:52,124] INFO [Broker id=0] Leader Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,133] INFO [Broker id=5] Leader Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,136] INFO [Broker id=3] Leader Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,5,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,141] INFO [Broker id=0] Leader Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,4,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,145] INFO [Broker id=4] Leader Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,3,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,151] INFO [Broker id=5] Leader Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,0,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,159] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,159] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,164] INFO [Broker id=5] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,165] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,166] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,166] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,168] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 31 with correlation id 4 for 2 partitions (state.change.logger)
[2022-05-03 18:39:52,172] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,172] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,173] INFO [Broker id=3] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,179] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,179] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,180] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:39:52,181] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 31 with correlation id 2 for 3 partitions (state.change.logger)
[2022-05-03 18:39:52,181] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 31 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:39:52,182] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 31 with correlation id 3 for 4 partitions (state.change.logger)
[2022-05-03 18:39:52,240] INFO [Broker id=0] Finished LeaderAndIsr request in 184ms correlationId 4 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:52,261] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 5 (state.change.logger)
[2022-05-03 18:39:52,261] INFO [Broker id=5] Finished LeaderAndIsr request in 204ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:52,274] INFO [Broker id=3] Finished LeaderAndIsr request in 212ms correlationId 3 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:39:52,302] INFO [Broker id=4] Finished LeaderAndIsr request in 236ms correlationId 2 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:39:52,302] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 2 (state.change.logger)
[2022-05-03 18:39:52,306] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 4 (state.change.logger)
[2022-05-03 18:39:52,327] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 3 (state.change.logger)
[2022-05-03 18:40:24,288] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,289] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,290] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:40:24,292] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 6 (state.change.logger)
[2022-05-03 18:40:24,294] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 4 (state.change.logger)
[2022-05-03 18:40:24,295] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 3 (state.change.logger)
[2022-05-03 18:40:24,295] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 31 with correlation id 5 (state.change.logger)
[2022-05-03 18:40:24,318] INFO [Controller id=0 epoch=31] Partition Sensor-4 state changed to (Leader:-1,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:31) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,318] INFO [Controller id=0 epoch=31] Partition Sensor-3 state changed to (Leader:4,ISR:4,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:31) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,318] INFO [Controller id=0 epoch=31] Partition Sensor-0 state changed to (Leader:-1,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:31) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,318] INFO [Controller id=0 epoch=31] Partition Sensor-1 state changed to (Leader:5,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:31) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,326] INFO [Controller id=0 epoch=31] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:31) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,327] INFO [Controller id=0 epoch=31] Partition Sensor-5 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:31) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,327] INFO [Controller id=0 epoch=31] Partition Sensor-2 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:31) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,327] INFO [Controller id=0 epoch=31] Partition Sensor-1 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:31) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,327] INFO [Controller id=0 epoch=31] Partition Sensor-4 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:31) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,333] INFO [Controller id=0 epoch=31] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:31) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,333] INFO [Controller id=0 epoch=31] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:31) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,333] INFO [Controller id=0 epoch=31] Partition Sensor-3 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:31) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,333] INFO [Controller id=0 epoch=31] Partition Sensor-1 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:31) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,333] INFO [Controller id=0 epoch=31] Partition Sensor-4 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:31) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,338] INFO [Controller id=0 epoch=31] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:31) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,338] INFO [Controller id=0 epoch=31] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:31) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,338] INFO [Controller id=0 epoch=31] Partition Sensor-3 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:31) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,338] INFO [Controller id=0 epoch=31] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:31) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:40:24,338] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,339] INFO [Controller id=0 epoch=31] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:40:24,340] INFO [Controller id=0 epoch=31] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:40:24,340] INFO [Controller id=0 epoch=31] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:40:24,340] INFO [Controller id=0 epoch=31] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:40:24,342] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,342] INFO [Controller id=0 epoch=31] Sending StopReplica request for 4 replicas to broker 0 (state.change.logger)
[2022-05-03 18:40:24,342] INFO [Controller id=0 epoch=31] Sending StopReplica request for 5 replicas to broker 3 (state.change.logger)
[2022-05-03 18:40:24,342] INFO [Controller id=0 epoch=31] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:40:24,342] INFO [Controller id=0 epoch=31] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:40:24,343] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:40:24,343] INFO [Broker id=5] Handling StopReplica request correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:40:24,343] INFO [Broker id=4] Handling StopReplica request correlationId 5 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:40:24,343] INFO [Broker id=3] Handling StopReplica request correlationId 6 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:40:24,358] INFO [Broker id=0] Handling StopReplica request correlationId 8 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:40:24,360] INFO [Broker id=4] Handling StopReplica request correlationId 6 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:40:24,362] INFO [Broker id=5] Handling StopReplica request correlationId 5 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:40:24,363] INFO [Broker id=3] Handling StopReplica request correlationId 7 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:40:24,429] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,435] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,439] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,440] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,444] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,688] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,690] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,691] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:24,692] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:40:25,690] INFO [Controller id=0 epoch=31] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:40:25,898] INFO [Controller id=4 epoch=32] Sending UpdateMetadata request to brokers HashSet(3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:42:31,276] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:42:46,199] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:42:46,200] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:42:51,243] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:42:51,244] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:42:56,236] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:42:56,236] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:43:00,469] INFO [Controller id=0 epoch=33] Changed partition Sensor-0 state from NonExistentPartition to NewPartition with assigned replicas 5,3,4 (state.change.logger)
[2022-05-03 18:43:00,469] INFO [Controller id=0 epoch=33] Changed partition Sensor-5 state from NonExistentPartition to NewPartition with assigned replicas 3,0,5 (state.change.logger)
[2022-05-03 18:43:00,469] INFO [Controller id=0 epoch=33] Changed partition Sensor-2 state from NonExistentPartition to NewPartition with assigned replicas 4,0,5 (state.change.logger)
[2022-05-03 18:43:00,469] INFO [Controller id=0 epoch=33] Changed partition Sensor-3 state from NonExistentPartition to NewPartition with assigned replicas 0,5,3 (state.change.logger)
[2022-05-03 18:43:00,469] INFO [Controller id=0 epoch=33] Changed partition Sensor-1 state from NonExistentPartition to NewPartition with assigned replicas 3,4,0 (state.change.logger)
[2022-05-03 18:43:00,469] INFO [Controller id=0 epoch=33] Changed partition Sensor-4 state from NonExistentPartition to NewPartition with assigned replicas 5,4,0 (state.change.logger)
[2022-05-03 18:43:00,469] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:43:00,472] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:43:00,502] INFO [Controller id=0 epoch=33] Changed partition Sensor-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:43:00,502] INFO [Controller id=0 epoch=33] Changed partition Sensor-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 0, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:43:00,502] INFO [Controller id=0 epoch=33] Changed partition Sensor-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 0, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:43:00,502] INFO [Controller id=0 epoch=33] Changed partition Sensor-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:43:00,502] INFO [Controller id=0 epoch=33] Changed partition Sensor-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:43:00,502] INFO [Controller id=0 epoch=33] Changed partition Sensor-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:43:00,505] INFO [Controller id=0 epoch=33] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 4 become-follower partitions (state.change.logger)
[2022-05-03 18:43:00,507] INFO [Controller id=0 epoch=33] Sending LeaderAndIsr request to broker 3 with 2 become-leader and 2 become-follower partitions (state.change.logger)
[2022-05-03 18:43:00,507] INFO [Controller id=0 epoch=33] Sending LeaderAndIsr request to broker 4 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:43:00,508] INFO [Controller id=0 epoch=33] Sending LeaderAndIsr request to broker 5 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:43:00,508] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:43:00,511] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:43:00,514] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:43:00,515] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 2 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:43:00,516] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:43:00,516] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:43:00,541] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 33 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:43:00,542] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 33 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:43:00,548] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 33 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:43:00,552] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 33 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:43:00,586] INFO [Broker id=4] Leader Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,586] INFO [Broker id=3] Leader Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,600] INFO [Broker id=0] Leader Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,603] INFO [Broker id=3] Leader Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,607] INFO [Broker id=5] Leader Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,608] INFO [Broker id=4] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,616] INFO [Broker id=4] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,621] INFO [Broker id=3] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,622] INFO [Broker id=5] Leader Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,624] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,625] INFO [Broker id=4] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,626] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 33 with correlation id 2 for 3 partitions (state.change.logger)
[2022-05-03 18:43:00,630] INFO [Broker id=3] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,632] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 33 with correlation id 3 for 2 partitions (state.change.logger)
[2022-05-03 18:43:00,633] INFO [Broker id=0] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,641] INFO [Broker id=0] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,641] INFO [Broker id=5] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,648] INFO [Broker id=0] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,648] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,649] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 33 with correlation id 4 for 4 partitions (state.change.logger)
[2022-05-03 18:43:00,657] INFO [Broker id=5] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:43:00,659] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 33 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:43:00,712] INFO [Broker id=4] Finished LeaderAndIsr request in 198ms correlationId 2 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:43:00,716] INFO [Broker id=3] Finished LeaderAndIsr request in 201ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:43:00,734] INFO [Broker id=0] Finished LeaderAndIsr request in 220ms correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:43:00,734] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 3 (state.change.logger)
[2022-05-03 18:43:00,747] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 4 (state.change.logger)
[2022-05-03 18:43:00,757] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 5 (state.change.logger)
[2022-05-03 18:43:00,833] INFO [Broker id=5] Finished LeaderAndIsr request in 304ms correlationId 1 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:43:00,851] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 2 (state.change.logger)
[2022-05-03 18:46:38,206] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,206] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,208] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:46:38,211] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 6 (state.change.logger)
[2022-05-03 18:46:38,212] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 5 (state.change.logger)
[2022-05-03 18:46:38,213] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 3 (state.change.logger)
[2022-05-03 18:46:38,214] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 33 with correlation id 4 (state.change.logger)
[2022-05-03 18:46:38,239] INFO [Controller id=0 epoch=33] Partition Sensor-5 state changed to (Leader:3,ISR:3,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:33) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,239] INFO [Controller id=0 epoch=33] Partition Sensor-2 state changed to (Leader:4,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:33) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,239] INFO [Controller id=0 epoch=33] Partition Sensor-3 state changed to (Leader:-1,ISR:5,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:33) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,239] INFO [Controller id=0 epoch=33] Partition Sensor-1 state changed to (Leader:3,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:33) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,239] INFO [Controller id=0 epoch=33] Partition Sensor-4 state changed to (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:33) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,248] INFO [Controller id=0 epoch=33] Partition Sensor-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:33) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,248] INFO [Controller id=0 epoch=33] Partition Sensor-0 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:33) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,248] INFO [Controller id=0 epoch=33] Partition Sensor-5 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:33) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,248] INFO [Controller id=0 epoch=33] Partition Sensor-2 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:33) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,248] INFO [Controller id=0 epoch=33] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:33) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,256] INFO [Controller id=0 epoch=33] Partition Sensor-5 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:33) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,256] INFO [Controller id=0 epoch=33] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:33) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,256] INFO [Controller id=0 epoch=33] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:33) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,256] INFO [Controller id=0 epoch=33] Partition Sensor-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:33) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,262] INFO [Controller id=0 epoch=33] Partition Sensor-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:33) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,262] INFO [Controller id=0 epoch=33] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:33) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,262] INFO [Controller id=0 epoch=33] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:33) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,262] INFO [Controller id=0 epoch=33] Partition Sensor-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:33) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:46:38,262] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,264] INFO [Controller id=0 epoch=33] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:46:38,264] INFO [Controller id=0 epoch=33] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:46:38,264] INFO [Controller id=0 epoch=33] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:46:38,264] INFO [Controller id=0 epoch=33] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:46:38,266] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,266] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:46:38,266] INFO [Controller id=0 epoch=33] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:46:38,267] INFO [Controller id=0 epoch=33] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:46:38,267] INFO [Controller id=0 epoch=33] Sending StopReplica request for 4 replicas to broker 4 (state.change.logger)
[2022-05-03 18:46:38,267] INFO [Controller id=0 epoch=33] Sending StopReplica request for 5 replicas to broker 5 (state.change.logger)
[2022-05-03 18:46:38,267] INFO [Broker id=3] Handling StopReplica request correlationId 6 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:46:38,267] INFO [Broker id=5] Handling StopReplica request correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:46:38,267] INFO [Broker id=4] Handling StopReplica request correlationId 5 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:46:38,280] INFO [Broker id=0] Handling StopReplica request correlationId 8 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:46:38,281] INFO [Broker id=3] Handling StopReplica request correlationId 7 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:46:38,282] INFO [Broker id=5] Handling StopReplica request correlationId 5 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:46:38,282] INFO [Broker id=4] Handling StopReplica request correlationId 6 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:46:38,347] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,349] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,353] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,354] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,357] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,595] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,598] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,599] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:46:38,600] INFO [Controller id=0 epoch=33] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:47:08,704] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:47:13,872] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:47:13,873] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:47:18,576] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet(3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:47:18,577] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:48:42,658] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:48:42,661] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:48:42,662] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:48:43,847] INFO [Controller id=3 epoch=34] Sending UpdateMetadata request to brokers HashSet(3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:48:44,061] INFO [Controller id=4 epoch=35] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:48:53,400] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:49:08,134] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-05-03 18:49:08,135] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(3) for 0 partitions (state.change.logger)
[2022-05-03 18:49:13,198] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(0, 3) for 0 partitions (state.change.logger)
[2022-05-03 18:49:13,198] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(4) for 0 partitions (state.change.logger)
[2022-05-03 18:49:18,215] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(0, 3, 4) for 0 partitions (state.change.logger)
[2022-05-03 18:49:18,215] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(5) for 0 partitions (state.change.logger)
[2022-05-03 18:49:22,596] INFO [Controller id=0 epoch=36] Changed partition Sensor-0 state from NonExistentPartition to NewPartition with assigned replicas 4,5,3 (state.change.logger)
[2022-05-03 18:49:22,597] INFO [Controller id=0 epoch=36] Changed partition Sensor-5 state from NonExistentPartition to NewPartition with assigned replicas 0,4,5 (state.change.logger)
[2022-05-03 18:49:22,597] INFO [Controller id=0 epoch=36] Changed partition Sensor-2 state from NonExistentPartition to NewPartition with assigned replicas 5,4,0 (state.change.logger)
[2022-05-03 18:49:22,597] INFO [Controller id=0 epoch=36] Changed partition Sensor-3 state from NonExistentPartition to NewPartition with assigned replicas 3,0,5 (state.change.logger)
[2022-05-03 18:49:22,597] INFO [Controller id=0 epoch=36] Changed partition Sensor-1 state from NonExistentPartition to NewPartition with assigned replicas 0,3,4 (state.change.logger)
[2022-05-03 18:49:22,597] INFO [Controller id=0 epoch=36] Changed partition Sensor-4 state from NonExistentPartition to NewPartition with assigned replicas 4,3,0 (state.change.logger)
[2022-05-03 18:49:22,597] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:22,600] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:22,633] INFO [Controller id=0 epoch=36] Changed partition Sensor-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 5, 3), zkVersion=0) (state.change.logger)
[2022-05-03 18:49:22,634] INFO [Controller id=0 epoch=36] Changed partition Sensor-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 4, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:49:22,634] INFO [Controller id=0 epoch=36] Changed partition Sensor-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=5, leaderEpoch=0, isr=List(5, 4, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:49:22,634] INFO [Controller id=0 epoch=36] Changed partition Sensor-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=3, leaderEpoch=0, isr=List(3, 0, 5), zkVersion=0) (state.change.logger)
[2022-05-03 18:49:22,634] INFO [Controller id=0 epoch=36] Changed partition Sensor-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 3, 4), zkVersion=0) (state.change.logger)
[2022-05-03 18:49:22,634] INFO [Controller id=0 epoch=36] Changed partition Sensor-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=4, leaderEpoch=0, isr=List(4, 3, 0), zkVersion=0) (state.change.logger)
[2022-05-03 18:49:22,637] INFO [Controller id=0 epoch=36] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:49:22,639] INFO [Controller id=0 epoch=36] Sending LeaderAndIsr request to broker 3 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:49:22,639] INFO [Controller id=0 epoch=36] Sending LeaderAndIsr request to broker 4 with 2 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:49:22,640] INFO [Controller id=0 epoch=36] Sending LeaderAndIsr request to broker 5 with 1 become-leader and 3 become-follower partitions (state.change.logger)
[2022-05-03 18:49:22,640] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:49:22,642] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:22,646] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:22,647] INFO [Broker id=3] Handling LeaderAndIsr request correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:22,648] INFO [Broker id=4] Handling LeaderAndIsr request correlationId 2 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:22,649] INFO [Broker id=5] Handling LeaderAndIsr request correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:22,675] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 36 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:49:22,681] INFO [Broker id=4] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 36 as part of the become-leader transition for 2 partitions (state.change.logger)
[2022-05-03 18:49:22,681] INFO [Broker id=5] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 36 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:49:22,682] INFO [Broker id=3] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 36 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-05-03 18:49:22,717] INFO [Broker id=0] Leader Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,4,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,734] INFO [Broker id=0] Leader Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,3,4] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,749] INFO [Broker id=0] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,756] INFO [Broker id=0] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,762] INFO [Broker id=0] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,763] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 36 with correlation id 4 for 3 partitions (state.change.logger)
[2022-05-03 18:49:22,787] INFO [Broker id=4] Leader Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,3,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,788] INFO [Broker id=3] Leader Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [3,0,5] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,789] INFO [Broker id=5] Leader Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [5,4,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,806] INFO [Broker id=4] Leader Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [4,5,3] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,813] INFO [Broker id=5] Follower Sensor-3 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,816] INFO [Broker id=3] Follower Sensor-4 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,821] INFO [Broker id=0] Finished LeaderAndIsr request in 174ms correlationId 4 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:22,826] INFO [Broker id=3] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,826] INFO [Broker id=5] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,831] INFO [Broker id=4] Follower Sensor-5 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,837] INFO [Broker id=5] Follower Sensor-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,837] INFO [Broker id=3] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,838] INFO [Broker id=0] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 5 (state.change.logger)
[2022-05-03 18:49:22,839] INFO [Broker id=3] Stopped fetchers as part of become-follower request from controller 0 epoch 36 with correlation id 3 for 3 partitions (state.change.logger)
[2022-05-03 18:49:22,839] INFO [Broker id=5] Stopped fetchers as part of become-follower request from controller 0 epoch 36 with correlation id 1 for 3 partitions (state.change.logger)
[2022-05-03 18:49:22,842] INFO [Broker id=4] Follower Sensor-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,857] INFO [Broker id=4] Follower Sensor-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-05-03 18:49:22,859] INFO [Broker id=4] Stopped fetchers as part of become-follower request from controller 0 epoch 36 with correlation id 2 for 3 partitions (state.change.logger)
[2022-05-03 18:49:22,929] INFO [Broker id=3] Finished LeaderAndIsr request in 283ms correlationId 3 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:22,934] INFO [Broker id=5] Finished LeaderAndIsr request in 288ms correlationId 1 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:22,948] INFO [Broker id=3] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2022-05-03 18:49:22,955] INFO [Broker id=5] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 2 (state.change.logger)
[2022-05-03 18:49:22,956] INFO [Broker id=4] Finished LeaderAndIsr request in 298ms correlationId 2 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:22,973] INFO [Broker id=4] Add 6 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 3 (state.change.logger)
[2022-05-03 18:49:32,695] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,695] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,697] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet(0, 3, 4, 5) for 6 partitions (state.change.logger)
[2022-05-03 18:49:32,700] INFO [Broker id=0] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 6 (state.change.logger)
[2022-05-03 18:49:32,703] INFO [Broker id=3] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 5 (state.change.logger)
[2022-05-03 18:49:32,703] INFO [Broker id=5] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 3 (state.change.logger)
[2022-05-03 18:49:32,703] INFO [Broker id=4] Add 0 partitions and deleted 6 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 36 with correlation id 4 (state.change.logger)
[2022-05-03 18:49:32,729] INFO [Controller id=0 epoch=36] Partition Sensor-5 state changed to (Leader:-1,ISR:4,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:36) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,729] INFO [Controller id=0 epoch=36] Partition Sensor-2 state changed to (Leader:5,ISR:5,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:36) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,729] INFO [Controller id=0 epoch=36] Partition Sensor-3 state changed to (Leader:3,ISR:3,5,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:36) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,729] INFO [Controller id=0 epoch=36] Partition Sensor-1 state changed to (Leader:-1,ISR:3,4,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:36) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,729] INFO [Controller id=0 epoch=36] Partition Sensor-4 state changed to (Leader:4,ISR:4,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:36) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,737] INFO [Controller id=0 epoch=36] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:36) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,737] INFO [Controller id=0 epoch=36] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:36) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,737] INFO [Controller id=0 epoch=36] Partition Sensor-3 state changed to (Leader:3,ISR:3,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:36) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,737] INFO [Controller id=0 epoch=36] Partition Sensor-0 state changed to (Leader:4,ISR:4,3,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:36) after removing replica 5 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,744] INFO [Controller id=0 epoch=36] Partition Sensor-4 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:36) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,744] INFO [Controller id=0 epoch=36] Partition Sensor-3 state changed to (Leader:-1,ISR:3,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:36) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,744] INFO [Controller id=0 epoch=36] Partition Sensor-0 state changed to (Leader:4,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:36) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,744] INFO [Controller id=0 epoch=36] Partition Sensor-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:36) after removing replica 3 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,753] INFO [Controller id=0 epoch=36] Partition Sensor-0 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:36) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,753] INFO [Controller id=0 epoch=36] Partition Sensor-5 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:36) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,753] INFO [Controller id=0 epoch=36] Partition Sensor-2 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:36) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,753] INFO [Controller id=0 epoch=36] Partition Sensor-1 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:36) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,753] INFO [Controller id=0 epoch=36] Partition Sensor-4 state changed to (Leader:-1,ISR:4,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:36) after removing replica 4 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-05-03 18:49:32,753] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,754] INFO [Controller id=0 epoch=36] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:49:32,756] INFO [Controller id=0 epoch=36] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:49:32,756] INFO [Controller id=0 epoch=36] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:49:32,756] INFO [Controller id=0 epoch=36] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:49:32,758] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,758] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:32,758] INFO [Controller id=0 epoch=36] Sending StopReplica request for 5 replicas to broker 0 (state.change.logger)
[2022-05-03 18:49:32,758] INFO [Controller id=0 epoch=36] Sending StopReplica request for 4 replicas to broker 3 (state.change.logger)
[2022-05-03 18:49:32,758] INFO [Controller id=0 epoch=36] Sending StopReplica request for 5 replicas to broker 4 (state.change.logger)
[2022-05-03 18:49:32,758] INFO [Controller id=0 epoch=36] Sending StopReplica request for 4 replicas to broker 5 (state.change.logger)
[2022-05-03 18:49:32,759] INFO [Broker id=5] Handling StopReplica request correlationId 4 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:32,759] INFO [Broker id=3] Handling StopReplica request correlationId 6 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:32,759] INFO [Broker id=4] Handling StopReplica request correlationId 5 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:32,775] INFO [Broker id=0] Handling StopReplica request correlationId 8 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:32,776] INFO [Broker id=5] Handling StopReplica request correlationId 5 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:32,778] INFO [Broker id=4] Handling StopReplica request correlationId 6 from controller 0 for 5 partitions (state.change.logger)
[2022-05-03 18:49:32,779] INFO [Broker id=3] Handling StopReplica request correlationId 7 from controller 0 for 4 partitions (state.change.logger)
[2022-05-03 18:49:32,849] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,852] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,854] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,856] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:32,859] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:33,093] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:33,107] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:33,109] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-05-03 18:49:33,109] INFO [Controller id=0 epoch=36] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
